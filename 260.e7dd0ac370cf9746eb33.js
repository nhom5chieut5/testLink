(self.webpackChunk_fuse_demo=self.webpackChunk_fuse_demo||[]).push([[260],{18260:(e,t,i)=>{"use strict";i.r(t),i.d(t,{DashboardModule:()=>ce});var s=i(38583),a=i(95987),n=i(5396),o=i(92340),r=i(37296),l=i(22238),c=i(37716),d=i(40704),g=i(46954),p=i(8394),f=i(51095),m=i(76627),u=i(4885),h=i(93104);function x(e,t){1&e&&c._UZ(0,"mat-progress-spinner",11),2&e&&c.Q6J("diameter",24)("mode","indeterminate")}function Z(e,t){if(1&e&&c._UZ(0,"div",12),2&e){const e=c.oxw(2);c.Q6J("options",e.optionLine)}}function v(e,t){if(1&e&&(c.TgZ(0,"div",15),c.TgZ(1,"div",16),c.TgZ(2,"div",17),c._uU(3),c.qZA(),c.qZA(),c.TgZ(4,"div",18),c.TgZ(5,"div",19),c._uU(6),c.TgZ(7,"sup"),c._uU(8,"\u20ab"),c.qZA(),c.qZA(),c.qZA(),c.qZA()),2&e){const e=t.$implicit;c.xp6(3),c.AsE("",e.user_name," | ",e.time,""),c.xp6(3),c.hij("",e.price," ")}}function _(e,t){if(1&e&&(c.TgZ(0,"div",13),c.YNc(1,v,9,3,"div",14),c.qZA()),2&e){const e=c.oxw(2);c.xp6(1),c.Q6J("ngForOf",null==e.rawData?null:e.rawData.logs)}}function w(e,t){if(1&e&&(c.ynx(0),c.TgZ(1,"div",1),c.TgZ(2,"div",2),c.TgZ(3,"div",3),c._uU(4),c.qZA(),c.TgZ(5,"button",4),c._UZ(6,"mat-icon",5),c.qZA(),c.qZA(),c.TgZ(7,"div",6),c.YNc(8,x,1,2,"mat-progress-spinner",7),c.TgZ(9,"h1",8),c._uU(10),c.qZA(),c.TgZ(11,"div"),c.YNc(12,Z,1,1,"div",9),c.qZA(),c.YNc(13,_,2,1,"div",10),c.qZA(),c.qZA(),c.BQk()),2&e){const e=t.$implicit,i=c.oxw();c.xp6(4),c.Oqu(e("TITLE")),c.xp6(1),c.Q6J("tabIndex",-1),c.xp6(1),c.Q6J("svgIcon","heroicons_outline:x"),c.xp6(2),c.Q6J("ngIf",i.loadingFlag.pending),c.xp6(2),c.Oqu(null==i.rawData.species?null:i.rawData.species.title),c.xp6(2),c.Q6J("ngIf",i.show),c.xp6(1),c.Q6J("ngIf",i.rawData)}}let A=(()=>{class e{constructor(e,t,i,s){this.data=e,this._alertService=t,this.service=i,this._translate=s,this.rawData=[],this.loadingFlag=new n.E,this.show=!1,this.optionLine={title:{},tooltip:{trigger:"axis",position:["30%","60%"],formatter:function(e){let t="L\xfac "+e[0].name+"<br>";return t+="T\u1eeb t\xe9p b\u1ea1c: "+(0==e[0].value?"Ch\u01b0a c\u1eadp nh\u1eadt":e[0].value+" \u0111\u1ed3ng ")+"<br>",t+="T\u1eeb th\xe0nh vi\xean : "+(0==e[1].value?"Ch\u01b0a c\u1eadp nh\u1eadt":e[1].value+" \u0111\u1ed3ng"),t},textStyle:{fontFamily:"-apple-system,BlinkMacSystemFont,Roboto,Arial,sans-serif"}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:[{type:"category",boundaryGap:!1,data:[]}],yAxis:[{type:"value",show:!0}],series:[{name:"\u0110\xe3 Duy\u1ec7t",type:"line",stack:"vertical",smooth:!0,areaStyle:{color:"rgb(96, 165, 250, 0.5)"},lineStyle:{color:"rgb(29, 78, 216)"},itemStyle:{color:"rgb(29, 78, 216)"},emphasis:{focus:"series"},data:[]},{name:"Th\xe0nh Vi\xean",type:"line",stack:"user",smooth:!0,areaStyle:{color:"rgb(252, 211, 77, 0.1)"},lineStyle:{color:"rgb(245, 158, 11)"},itemStyle:{color:"rgb(245, 158, 11)"},emphasis:{focus:"series"},data:[]}]}}ngOnInit(){this.getData()}getData(){this.loadingFlag.setPending(!0),this.service.getPriceHistory(this.data).pipe().subscribe(e=>{0==e.status?(this._alertService.error(e.error),this.loadingFlag.setResult(!1)):(this.rawData=e.data,this.prepareData(),this.loadingFlag.setResult(!0))},e=>{this.loadingFlag.setResult(!1),this._alertService.error(this._translate.translate("CONNECT_ERROR"))})}prepareData(){this.optionLine.xAxis[0].data=this.rawData.labels,this.optionLine.series[0].data=this.rawData.history,this.optionLine.series[1].data=this.rawData.history_user,this.show=!0}}return e.\u0275fac=function(t){return new(t||e)(c.Y36(l.WI),c.Y36(d.c),c.Y36(g.s),c.Y36(p.Vn))},e.\u0275cmp=c.Xpm({type:e,selectors:[["app-price-history"]],decls:1,vars:1,consts:[[4,"transloco","translocoRead"],[1,"flex","flex-col","max-w-240","md:min-w-160","-m-6"],[1,"flex","flex-0","items-center","justify-between","h-16","pr-3","sm:pr-5","pl-6","sm:pl-8","bg-primary","text-on-primary"],[1,"text-lg","font-medium"],["mat-icon-button","","mat-dialog-close","",3,"tabIndex"],[1,"text-current",3,"svgIcon"],[1,"flex","flex-col","flex-auto","p-6","sm:p-8","overflow-y-auto"],[3,"diameter","mode",4,"ngIf"],[1,"text-xl","font-semibold"],["echarts","","class","demo-chart",3,"options",4,"ngIf"],["class","mt-2",4,"ngIf"],[3,"diameter","mode"],["echarts","",1,"demo-chart",3,"options"],[1,"mt-2"],["class","flex flex-row items-center justify-between py-4 px-0.5",4,"ngFor","ngForOf"],[1,"flex","flex-row","items-center","justify-between","py-4","px-0.5"],[1,"flex","flex-col"],[1,"font-medium"],[1,"flex","flex-row","items-center","justify-end"],[1,"font-medium","text-green-500","mr-4"]],template:function(e,t){1&e&&c.YNc(0,w,14,7,"ng-container",0),2&e&&c.Q6J("translocoRead","DASHBOARD.PRICE_HISTORY")},directives:[p.KI,f.lW,l.ZT,m.Hw,s.O5,u.Ou,h.w,s.sg],styles:[""]}),e})();var T=i(3679),b=i(54395),q=i(42120),y=i(98295),S=i(49983),D=i(77746);function I(e,t){1&e&&(c.TgZ(0,"sup"),c._uU(1,"\u20ab"),c.qZA())}function U(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"div",14),c.TgZ(1,"div",15),c.TgZ(2,"p",16),c._uU(3),c.qZA(),c.TgZ(4,"p",17),c._uU(5),c.YNc(6,I,2,0,"sup",18),c.qZA(),c.qZA(),c.TgZ(7,"div",19),c.TgZ(8,"button",20),c.NdJ("click",function(){const t=c.CHM(e).$implicit;return c.oxw(3).removeSpecies(t)}),c._UZ(9,"mat-icon",21),c.qZA(),c.qZA(),c.qZA()}if(2&e){const e=t.$implicit,i=c.oxw(3);c.xp6(3),c.Oqu(e.sname),c.xp6(2),c.hij("",e.price," "),c.xp6(1),c.Q6J("ngIf",i.checkPriceAvailable(e.price))}}function E(e,t){if(1&e&&(c.TgZ(0,"div",12),c.YNc(1,U,10,3,"div",13),c.qZA()),2&e){const e=c.oxw(2);c.xp6(1),c.Q6J("ngForOf",e.priceList)}}function N(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"div",22),c.TgZ(1,"div",23),c.TgZ(2,"div",24),c.TgZ(3,"p"),c._uU(4),c.qZA(),c.qZA(),c.TgZ(5,"button",25),c.NdJ("click",function(){const t=c.CHM(e).$implicit;return c.oxw(2).addSpecies(t)}),c._UZ(6,"mat-icon",26),c.qZA(),c.qZA(),c.qZA()}if(2&e){const e=t.$implicit,i=c.oxw(2);c.xp6(4),c.Oqu(e.title),c.xp6(1),c.Q6J("disabled",i.disableAddBtn(e))}}function O(e,t){if(1&e&&(c.ynx(0),c.TgZ(1,"div",1),c.TgZ(2,"div",2),c.TgZ(3,"div",3),c._uU(4),c.qZA(),c.TgZ(5,"button",4),c._UZ(6,"mat-icon",5),c.qZA(),c.qZA(),c.TgZ(7,"div",6),c.YNc(8,E,2,1,"div",7),c.TgZ(9,"mat-form-field",8),c.TgZ(10,"mat-label"),c._uU(11),c.qZA(),c._UZ(12,"input",9),c.qZA(),c.TgZ(13,"mat-list",10),c.YNc(14,N,7,2,"div",11),c.ALo(15,"async"),c.qZA(),c.qZA(),c.qZA(),c.BQk()),2&e){const e=t.$implicit,i=c.oxw();c.xp6(4),c.Oqu(e("TITLE")),c.xp6(1),c.Q6J("tabIndex",-1),c.xp6(1),c.Q6J("svgIcon","heroicons_outline:x"),c.xp6(2),c.Q6J("ngIf",i.priceList),c.xp6(3),c.Oqu(e("SEARCH")),c.xp6(1),c.Q6J("placeholder",e("ENTER_SPECIES"))("formControl",i.searchWord),c.xp6(2),c.Q6J("ngForOf",c.lcZ(15,8,i.species$))}}let F=(()=>{class e{constructor(e,t,i,s,a,o){this.data=e,this.dialogRef=t,this.localDb=i,this._alertService=s,this._dashboardService=a,this._translateService=o,this.loadingFlag=new n.E,this.page=0,this.searchWord=new T.NI}ngOnInit(){this.getPriceUpdate(),this.searchWord.valueChanges.pipe((0,b.b)(300)).subscribe(e=>{this.getSpeciesList(e)})}getPriceUpdate(){const e=this.localDb.speciesFollowing.map(e=>e.speciesId);this.loadingFlag.setPending(!0),this._dashboardService.listUpdate(this.page,{speciesId:e}).pipe().subscribe(e=>{if(0==e.status)this._alertService.error(e.error);else{const t=e.data.species.map(e=>e.sid),i=this.localDb.speciesFollowing.filter(e=>!t.includes(e.speciesId)).map(e=>Object.assign(Object.assign({},e),{sid:e.speciesId,price:this._translateService.translate("DASHBOARD.SPECIES.NO_PRICE")}));this.priceList=[...e.data.species,...i]}this.loadingFlag.setPending(!1)},e=>{this.loadingFlag.setPending(!1),this._alertService.error(this._translateService.translate("CONNECT_ERROR"))})}getSpeciesList(e){e.length>=2&&(this.loadingFlag.setPending(!0),this.species$=this._dashboardService.searchSpecies(e).pipe(e=>(this.message=0==e.length?this._translateService.translate("POND.MEMBER.NO_INFO"):"",this.loadingFlag.setResult(!0),e)))}disableAddBtn(e){return this.priceList.findIndex(t=>t.sid===e.id)>=0}checkPriceAvailable(e){return Boolean(Number(e))}addSpecies(e){this.localDb.addItem("speciesFollowing",{speciesId:e.id,sname:e.title}),this.getPriceUpdate()}removeSpecies(e){this.localDb.removeSpecies(e.sid),this.getPriceUpdate()}}return e.\u0275fac=function(t){return new(t||e)(c.Y36(l.WI),c.Y36(l.so),c.Y36(q.T),c.Y36(d.c),c.Y36(g.s),c.Y36(p.Vn))},e.\u0275cmp=c.Xpm({type:e,selectors:[["app-species-setting"]],decls:1,vars:1,consts:[[4,"transloco","translocoRead"],[1,"flex","flex-col","sm:w-120","sm:max-h-140","sm:overflow-auto","-m-6"],[1,"flex","flex-0","items-center","justify-between","h-16","pr-3","sm:pr-5","pl-6","sm:pl-8","bg-primary","text-on-primary"],[1,"text-lg","font-medium"],["mat-icon-button","","mat-dialog-close","",3,"tabIndex"],[1,"text-current",3,"svgIcon"],[1,"flex","flex-col","flex-auto","p-6","sm:p-8","overflow-y-auto"],["class","mt-2",4,"ngIf"],["appearance","legacy",1,"w-full"],["matInput","",3,"placeholder","formControl"],["role","list"],["class","flex flex-col items-center justify-between px-0.5 font-medium",4,"ngFor","ngForOf"],[1,"mt-2"],["class","flex flex-row items-center justify-between px-0.5",4,"ngFor","ngForOf"],[1,"flex","flex-row","items-center","justify-between","px-0.5"],[1,"flex","justify-between","items-center","font-medium","w-5/6"],[1,""],[1,"text-green-500"],[4,"ngIf"],[1,"flex","flex-row","items-center","justify-end"],["mat-icon-button","","color","warn",3,"click"],["svgIcon","mat_solid:delete"],[1,"flex","flex-col","items-center","justify-between","px-0.5","font-medium"],[1,"flex","justify-between","items-center","py-1","w-full"],[1,"flex","justify-start","items-center"],["mat-icon-button","","color","primary",3,"disabled","click"],["svgIcon","mat_solid:add"]],template:function(e,t){1&e&&c.YNc(0,O,16,10,"ng-container",0),2&e&&c.Q6J("translocoRead","DASHBOARD.SPECIES")},directives:[p.KI,f.lW,l.ZT,m.Hw,s.O5,y.KE,y.hX,S.Nt,T.Fj,T.JJ,T.oH,D.i$,s.sg],pipes:[s.Ov],styles:[""]}),e})();var J=i(2564),R=i(44342),Y=i(43037),C=i(12178);function Q(e,t){if(1&e&&c._UZ(0,"img",32),2&e){const e=c.oxw(2);c.Q6J("src",e.weatherData.icon,c.LSH)}}function P(e,t){1&e&&c._UZ(0,"mat-icon",33)}function L(e,t){1&e&&c._UZ(0,"mat-progress-bar",34),2&e&&c.Q6J("mode","indeterminate")}function j(e,t){if(1&e&&(c.TgZ(0,"div"),c._uU(1),c.qZA()),2&e){const e=c.oxw().$implicit;c.xp6(1),c.hij(" ",e("NO_POSITION")," ")}}function k(e,t){if(1&e&&(c.TgZ(0,"div"),c._uU(1),c.qZA()),2&e){const e=c.oxw().$implicit;c.xp6(1),c.hij(" ",e("NO_WEATHER")," ")}}function W(e,t){if(1&e&&(c.TgZ(0,"div"),c.TgZ(1,"div"),c._uU(2),c.TgZ(3,"span",35),c._uU(4),c.TgZ(5,"sup"),c.TgZ(6,"small"),c._uU(7,"o"),c.qZA(),c.qZA(),c._uU(8,"C"),c.qZA(),c._uU(9),c.TgZ(10,"span",36),c._uU(11),c.TgZ(12,"sup"),c.TgZ(13,"small"),c._uU(14,"o"),c.qZA(),c.qZA(),c._uU(15,"C"),c.qZA(),c.qZA(),c.TgZ(16,"div"),c._uU(17),c.qZA(),c.qZA()),2&e){const e=c.oxw().$implicit,t=c.oxw();c.xp6(2),c.hij("",e("WEATHER_TODAY")," "),c.xp6(1),c.Q6J("ngClass",t.weatherData.temp>28?"text-red-500":"text-green-500"),c.xp6(1),c.hij(" ",t.weatherData.temp,""),c.xp6(5),c.hij(", ",e("WEATHER_TODAY_MAX")," "),c.xp6(1),c.Q6J("ngClass",t.weatherData.temp_max>28?"text-red-500":"text-green-500"),c.xp6(1),c.hij(" ",t.weatherData.temp_max," "),c.xp6(6),c.lnq(" ",e("WEATHER_TODAY_MES")," ",t.weatherData.weather," ",e("WEATHER_TODAY_MES_END")," ")}}function H(e,t){1&e&&c._UZ(0,"mat-progress-bar",34),2&e&&c.Q6J("mode","indeterminate")}function $(e,t){if(1&e&&(c.TgZ(0,"div",18),c.TgZ(1,"div",39),c.TgZ(2,"div",40),c._uU(3),c.qZA(),c.qZA(),c.TgZ(4,"div",41),c._uU(5),c.qZA(),c.qZA()),2&e){const e=t.$implicit,i=c.oxw(2).$implicit;c.xp6(3),c.Oqu(e.name),c.xp6(2),c.AsE("",e.count," ",i(e.count>1?"PONDS":"POND"),"")}}function M(e,t){if(1&e&&(c.TgZ(0,"div",23),c.TgZ(1,"div",11),c.TgZ(2,"div",24),c._UZ(3,"mat-icon",37),c._uU(4),c.qZA(),c.qZA(),c.TgZ(5,"div",17),c.TgZ(6,"div",38),c.TgZ(7,"div"),c.YNc(8,H,1,1,"mat-progress-bar",19),c.qZA(),c.YNc(9,$,6,3,"div",28),c.qZA(),c.qZA(),c.qZA()),2&e){const e=c.oxw().$implicit,t=c.oxw();c.xp6(4),c.hij(" ",e("DISEASE")," "),c.xp6(4),c.Q6J("ngIf",t.loadingDiseaseFlag.pending),c.xp6(1),c.Q6J("ngForOf",t.diseaseList)}}function B(e,t){1&e&&c._UZ(0,"mat-progress-bar",34),2&e&&c.Q6J("mode","indeterminate")}function z(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"div",18),c.TgZ(1,"div",39),c.TgZ(2,"div",40),c._uU(3),c.qZA(),c.qZA(),c.TgZ(4,"div",42),c.TgZ(5,"div",43),c._uU(6),c.ALo(7,"number"),c.TgZ(8,"sup"),c._uU(9,"\u20ab"),c.qZA(),c.qZA(),c.TgZ(10,"span",44),c.NdJ("click",function(){const t=c.CHM(e).$implicit;return c.oxw(2).presentPriceHistory(t.sid)}),c._UZ(11,"mat-icon",45),c.qZA(),c.qZA(),c.qZA()}if(2&e){const e=t.$implicit;c.xp6(3),c.Oqu(e.sname),c.xp6(3),c.hij("",c.Dn7(7,3,e.price,"1.0","en-US")," "),c.xp6(5),c.Q6J("svgIcon","heroicons_solid:chevron-right")}}function G(e,t){1&e&&c._UZ(0,"mat-progress-bar",34),2&e&&c.Q6J("mode","indeterminate")}function X(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"div",46),c.TgZ(1,"p"),c._uU(2),c.qZA(),c.TgZ(3,"button",47),c.NdJ("click",function(){return c.CHM(e),c.oxw(2).goToRegisterCompany()}),c.TgZ(4,"span",48),c._uU(5),c.qZA(),c._UZ(6,"mat-icon",49),c.qZA(),c.qZA()}if(2&e){const e=c.oxw().$implicit;c.xp6(2),c.Oqu(e("CREATE_COMPANY")),c.xp6(1),c.Q6J("color","primary"),c.xp6(2),c.Oqu(e("CREATE_NOW")),c.xp6(1),c.Q6J("svgIcon","heroicons_solid:chevron-right")}}function K(e,t){if(1&e&&(c.TgZ(0,"a",50),c.TgZ(1,"div",51),c._uU(2),c.qZA(),c.TgZ(3,"div"),c.TgZ(4,"div",52),c._UZ(5,"mat-icon",53),c.TgZ(6,"div",54),c.TgZ(7,"div",55),c._uU(8),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.TgZ(9,"div",56),c.TgZ(10,"span",57),c._uU(11),c.qZA(),c._uU(12,", "),c.TgZ(13,"span",58),c._uU(14),c.qZA(),c.qZA(),c.qZA()),2&e){const e=t.$implicit,i=c.oxw().$implicit,s=c.oxw();c.MGl("routerLink","/farm/",e.infor.code,""),c.xp6(2),c.hij(" ",e.infor.company_name,""),c.xp6(6),c.hij("",e.infor.name," "),c.xp6(3),c.AsE("",s.getFarmPonds(e).length," ",i("TOTAL_PONDS"),""),c.xp6(3),c.AsE("",s.getFarmEmptyPonds(e).length," ",i("EMPTY_PONDS"),"")}}function V(e,t){if(1&e&&(c.TgZ(0,"div",51),c._uU(1),c.qZA()),2&e){const e=c.oxw(2).$implicit;c.xp6(1),c.hij(" ",e("EMPTY"),"")}}function ee(e,t){1&e&&(c.TgZ(0,"div",51),c._uU(1," --"),c.qZA())}function te(e,t){if(1&e&&(c.TgZ(0,"div",51),c._uU(1),c.qZA()),2&e){const e=c.oxw().$implicit;c.xp6(1),c.Oqu(e.infor.species)}}function ie(e,t){if(1&e&&(c.TgZ(0,"div",51),c._uU(1),c.ALo(2,"number"),c.ALo(3,"number"),c.qZA()),2&e){const e=c.oxw().$implicit,t=c.oxw().$implicit,i=c.oxw();c.xp6(1),c.AsE("",c.xi3(2,2,(i.now-e.infor.start_time)/86400,"0.0-0")," ",c.xi3(3,5,(i.now-e.infor.start_time)/86400,"0.0-0").replace(",","")>1?t("DAYS"):t("DAY")," ")}}function se(e,t){if(1&e&&(c.TgZ(0,"a",50),c.TgZ(1,"div",51),c._uU(2),c.qZA(),c.TgZ(3,"div",52),c._UZ(4,"mat-icon",59),c.TgZ(5,"div",54),c.TgZ(6,"div",60),c._uU(7),c.qZA(),c.YNc(8,V,2,1,"div",61),c.YNc(9,ee,2,0,"div",61),c.YNc(10,te,2,1,"div",61),c.YNc(11,ie,4,8,"div",61),c.qZA(),c.qZA(),c.qZA()),2&e){const e=t.$implicit;c.MGl("routerLink","/pond/",e.infor.code,""),c.xp6(2),c.Oqu(e.infor.farm_name),c.xp6(2),c.Q6J("ngClass",1==e.infor.existSeason&&0==e.infor.warning?"text-blue-400":1==e.infor.existSeason&&1==e.infor.warning?"text-red-500":""),c.xp6(2),c.Q6J("ngClass",1==e.infor.existSeason&&0==e.infor.warning?"text-blue-400":1==e.infor.existSeason&&1==e.infor.warning?"text-red-500":""),c.xp6(1),c.hij(" ",e.infor.name,""),c.xp6(1),c.Q6J("ngIf",0==e.infor.existSeason),c.xp6(1),c.Q6J("ngIf",0==e.infor.existSeason),c.xp6(1),c.Q6J("ngIf",1==e.infor.existSeason),c.xp6(1),c.Q6J("ngIf",1==e.infor.existSeason)}}function ae(e,t){if(1&e){const e=c.EpF();c.ynx(0),c.TgZ(1,"div",1),c.TgZ(2,"div",2),c.TgZ(3,"div",3),c.TgZ(4,"div",4),c.TgZ(5,"div",5),c.TgZ(6,"div"),c.TgZ(7,"div",6),c._uU(8),c.qZA(),c.TgZ(9,"div",7),c._uU(10),c.qZA(),c.qZA(),c.qZA(),c.TgZ(11,"div",8),c.TgZ(12,"div",9),c.TgZ(13,"div",10),c.TgZ(14,"div",11),c.TgZ(15,"div",12),c.YNc(16,Q,1,1,"img",13),c.YNc(17,P,1,0,"mat-icon",14),c._uU(18),c.qZA(),c.TgZ(19,"span",15),c.NdJ("click",function(){return c.CHM(e),c.oxw().presentWeatherPredict()}),c._UZ(20,"mat-icon",16),c.qZA(),c.qZA(),c.TgZ(21,"div",17),c.TgZ(22,"div",18),c.YNc(23,L,1,1,"mat-progress-bar",19),c.TgZ(24,"div",20),c.YNc(25,j,2,1,"div",21),c.YNc(26,k,2,1,"div",21),c.YNc(27,W,18,9,"div",21),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.YNc(28,M,10,3,"div",22),c.TgZ(29,"div",23),c.TgZ(30,"div",11),c.TgZ(31,"div",24),c._UZ(32,"mat-icon",25),c._uU(33),c.qZA(),c.TgZ(34,"span",15),c.NdJ("click",function(){c.CHM(e);const t=c.oxw();return t.showSpeciesSetting(t.priceList)}),c._UZ(35,"mat-icon",26),c.qZA(),c.qZA(),c.TgZ(36,"div",17),c.TgZ(37,"div",27),c.TgZ(38,"div"),c.YNc(39,B,1,1,"mat-progress-bar",19),c.qZA(),c.YNc(40,z,12,7,"div",28),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.TgZ(41,"div",29),c.TgZ(42,"div",5),c.TgZ(43,"div"),c.TgZ(44,"div",6),c._uU(45),c.qZA(),c.TgZ(46,"div",7),c._uU(47),c.qZA(),c.qZA(),c.qZA(),c.TgZ(48,"div"),c.YNc(49,G,1,1,"mat-progress-bar",19),c.qZA(),c.YNc(50,X,7,4,"div",30),c.TgZ(51,"div",8),c.TgZ(52,"div",9),c.YNc(53,K,15,7,"a",31),c.qZA(),c.qZA(),c.TgZ(54,"div",8),c.TgZ(55,"div",9),c.YNc(56,se,12,9,"a",31),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.BQk()}if(2&e){const e=t.$implicit,i=c.oxw();c.xp6(8),c.Oqu(e("UPDATE")),c.xp6(2),c.hij("",e("UPDATE_SUBTITLE")," "),c.xp6(6),c.Q6J("ngIf",i.weatherData),c.xp6(1),c.Q6J("ngIf",!i.weatherData),c.xp6(1),c.hij(" ",e("WEATHER")," "),c.xp6(2),c.Q6J("svgIcon","heroicons_solid:chevron-right"),c.xp6(3),c.Q6J("ngIf",i.loadingWeatherFlag.pending),c.xp6(2),c.Q6J("ngIf",!i.lat&&!i.loadingWeatherFlag.pending),c.xp6(1),c.Q6J("ngIf",!i.weatherData&&!i.loadingWeatherFlag.pending&&i.lat),c.xp6(1),c.Q6J("ngIf",i.weatherData),c.xp6(1),c.Q6J("ngIf",null==i.diseaseList?null:i.diseaseList.length),c.xp6(5),c.hij(" ",e("PRICE")," "),c.xp6(6),c.Q6J("ngIf",i.loadingUpdateFlag.pending),c.xp6(1),c.Q6J("ngForOf",i.priceList),c.xp6(5),c.Oqu(e("MANAGE")),c.xp6(2),c.hij("",e("MANAGE_SUBTITLE")," "),c.xp6(2),c.Q6J("ngIf",i.loadingHomeFlag.pending),c.xp6(1),c.Q6J("ngIf",i.loadingHomeFlag.result&&!i.localDb.company),c.xp6(3),c.Q6J("ngForOf",i.localDb.farms),c.xp6(3),c.Q6J("ngForOf",i.localDb.filterPond("permission","pond_manager"))}}let ne=(()=>{class e{constructor(e,t,i,s,a,o,r,l,c){this._alertService=e,this._accountService=t,this._translateService=i,this._dashboardService=s,this._companyService=a,this._matDialog=o,this.localDb=r,this._router=l,this._notiService=c,this.loadingUpdateFlag=new n.E,this.loadingDiseaseFlag=new n.E,this.loadingWeatherFlag=new n.E,this.loadingHomeFlag=new n.E,this.page=0,this.now=(new Date).valueOf()/1e3}ngOnInit(){this.getNotificationCount(),this.getWeather(),this.getPriceAndNewsUpdate(),this.getLocalDisease(),this.getDashboardUpdate()}getNotificationCount(){this._notiService.loadNumNoti().subscribe(e=>{1==e.status?this._notiService.unreadCount=e.data.num:this._alertService.error(e.error)},()=>{this._alertService.error(this._translateService.translate("CONNECT_NOTI_ERROR"))})}getWeather(){navigator.geolocation?navigator.geolocation.getCurrentPosition(e=>{this.lat=e.coords.latitude,this.lon=e.coords.longitude,this.updateWeather()}):this._alertService.error(this._translateService.translate("DASHBOARD.NO_POSITION"))}updateWeather(){console.log("hehe dashpond"),this.loadingWeatherFlag.setPending(!0),this._dashboardService.getWeatherToday(this.lat,this.lon).pipe().subscribe(e=>{this.processWeatherData(e),this.loadingWeatherFlag.setResult(!0)},e=>{this.loadingWeatherFlag.setResult(!1),this._alertService.error(this._translateService.translate("CONNECT_ERROR"))})}processWeatherData(e){this.weatherWeekData=e.daily;let t=e.daily[0];this.weatherData={temp:(t.temp.day-273.15).toFixed(2),temp_max:(t.temp.max-273.15).toFixed(2),weather:t.weather[0].description,icon:`http://openweathermap.org/img/w/${t.weather[0].icon}.png`}}getPriceAndNewsUpdate(){const e=this.localDb.speciesFollowing.map(e=>e.speciesId);this.loadingUpdateFlag.setPending(!0),this._dashboardService.listUpdate(this.page,{speciesId:e}).pipe().subscribe(e=>{0==e.status?this._alertService.error(e.error):0==this.page?(this.priceList=e.data.species,0==this.localDb.speciesFollowing.length&&this.priceList.forEach(e=>{this.localDb.addItem("speciesFollowing",{speciesId:e.species_id,sname:e.sname})}),this.newsList=e.data.news):this.newsList=this.newsList.concat(e.data.news),this.loadingUpdateFlag.setResult(!0)},e=>{this.loadingUpdateFlag.setResult(!1),this._alertService.error(this._translateService.translate("CONNECT_ERROR"))})}getLocalDisease(){this.loadingDiseaseFlag.setPending(!0),this._dashboardService.listDisease().pipe().subscribe(e=>{0==e.status?this._alertService.error(e.error):this.diseaseList=e.data,this.loadingDiseaseFlag.setResult(!0)},e=>{this.loadingDiseaseFlag.setResult(!1),this._alertService.error(this._translateService.translate("CONNECT_ERROR"))})}getDashboardUpdate(){this.loadingHomeFlag.setPending(!0),this._dashboardService.loadDashboard().pipe().subscribe(e=>{if(e.data){let t=[],i=[],s=[];void 0!==e.data.companys&&(this.localDb.setLocalData("company",e.data.companys[0]),this._companyService.setCompany(e.data.companys[0]),this._companyService.setCode(e.data.companys[0].code)),void 0!==e.data.farms&&e.data.farms.forEach(e=>{e.permission="farm_manager",null!=this.localDb.company&&e.company_id===this._companyService.company.id&&(e.permission="company_manager"),t.push({infor:e,store:[]})}),void 0!==e.data.ponds&&e.data.ponds.forEach(e=>{let a=t.findIndex(t=>t.infor.id==e.farm_id);e.permission=a>=0?t[a].infor.permission:"pond_manager";let n=this.localDb.ponds.findIndex(t=>t.infor.code==e.code);n>=0&&!0===this.localDb.ponds[n].favorite?s.push({infor:e,favorite:!0,devices:[]}):i.push({infor:e,devices:[]})}),this.localDb.setLocalData("farms",t),this.localDb.setLocalData("ponds",i.concat(s)),this.localDb.reloadLocalDb$.next(1)}else this.localDb.destroyData();this.loadingHomeFlag.setResult(!0)},e=>{this.loadingHomeFlag.setResult(!1),this._alertService.error(this._translateService.translate("CONNECT_ERROR"))})}getFarmPonds(e){return this.localDb.ponds.filter(t=>t.infor.farm_id===e.infor.id)}getFarmEmptyPonds(e){return this.localDb.ponds.filter(t=>t.infor.farm_id===e.infor.id&&"0"===t.infor.current_season)}openNews(e){let t=o.h_.SITE_PATH+"/tin-tuc/full/"+this.convertSlug(e.title)+"-"+e.news_id+".html";window.open(t)}convertSlug(e){return(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace(/\xe0|\xe1|\u1ea1|\u1ea3|\xe3|\xe2|\u1ea7|\u1ea5|\u1ead|\u1ea9|\u1eab|\u0103|\u1eb1|\u1eaf|\u1eb7|\u1eb3|\u1eb5/g,"a")).replace(/\xe8|\xe9|\u1eb9|\u1ebb|\u1ebd|\xea|\u1ec1|\u1ebf|\u1ec7|\u1ec3|\u1ec5/g,"e")).replace(/\xec|\xed|\u1ecb|\u1ec9|\u0129/g,"i")).replace(/\xf2|\xf3|\u1ecd|\u1ecf|\xf5|\xf4|\u1ed3|\u1ed1|\u1ed9|\u1ed5|\u1ed7|\u01a1|\u1edd|\u1edb|\u1ee3|\u1edf|\u1ee1/g,"o")).replace(/\xf9|\xfa|\u1ee5|\u1ee7|\u0169|\u01b0|\u1eeb|\u1ee9|\u1ef1|\u1eed|\u1eef/g,"u")).replace(/\u1ef3|\xfd|\u1ef5|\u1ef7|\u1ef9/g,"y")).replace(/\u0111/g,"d")).replace(/\xc0|\xc1|\u1ea0|\u1ea2|\xc3|\xc2|\u1ea6|\u1ea4|\u1eac|\u1ea8|\u1eaa|\u0102|\u1eb0|\u1eae|\u1eb6|\u1eb2|\u1eb4/g,"A")).replace(/\xc8|\xc9|\u1eb8|\u1eba|\u1ebc|\xca|\u1ec0|\u1ebe|\u1ec6|\u1ec2|\u1ec4/g,"E")).replace(/\xcc|\xcd|\u1eca|\u1ec8|\u0128/g,"I")).replace(/\xd2|\xd3|\u1ecc|\u1ece|\xd5|\xd4|\u1ed2|\u1ed0|\u1ed8|\u1ed4|\u1ed6|\u01a0|\u1edc|\u1eda|\u1ee2|\u1ede|\u1ee0/g,"O")).replace(/\xd9|\xda|\u1ee4|\u1ee6|\u0168|\u01af|\u1eea|\u1ee8|\u1ef0|\u1eec|\u1eee/g,"U")).replace(/\u1ef2|\xdd|\u1ef4|\u1ef6|\u1ef8/g,"Y")).replace(/\u0110/g,"D")).replace(/\u0300|\u0301|\u0303|\u0309|\u0323/g,"")).replace(/\u02C6|\u0306|\u031B/g,"")).replace(/ + /g," ")).replace(/&quot;|!|@|%|\^|\*|\(|\)|\+|\=|\<|\>|\?|\/|,|\.|\:|\;|\'|\"|\&|\#|\[|\]|~|\$|_|`|-|{|}|\||\\|/g,"")).replace(/ /g,"-")).toLowerCase()}loadMoreNews(){this.page+=1}presentWeatherPredict(){this.weatherWeekData&&this._matDialog.open(r.J,{autoFocus:!1,data:this.weatherWeekData})}presentPriceHistory(e){this._matDialog.open(A,{autoFocus:!1,data:e})}showSpeciesSetting(e){this._matDialog.open(F,{autoFocus:!1,data:e}).afterClosed().subscribe(()=>{this.getPriceAndNewsUpdate()})}goToRegisterCompany(){this._router.navigateByUrl("/company-register")}}return e.\u0275fac=function(t){return new(t||e)(c.Y36(d.c),c.Y36(J.B),c.Y36(p.Vn),c.Y36(g.s),c.Y36(R.J),c.Y36(l.uw),c.Y36(q.T),c.Y36(a.F0),c.Y36(Y.T))},e.\u0275cmp=c.Xpm({type:e,selectors:[["app-dashboard"]],decls:1,vars:1,consts:[[4,"transloco","translocoRead"],[1,"flex","flex-col","flex-auto","min-w-0"],[1,"flex-auto","p-6","sm:p-10"],[1,"flex","flex-col","flex-auto","w-full","sm:items-start","sm:flex-row-reverse"],[1,"flex","flex-wrap","w-full","pb-10","sm:p-0","sm:w-1/3","xl:w-1/4"],[1,"flex","items-center","justify-between","w-full"],[1,"text-3xl","font-semibold","tracking-tight","leading-8"],[1,"font-medium","tracking-tight","text-secondary"],[1,"grid","grid-cols-1","w-full","mt-8"],[1,"grid","grid-cols-1","sm:grid-cols-6","gap-6","w-full","min-w-0"],[1,"col-span-6","flex","flex-col","flex-auto","p-6","bg-card","shadow","rounded-2xl","divide-y","overflow-hidden","sm:overflow-auto"],[1,"flex","flex-col","sm:flex-row","items-end","justify-between"],[1,"flex","flex-row","items-end","text-lg","font-medium","tracking-tight","leading-6","truncate"],["class","inline-flex w-8 h-7 mr-3",3,"src",4,"ngIf"],["svgIcon","iconsmind:cloud_sun","class","mr-4",4,"ngIf"],[1,"items-center","cursor-pointer",3,"click"],[1,"icon-size-6",3,"svgIcon"],[1,"flex","flex-col","mt-2"],[1,"flex","flex-row","items-center","justify-between","py-4","px-0.5"],[3,"mode",4,"ngIf"],[1,"flex","flex-col","font-medium"],[4,"ngIf"],["class","col-span-6 flex flex-col flex-auto p-6 bg-card shadow rounded-2xl overflow-hidden sm:overflow-auto",4,"ngIf"],[1,"col-span-6","flex","flex-col","flex-auto","p-6","bg-card","shadow","rounded-2xl","overflow-hidden","sm:overflow-auto"],[1,"text-lg","font-medium","tracking-tight","leading-6","truncate"],["svgIcon","iconsmind:line_chart",1,"mr-4"],["svgIcon","heroicons_outline:cog"],[1,"max-h-40","sm:max-h-full","overflow-y-auto","divide-y"],["class","flex flex-row items-center justify-between py-4 px-0.5",4,"ngFor","ngForOf"],[1,"flex","flex-wrap","w-full","max-w-screen-xl","sm:pr-10"],["class","mt-3 p-6 bg-card shadow rounded-2xl overflow-hidden text-lg font-medium",4,"ngIf"],["class","sm:col-span-2 flex flex-col flex-auto p-6 bg-card shadow rounded-2xl overflow-hidden",3,"routerLink",4,"ngFor","ngForOf"],[1,"inline-flex","w-8","h-7","mr-3",3,"src"],["svgIcon","iconsmind:cloud_sun",1,"mr-4"],[3,"mode"],[1,"text-red-500",3,"ngClass"],[3,"ngClass"],["svgIcon","iconsmind:bug",1,"mr-4"],[1,"max-h-40","overflow-y-auto","divide-y"],[1,"flex","flex-col"],[1,"font-medium"],[1,"text-red-500"],[1,"flex","flex-row","items-center","justify-end"],[1,"font-medium","text-green-500","mr-2"],[1,"cursor-pointer",3,"click"],[1,"icon-size-4",3,"svgIcon"],[1,"mt-3","p-6","bg-card","shadow","rounded-2xl","overflow-hidden","text-lg","font-medium"],["mat-raised-button","",1,"fuse-mat-button","mt-3",3,"color","click"],[1,"mr-2"],[1,"icon-size-5",3,"svgIcon"],[1,"sm:col-span-2","flex","flex-col","flex-auto","p-6","bg-card","shadow","rounded-2xl","overflow-hidden",3,"routerLink"],[1,"text-md","text-secondary","truncate"],[1,"flex","items-center","max-w-80","w-full","p-6","filter-info"],["svgIcon","heroicons_solid:farmext-farm",1,"icon-size-12","mr-6"],[1,"py-4","px-0.5"],[1,"text-2xl","font-semibold","leading-tight"],[1,"font-bold"],[1,"text-green-500"],[1,"text-amber-500"],["svgIcon","heroicons_solid:farmext-pond",1,"icon-size-12","mr-6",3,"ngClass"],[1,"text-2xl","font-semibold","leading-tight","text-secondary",3,"ngClass"],["class","text-md text-secondary truncate",4,"ngIf"]],template:function(e,t){1&e&&c.YNc(0,ae,57,20,"ng-container",0),2&e&&c.Q6J("translocoRead","DASHBOARD")},directives:[p.KI,s.O5,m.Hw,s.sg,C.pW,s.mk,f.lW,a.yS],pipes:[s.JJ],styles:[""]}),e})();var oe=i(4083),re=i(44466);const le=[{path:"",component:ne}];let ce=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=c.oAB({type:e}),e.\u0275inj=c.cJS({imports:[[s.ez,h.N,p.y4,oe.q,re.m,a.Bz.forChild(le)]]}),e})()}}]);