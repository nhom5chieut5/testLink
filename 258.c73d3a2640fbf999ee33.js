(self.webpackChunk_fuse_demo=self.webpackChunk_fuse_demo||[]).push([[258],{7258:(e,t,i)=>{"use strict";i.r(t),i.d(t,{FarmModule:()=>pi});var r=i(38583),a=i(95987),o=i(3679),n=i(5396),s=i(16738),l=i.n(s),c=i(28049),d=i(22238),m=i(37716),u=i(76891),p=i(8394),f=i(40704),g=i(51095),h=i(76627),Z=i(98295),v=i(49983),_=i(43220),x=i(67441),A=i(72458),T=i(12178);function q(e,t){1&e&&m._UZ(0,"mat-progress-bar",32),2&e&&m.Q6J("mode","indeterminate")}function S(e,t){if(1&e&&(m.TgZ(0,"mat-option",33),m._uU(1),m.qZA()),2&e){const e=t.$implicit;m.Q6J("value",e),m.xp6(1),m.hij(" ",e," ")}}function b(e,t){if(1&e&&(m.TgZ(0,"mat-option",33),m._uU(1),m.qZA()),2&e){const e=t.$implicit;m.Q6J("value",e),m.xp6(1),m.hij(" ",e," ")}}function N(e,t){if(1&e&&(m.TgZ(0,"mat-option",33),m._uU(1),m.qZA()),2&e){const e=t.$implicit;m.Q6J("value",e.user_id),m.xp6(1),m.hij(" ",e.user_name," ")}}function F(e,t){if(1&e&&(m.TgZ(0,"mat-option",33),m._uU(1),m.qZA()),2&e){const e=t.$implicit;m.Q6J("value",e.code),m.xp6(1),m.AsE(" ",e.name," (",e.farm_name,") ")}}function y(e,t){if(1&e&&(m.TgZ(0,"mat-option",33),m._uU(1),m.qZA()),2&e){const e=t.$implicit;m.Q6J("value",e.value),m.xp6(1),m.hij(" ",e.label," ")}}function w(e,t){if(1&e){const e=m.EpF();m.ynx(0),m.TgZ(1,"div",1),m.TgZ(2,"div",2),m.TgZ(3,"div",3),m._uU(4),m.qZA(),m.TgZ(5,"button",4),m._UZ(6,"mat-icon",5),m.qZA(),m.qZA(),m.TgZ(7,"div",6),m.TgZ(8,"div"),m.YNc(9,q,1,1,"mat-progress-bar",7),m.qZA(),m.TgZ(10,"div",8),m.TgZ(11,"div",9),m.TgZ(12,"mat-form-field",10),m.TgZ(13,"mat-label"),m._uU(14),m.qZA(),m.TgZ(15,"input",11),m.NdJ("click",function(){return m.CHM(e),m.MAs(18).open()}),m.qZA(),m._UZ(16,"mat-datepicker-toggle",12),m._UZ(17,"mat-datepicker",null,13),m.qZA(),m.TgZ(19,"mat-form-field",14),m.TgZ(20,"mat-label"),m._uU(21),m.qZA(),m.TgZ(22,"mat-select",15),m.YNc(23,S,2,2,"mat-option",16),m.qZA(),m.qZA(),m.TgZ(24,"mat-form-field",17),m.TgZ(25,"mat-label"),m._uU(26),m.qZA(),m.TgZ(27,"mat-select",18),m.YNc(28,b,2,2,"mat-option",16),m.qZA(),m.qZA(),m.qZA(),m.TgZ(29,"mat-form-field",19),m.TgZ(30,"mat-label"),m._uU(31),m.qZA(),m.TgZ(32,"mat-select",20),m.TgZ(33,"mat-option",21),m._uU(34),m.qZA(),m.YNc(35,N,2,2,"mat-option",16),m.qZA(),m.qZA(),m.TgZ(36,"mat-form-field",19),m.TgZ(37,"mat-label"),m._uU(38),m.qZA(),m.TgZ(39,"mat-select",22),m.TgZ(40,"mat-option",23),m._uU(41),m.qZA(),m.YNc(42,F,2,3,"mat-option",16),m.qZA(),m.qZA(),m.TgZ(43,"div",24),m.TgZ(44,"mat-form-field",19),m.TgZ(45,"mat-label"),m._uU(46),m.qZA(),m.TgZ(47,"mat-select",25),m.NdJ("selectionChange",function(t){return m.CHM(e),m.oxw().valueCheckBlur(t)}),m.YNc(48,y,2,2,"mat-option",16),m.qZA(),m.qZA(),m.TgZ(49,"div",24),m.TgZ(50,"mat-form-field",19),m.TgZ(51,"mat-label"),m._uU(52),m.qZA(),m.TgZ(53,"input",26),m.NdJ("blur",function(){return m.CHM(e),m.oxw().valueCheckBlur()})("keypress",function(t){return m.CHM(e),m.oxw().validateNo(t)}),m.qZA(),m.TgZ(54,"span",27),m._uU(55,"Kg \xa0"),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.TgZ(56,"mat-form-field",19),m.TgZ(57,"mat-label"),m._uU(58),m.qZA(),m.TgZ(59,"textarea",28),m._uU(60,"                        "),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.TgZ(61,"div",29),m.TgZ(62,"button",30),m.TgZ(63,"span"),m._uU(64),m.qZA(),m.qZA(),m.TgZ(65,"button",31),m.NdJ("click",function(){return m.CHM(e),m.oxw().createFarmCalendar()}),m.TgZ(66,"span"),m._uU(67),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.BQk()}if(2&e){const e=t.$implicit,i=m.MAs(18),r=m.oxw();m.xp6(4),m.Oqu(e("CREATE")),m.xp6(1),m.Q6J("tabIndex",-1),m.xp6(1),m.Q6J("svgIcon","heroicons_outline:x"),m.xp6(1),m.Q6J("formGroup",r.form),m.xp6(2),m.Q6J("ngIf",r.savingFlag.pending),m.xp6(5),m.Oqu(e("DATE")),m.xp6(1),m.Q6J("matDatepicker",i)("max",r.maxDate.format("YYYY-MM-DD"))("min",r.minDate.format("YYYY-MM-DD")),m.xp6(1),m.Q6J("for",i),m.xp6(5),m.hij(" ",e("HOUR")," "),m.xp6(2),m.Q6J("ngForOf",r.timeHours),m.xp6(3),m.hij("",e("MINUTE")," "),m.xp6(2),m.Q6J("ngForOf",r.timeMinutes),m.xp6(3),m.Oqu(e("USERS")),m.xp6(3),m.hij(" ",e("None")," "),m.xp6(1),m.Q6J("ngForOf",r.userList),m.xp6(3),m.Oqu(e("FARM_POND")),m.xp6(3),m.hij(" ",e("ALL")," "),m.xp6(1),m.Q6J("ngForOf",r.pondsList),m.xp6(1),m.Q6J("hidden","detailsAll"==r.form.controls.details.value),m.xp6(3),m.Oqu(e("WORK")),m.xp6(2),m.Q6J("ngForOf",r.keyChecks),m.xp6(1),m.Q6J("hidden","checkAll"==r.form.controls.key_check.value),m.xp6(3),m.hij("",e("THRESHOLD")," "),m.xp6(6),m.Oqu(e("NOTE")),m.xp6(4),m.Q6J("color","secondary"),m.xp6(2),m.hij(" ",e("CANCEL")," "),m.xp6(1),m.Q6J("color","primary")("disabled",!r.form.valid),m.xp6(2),m.hij(" ",e("SAVE")," ")}}let C=(()=>{class e{constructor(e,t,i,r,a,o){this.data=e,this.dialogRef=t,this._formBuilder=i,this._farmService=r,this._translateService=a,this._alertService=o,this.maxDate=l()().add(10,"days"),this.minDate=l()(),this.savingFlag=new n.E,this.timeMinutes=[0,5,10,15,20,25,30,35,40,45,50,55],this.timeHours=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],this.pondsList=[],this.userList=[],this.ucode="",this.pcode="",this.today=new Date,this.keyChecks=[{label:this._translateService.translate("FARM.CALENDARS.ALL"),value:"checkAll"},{label:this._translateService.translate("FARM.CALENDARS.FEEDING"),value:"feed"},{label:this._translateService.translate("FARM.CALENDARS.WATER"),value:"water"}]}ngOnInit(){this.validatorsForm(),this.getListPond(),this.getListUsers(),console.log(this.keyChecks)}getListPond(){this._farmService.loadPonds().pipe().subscribe(e=>{console.log(e.data),console.log(this.pondsList),0==e.status?this._alertService.error(e.error):(this.pondsList=e.data,this.pondsList.length>0&&(this.pcode=this.pondsList[0].code))},e=>{this._alertService.error(this._translateService.translate("CONNECT_ERROR")),this.dialogRef.close()})}getListUsers(){this._farmService.loadUsers().pipe().subscribe(e=>{0==e.status?this._alertService.error(e.error):(this.userList=e.data,this.userList.length>0&&(this.ucode=this.userList[0].user_id))},e=>{this._alertService.error(this._translateService.translate("CONNECT_ERROR")),this.dialogRef.close()})}validatorsForm(){this.form=this._formBuilder.group({date:[new Date,[o.kI.required]],timeHour:[this.today.getHours(),[o.kI.required]],timeMinute:[this.today.getMinutes()-this.today.getMinutes()%5+(this.today.getMinutes()%5==0?0:5),[o.kI.required]],content:["",[o.kI.required]],farm_id:[this.data.parameter],details:["detailsAll",[o.kI.required]],user:["userAll",[o.kI.required]],time:{timeHour:[""],timeMinute:[""]},key_check:["checkAll"],value_check:[],reference_id:[this.data.id]}),this.data.id&&this.form.patchValue({content:this.data.todo,details:this.data.pond_code})}valueCheckBlur(){const e=this.keyChecks.find(e=>e.value==this.form.value.key_check);this.form.patchValue(null==this.form.value.value_check||"checkAll"==this.form.value.key_check?{content:e.label}:{content:e.label+" "+this.form.value.value_check+"kg"})}validateNo(e){const t=e.which?e.which:e.keyCode;return!(t>31&&(t<48||t>57))}createFarmCalendar(){this.savingFlag.setPending(!0);let e={time:this.form.value.timeHour+":"+this.form.value.timeMinute,farm_id:this.data.parameter,content:this.form.value.content,user_perform:"userAll"==this.form.value.user?"":this.form.value.user,key_check:"checkAll"==this.form.value.key_check?"":this.form.value.key_check,value_check:this.form.value.value_check,date:l()(this.form.value.date).format("YYYY-MM-DD"),pond_id:"detailsAll"==this.form.value.details?"":this.form.value.details,reference_id:this.form.value.reference_id};console.log(e.farm_id,e.pond_id),this.form.valid&&this._farmService.createCalendar(e).subscribe(e=>{e.error||"1"!=e.status?this._alertService.error(e.message):this.dialogRef.close(!0),this.savingFlag.setResult(!0)},e=>{this._alertService.error(this._translateService.translate("CONNECT_ERROR")),this.savingFlag.setResult(!1)})}}return e.\u0275fac=function(t){return new(t||e)(m.Y36(d.WI),m.Y36(d.so),m.Y36(o.qu),m.Y36(u.D),m.Y36(p.Vn),m.Y36(f.c))},e.\u0275cmp=m.Xpm({type:e,selectors:[["app-farm-calendar-create"]],inputs:{parameter:"parameter"},decls:1,vars:1,consts:[[4,"transloco","translocoRead"],[1,"flex","flex-col","max-w-240","md:min-w-160","max-h-screen","-m-6"],[1,"flex","flex-0","items-center","justify-between","h-16","pr-3","sm:pr-5","pl-6","sm:pl-8","bg-primary","text-on-primary"],[1,"text-lg","font-medium"],["mat-icon-button","","mat-dialog-close","",3,"tabIndex"],[1,"text-current",3,"svgIcon"],[1,"flex","flex-col","flex-auto","p-6","sm:p-8","overflow-y-auto","sm:pb-0",3,"formGroup"],[3,"mode",4,"ngIf"],[1,"w-full"],[1,"flex","items-center"],["appearance","fill",1,"flex-auto","mr-6"],["matInput","","formControlName","date","required","",3,"matDatepicker","max","min","click"],["matSuffix","",3,"for"],["picker2",""],[1,"flex-auto","mr-6"],["formControlName","timeHour","required",""],[3,"value",4,"ngFor","ngForOf"],[1,"flex-auto"],["formControlName","timeMinute","required",""],["appearance","fill",1,"example-full-width"],["formControlName","user","required",""],["value","userAll"],["formControlName","details","required",""],["value","detailsAll"],[3,"hidden"],["formControlName","key_check","required","",3,"selectionChange"],["matInput","","placeholder","0","formControlName","value_check",3,"blur","keypress"],["matSuffix",""],["matInput","","formControlName","content","required",""],[1,"flex","flex-0","items-center","justify-end","h-16","pr-3","sm:pr-5","pl-6","sm:pl-8"],["mat-stroked-button","","mat-dialog-close","",1,"fuse-mat-button","mr-3",3,"color"],["mat-flat-button","",1,"fuse-mat-button",3,"color","disabled","click"],[3,"mode"],[3,"value"]],template:function(e,t){1&e&&m.YNc(0,w,68,31,"ng-container",0),2&e&&m.Q6J("translocoRead","FARM.CALENDARS")},directives:[p.KI,g.lW,d.ZT,h.Hw,o.JL,o.sg,r.O5,Z.KE,Z.hX,v.Nt,o.Fj,_.hl,o.JJ,o.u,o.Q7,_.nW,Z.R9,_.Mq,x.gD,r.sg,A.ey,T.pW],styles:[".example-form[_ngcontent-%COMP%]{min-width:150px;max-width:500px;width:100%}.example-full-width[_ngcontent-%COMP%]{width:100%}"]}),e})();function I(e,t){1&e&&m._UZ(0,"mat-progress-bar",32),2&e&&m.Q6J("mode","indeterminate")}function R(e,t){if(1&e&&(m.TgZ(0,"mat-option",33),m._uU(1),m.qZA()),2&e){const e=t.$implicit;m.Q6J("value",e),m.xp6(1),m.hij(" ",e," ")}}function E(e,t){if(1&e&&(m.TgZ(0,"mat-option",33),m._uU(1),m.qZA()),2&e){const e=t.$implicit;m.Q6J("value",e),m.xp6(1),m.hij(" ",e," ")}}function O(e,t){if(1&e&&(m.TgZ(0,"mat-option",33),m._uU(1),m.qZA()),2&e){const e=t.$implicit;m.Q6J("value",e.user_id),m.xp6(1),m.hij(" ",e.user_name," ")}}function U(e,t){if(1&e&&(m.TgZ(0,"mat-option",33),m._uU(1),m.qZA()),2&e){const e=t.$implicit;m.Q6J("value",e.code),m.xp6(1),m.AsE(" ",e.name," (",e.farm_name,") ")}}function k(e,t){if(1&e&&(m.TgZ(0,"mat-option",34),m._uU(1),m.qZA()),2&e){const e=t.$implicit;m.Q6J("value",e.value),m.xp6(1),m.hij(" ",e.label," ")}}function J(e,t){if(1&e){const e=m.EpF();m.ynx(0),m.TgZ(1,"div",1),m.TgZ(2,"div",2),m.TgZ(3,"div",3),m._uU(4),m.qZA(),m.TgZ(5,"button",4),m._UZ(6,"mat-icon",5),m.qZA(),m.qZA(),m.TgZ(7,"div",6),m.TgZ(8,"div"),m.YNc(9,I,1,1,"mat-progress-bar",7),m.qZA(),m.TgZ(10,"div",8),m.TgZ(11,"div",9),m.TgZ(12,"mat-form-field",10),m.TgZ(13,"mat-label"),m._uU(14),m.qZA(),m.TgZ(15,"input",11),m.NdJ("click",function(){return m.CHM(e),m.MAs(18).open()}),m.qZA(),m._UZ(16,"mat-datepicker-toggle",12),m._UZ(17,"mat-datepicker",null,13),m.qZA(),m.TgZ(19,"mat-form-field",14),m.TgZ(20,"mat-label"),m._uU(21),m.qZA(),m.TgZ(22,"mat-select",15),m.YNc(23,R,2,2,"mat-option",16),m.qZA(),m.qZA(),m.TgZ(24,"mat-form-field",17),m.TgZ(25,"mat-label"),m._uU(26),m.qZA(),m.TgZ(27,"mat-select",18),m.YNc(28,E,2,2,"mat-option",16),m.qZA(),m.qZA(),m.qZA(),m.TgZ(29,"mat-form-field",19),m.TgZ(30,"mat-label"),m._uU(31),m.qZA(),m.TgZ(32,"mat-select",20),m.TgZ(33,"mat-option",21),m._uU(34),m.qZA(),m.YNc(35,O,2,2,"mat-option",16),m.qZA(),m.qZA(),m.TgZ(36,"mat-form-field",19),m.TgZ(37,"mat-label"),m._uU(38),m.qZA(),m.TgZ(39,"mat-select",22),m.TgZ(40,"mat-option",23),m._uU(41),m.qZA(),m.YNc(42,U,2,3,"mat-option",16),m.qZA(),m.qZA(),m.TgZ(43,"div",24),m.TgZ(44,"mat-form-field",19),m.TgZ(45,"mat-label"),m._uU(46),m.qZA(),m.TgZ(47,"mat-select",25),m.YNc(48,k,2,2,"mat-option",26),m.qZA(),m.qZA(),m.TgZ(49,"div",24),m.TgZ(50,"mat-form-field",19),m.TgZ(51,"mat-label"),m._uU(52),m.qZA(),m.TgZ(53,"input",27),m.NdJ("input",function(t){return m.CHM(e),m.oxw().valueCheck(t)})("keypress",function(t){return m.CHM(e),m.oxw().validateNo(t)}),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.TgZ(54,"mat-form-field",19),m.TgZ(55,"mat-label"),m._uU(56),m.qZA(),m.TgZ(57,"textarea",28),m.NdJ("keyup",function(t){return m.CHM(e),m.oxw().keyupF(t)}),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.TgZ(58,"div",29),m.TgZ(59,"button",30),m.TgZ(60,"span"),m._uU(61),m.qZA(),m.qZA(),m.TgZ(62,"button",31),m.NdJ("click",function(){return m.CHM(e),m.oxw().saveEdit()}),m.TgZ(63,"span"),m._uU(64),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.BQk()}if(2&e){const e=t.$implicit,i=m.MAs(18),r=m.oxw();m.xp6(4),m.Oqu(e("EDIT_CALENDARS")),m.xp6(1),m.Q6J("tabIndex",-1),m.xp6(1),m.Q6J("svgIcon","heroicons_outline:x"),m.xp6(1),m.Q6J("formGroup",r.formEdit),m.xp6(2),m.Q6J("ngIf",r.savingFlag.pending),m.xp6(3),m.Q6J("hideRequiredMarker",!0),m.xp6(2),m.Oqu(e("DATE")),m.xp6(1),m.Q6J("matDatepicker",i),m.xp6(1),m.Q6J("for",i),m.xp6(5),m.Oqu(e("HOUR")),m.xp6(2),m.Q6J("ngForOf",r.timeHours),m.xp6(3),m.hij("",e("MINUTE")," "),m.xp6(2),m.Q6J("ngForOf",r.timeMinutes),m.xp6(3),m.Oqu(e("USERS")),m.xp6(3),m.hij(" ",r.user_name," "),m.xp6(1),m.Q6J("ngForOf",r.userList),m.xp6(3),m.Oqu(e("FARM_POND")),m.xp6(3),m.hij(" ",e("ALL")," "),m.xp6(1),m.Q6J("ngForOf",r.listPonds),m.xp6(1),m.Q6J("hidden","detailsAll"==r.formEdit.controls.details.value),m.xp6(3),m.Oqu(e("WORK")),m.xp6(2),m.Q6J("ngForOf",r.keyChecks),m.xp6(1),m.Q6J("hidden","checkAll"==r.formEdit.controls.key_check.value),m.xp6(3),m.hij("",e("THRESHOLD")," "),m.xp6(4),m.Oqu(e("NOTE")),m.xp6(3),m.Q6J("color","secondary"),m.xp6(2),m.hij(" ",e("CANCEL")," "),m.xp6(1),m.Q6J("disabled",r.saveFalsy)("color","primary"),m.xp6(2),m.hij(" ",e("SAVE")," ")}}let M=(()=>{class e{constructor(e,t,i,r,a,o){this.data=e,this.dialogRef=t,this._farmService=i,this._alertService=r,this._translateService=a,this._formBuilder=o,this.savingFlag=new n.E,this.timeMinutes=[0,5,10,15,20,25,30,35,40,45,50,55],this.timeHours=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,21,23],this.listPonds=[],this.userList=[],this.saveFalsy=Number(this.data.time)<=l()().startOf("day").valueOf()/1e3,this.keyChecks=[{label:this._translateService.translate("FARM.CALENDARS.ALL"),value:"checkAll"},{label:this._translateService.translate("FARM.CALENDARS.FEEDING"),value:"feed"},{label:this._translateService.translate("FARM.CALENDARS.WATER"),value:"water"}]}ngOnInit(){this.getListPond(),this.getListUsers(),this.farmCalendarInitDataForE(),this.checkSaveFalshy(),""==this.formEdit.value.content&&(this.saveFalsy=!0)}keyupF(e){this.saveFalsy=""==e.target.value}checkSaveFalshy(){0==Number(l()(1e3*this.data.time).format("H"))&&0==Number(l()(1e3*this.data.time).format("m"))&&(this.saveFalsy=!1,console.log(this.saveFalsy))}getListPond(){this._farmService.loadPonds().pipe().subscribe(e=>{0==e.status?this._alertService.error(e.error):this.listPonds=e.data},e=>{this._alertService.error(this._translateService.translate("CONNECT_ERROR")),this.dialogRef.close()})}getListUsers(){this._farmService.loadUsers().pipe().subscribe(e=>{0==e.status?this._alertService.error(e.error):this.userList=e.data},e=>{this._alertService.error(this._translateService.translate("CONNECT_ERROR")),this.dialogRef.close()})}valueCheck(e){this.formEdit.patchValue({content:this.formEdit.value.key_check+" "+this.formEdit.value.value_check+"kg"})}farmCalendarInitDataForE(){console.log("key check of data",this.data),this.formEdit=this._formBuilder.group({content:[this.data.content,[o.kI.required]],date:[l()(1e3*this.data.time).format("YYYY-MM-DD"),[o.kI.required]],timeHour:[parseInt(l()(1e3*this.data.time).format("H")),[o.kI.required]],timeMinute:[parseInt(l()(1e3*this.data.time).format("mm")),[o.kI.required]],farm_id:[this.data.farm_id,[o.kI.required]],pond_id:[this.data.pond_id,[o.kI.required]],details:[0==this.data.pond_id?"detailsAll":this.data.pond_id,[o.kI.required]],user:[0==this.data.user_perform?"user":this.data.user_perform,[o.kI.required]],key_check:[0==this.data.key_check?"checkAll":this.data.key_check,[o.kI.required]],value_check:[this.data.value_check,[o.kI.required]]})}validateNo(e){const t=e.which?e.which:e.keyCode;return!(t>31&&(t<48||t>57))}saveEdit(){this.savingFlag.setPending(!0);let e={time:this.formEdit.value.timeHour+":"+this.formEdit.value.timeMinute,content:this.formEdit.value.content,date:l()(this.formEdit.value.date).format("YYYY-MM-DD"),farm_id:this.formEdit.value.farm_id,pond_id:"detailsAll"==this.formEdit.value.details?"":this.formEdit.value.details,user_perform:"user"==this.formEdit.value.user?"":this.formEdit.value.user,key_check:"checkAll"==this.formEdit.value.key_check?"":this.formEdit.value.key_check,value_check:this.formEdit.value.value_check};this._farmService.editCalendar(this.data.id,e).pipe((0,c.P)()).subscribe(t=>{0==t.status?this._alertService.error(t.error):this.dialogRef.close(e),this.savingFlag.setResult(!0)},e=>{this._alertService.error(this._translateService.translate("CONNECT_ERROR")),this.savingFlag.setResult(!1)})}}return e.\u0275fac=function(t){return new(t||e)(m.Y36(d.WI),m.Y36(d.so),m.Y36(u.D),m.Y36(f.c),m.Y36(p.Vn),m.Y36(o.qu))},e.\u0275cmp=m.Xpm({type:e,selectors:[["app-farm-calendar-edit"]],decls:1,vars:1,consts:[[4,"transloco","translocoRead"],[1,"flex","flex-col","max-w-240","md:min-w-160","max-h-screen","-m-6"],[1,"flex","flex-0","items-center","justify-between","h-16","pr-3","sm:pr-5","pl-6","sm:pl-8","bg-primary","text-on-primary"],[1,"text-lg","font-medium"],["mat-icon-button","","mat-dialog-close","",3,"tabIndex"],[1,"text-current",3,"svgIcon"],[1,"flex","flex-col","flex-auto","p-6","sm:p-8","overflow-y-auto","sm:pb-0",3,"formGroup"],[3,"mode",4,"ngIf"],[1,"w-full"],[1,"flex","items-center"],["appearance","fill",1,"flex-auto","mr-6",3,"hideRequiredMarker"],["matInput","","formControlName","date",3,"matDatepicker","click"],["matSuffix","",3,"for"],["picker2",""],[1,"flex-auto","mr-6"],["formControlName","timeHour","required",""],[3,"value",4,"ngFor","ngForOf"],[1,"flex-auto"],["formControlName","timeMinute","required",""],["appearance","fill",1,"example-full-width"],["formControlName","user","required",""],["value","user"],["formControlName","details","required",""],["value","detailsAll"],[3,"hidden"],["formControlName","key_check","required",""],["value","eat",3,"value",4,"ngFor","ngForOf"],["matInput","","formControlName","value_check","required","",3,"input","keypress"],["matInput","","formControlName","content","required","",3,"keyup"],[1,"flex","flex-0","items-center","justify-end","h-16","pr-3","sm:pr-5","pl-6","sm:pl-8"],["mat-flat-button","","mat-dialog-close","",1,"fuse-mat-button",3,"color"],["mat-flat-button","",1,"fuse-mat-button","mr-3",3,"disabled","color","click"],[3,"mode"],[3,"value"],["value","eat",3,"value"]],template:function(e,t){1&e&&m.YNc(0,J,65,30,"ng-container",0),2&e&&m.Q6J("translocoRead","FARM.CALENDARS")},directives:[p.KI,g.lW,d.ZT,h.Hw,o.JL,o.sg,r.O5,Z.KE,Z.hX,v.Nt,o.Fj,_.hl,o.JJ,o.u,_.nW,Z.R9,_.Mq,x.gD,o.Q7,r.sg,A.ey,T.pW],styles:[".example-form[_ngcontent-%COMP%]{min-width:150px;max-width:500px;width:100%}.example-full-width[_ngcontent-%COMP%]{width:100%}"]}),e})();var D=i(1400),Q=i(84796),L=i(7539),Y=i(33935),P=i(58341);function j(e,t){if(1&e&&(m.TgZ(0,"mat-option",23),m._uU(1),m.qZA()),2&e){const e=t.$implicit;m.Q6J("value",e.code),m.xp6(1),m.hij(" ",e.name," ")}}function H(e,t){1&e&&m._UZ(0,"mat-progress-bar",24),2&e&&m.Q6J("mode","indeterminate")}function $(e,t){if(1&e){const e=m.EpF();m.TgZ(0,"mat-chip-list",36),m.NdJ("cdkDropListDropped",function(t){return m.CHM(e),m.oxw(4).drop(t)}),m.TgZ(1,"mat-chip",37),m.TgZ(2,"mat-icon",38),m._uU(3,"assignment_ind"),m.qZA(),m._uU(4),m.qZA(),m.qZA()}if(2&e){const e=m.oxw().$implicit;m.xp6(4),m.hij(" ",e.user_name," ")}}function G(e,t){if(1&e){const e=m.EpF();m.TgZ(0,"div",27),m.TgZ(1,"div",18),m.TgZ(2,"mat-checkbox",28),m.NdJ("change",function(){const t=m.CHM(e).$implicit;return m.oxw(3).setDone(t)}),m.qZA(),m.qZA(),m.TgZ(3,"div",19),m.TgZ(4,"span"),m._uU(5),m.ALo(6,"date"),m.qZA(),m.qZA(),m.TgZ(7,"div",19),m._uU(8),m.qZA(),m.TgZ(9,"div",19),m.YNc(10,$,5,1,"mat-chip-list",29),m.qZA(),m.TgZ(11,"div",18),m.TgZ(12,"button",30),m._UZ(13,"mat-icon",31),m.qZA(),m.TgZ(14,"mat-menu",null,32),m.TgZ(16,"button",33),m.NdJ("click",function(){const t=m.CHM(e).$implicit;return m.oxw(3).editCalendar(t)}),m._UZ(17,"mat-icon",34),m.TgZ(18,"span"),m._uU(19),m.qZA(),m.qZA(),m.TgZ(20,"button",33),m.NdJ("click",function(){const t=m.CHM(e).$implicit;return m.oxw(3).presentDelete(t)}),m._UZ(21,"mat-icon",35),m.TgZ(22,"span"),m._uU(23),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.qZA()}if(2&e){const e=t.$implicit,i=m.MAs(15),r=m.oxw(2).$implicit;m.xp6(2),m.Q6J("checked",1==e.done),m.xp6(3),m.Oqu(m.xi3(6,7,1e3*e.time,"HH:mm dd-MM-yyyy")),m.xp6(3),m.hij(" ",e.content," "),m.xp6(2),m.Q6J("ngIf",e.user_name),m.xp6(2),m.Q6J("matMenuTriggerFor",i),m.xp6(7),m.Oqu(r("EDIT")),m.xp6(4),m.Oqu(r("DELETE"))}}function B(e,t){if(1&e&&(m.TgZ(0,"div",25),m.YNc(1,G,24,10,"div",26),m.qZA()),2&e){const e=m.oxw(2);m.xp6(1),m.Q6J("ngForOf",e.calendarListFarm)}}function W(e,t){1&e&&m._UZ(0,"mat-progress-bar",24),2&e&&m.Q6J("mode","indeterminate")}function V(e,t){if(1&e){const e=m.EpF();m.TgZ(0,"mat-chip-list",36),m.NdJ("cdkDropListDropped",function(t){return m.CHM(e),m.oxw(4).drop(t)}),m.TgZ(1,"mat-chip",37),m.TgZ(2,"mat-icon",38),m._uU(3,"assignment_ind"),m.qZA(),m._uU(4),m.qZA(),m.qZA()}if(2&e){const e=m.oxw().$implicit;m.xp6(4),m.hij(" ",e.user_name," ")}}function K(e,t){if(1&e){const e=m.EpF();m.TgZ(0,"div",27),m.TgZ(1,"div",18),m.TgZ(2,"mat-checkbox",28),m.NdJ("change",function(){const t=m.CHM(e).$implicit;return m.oxw(3).setDone(t)}),m.qZA(),m.qZA(),m.TgZ(3,"div",19),m.TgZ(4,"span"),m._uU(5),m.ALo(6,"date"),m.qZA(),m.qZA(),m.TgZ(7,"div",19),m._uU(8),m.qZA(),m.TgZ(9,"div",19),m.YNc(10,V,5,1,"mat-chip-list",29),m.qZA(),m.TgZ(11,"div",18),m.TgZ(12,"button",30),m._UZ(13,"mat-icon",31),m.qZA(),m.TgZ(14,"mat-menu",null,32),m.TgZ(16,"button",33),m.NdJ("click",function(){const t=m.CHM(e).$implicit;return m.oxw(3).editCalendar(t)}),m._UZ(17,"mat-icon",34),m.TgZ(18,"span"),m._uU(19),m.qZA(),m.qZA(),m.TgZ(20,"button",33),m.NdJ("click",function(){const t=m.CHM(e).$implicit;return m.oxw(3).presentDelete(t)}),m._UZ(21,"mat-icon",35),m.TgZ(22,"span"),m._uU(23),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.qZA()}if(2&e){const e=t.$implicit,i=m.MAs(15),r=m.oxw(2).$implicit;m.xp6(2),m.Q6J("checked",1==e.done),m.xp6(3),m.Oqu(m.xi3(6,7,1e3*e.time,"HH:mm dd-MM-yyyy")),m.xp6(3),m.hij(" ",e.content," "),m.xp6(2),m.Q6J("ngIf",e.user_name),m.xp6(2),m.Q6J("matMenuTriggerFor",i),m.xp6(7),m.Oqu(r("EDIT")),m.xp6(4),m.Oqu(r("DELETE"))}}function z(e,t){if(1&e&&(m.TgZ(0,"div",25),m.YNc(1,K,24,10,"div",26),m.qZA()),2&e){const e=m.oxw(2);m.xp6(1),m.Q6J("ngForOf",e.calendarListPond)}}function X(e,t){1&e&&m._UZ(0,"mat-progress-bar",24),2&e&&m.Q6J("mode","indeterminate")}function ee(e,t){if(1&e){const e=m.EpF();m.TgZ(0,"div",40),m.TgZ(1,"div",18),m.TgZ(2,"span"),m._uU(3),m.qZA(),m.qZA(),m.TgZ(4,"div",19),m.TgZ(5,"span"),m._uU(6),m.qZA(),m.qZA(),m.TgZ(7,"div",19),m.TgZ(8,"span"),m._uU(9),m.qZA(),m.qZA(),m.TgZ(10,"div",19),m.TgZ(11,"span"),m._uU(12),m.qZA(),m.qZA(),m.TgZ(13,"div",18),m.TgZ(14,"button",41),m.NdJ("click",function(){const t=m.CHM(e).$implicit;return m.oxw(3).addSuggest(t)}),m._UZ(15,"mat-icon",42),m.qZA(),m.qZA(),m.qZA()}if(2&e){const e=t.$implicit,i=m.oxw(2).$implicit;m.xp6(3),m.AsE("",e.begin," ",i("AGE"),""),m.xp6(3),m.AsE("",e.end," ",i("AGE"),""),m.xp6(3),m.hij(" ",e.todo,""),m.xp6(3),m.hij(" ",e.pond_name,"")}}function te(e,t){if(1&e&&(m.TgZ(0,"div",25),m.YNc(1,ee,16,6,"div",39),m.qZA()),2&e){const e=m.oxw(2);m.xp6(1),m.Q6J("ngForOf",e.calendarListSuggest)}}function ie(e,t){if(1&e){const e=m.EpF();m.ynx(0),m.TgZ(1,"div",1),m.TgZ(2,"div",2),m.TgZ(3,"div",3),m.TgZ(4,"mat-form-field",4),m.TgZ(5,"input",5),m.NdJ("ngModelChange",function(t){return m.CHM(e),m.oxw().startDate=t})("ngModelChange",function(){m.CHM(e);const t=m.oxw();return t.onTyping(t.startDate)}),m.qZA(),m._UZ(6,"mat-datepicker-toggle",6),m._UZ(7,"mat-datepicker",null,7),m.qZA(),m.TgZ(9,"mat-form-field",8),m.TgZ(10,"mat-select",9),m.NdJ("selectionChange",function(t){return m.CHM(e),m.oxw().onChange(t)})("ngModelChange",function(t){return m.CHM(e),m.oxw().pcode=t}),m.YNc(11,j,2,2,"mat-option",10),m.qZA(),m.qZA(),m.qZA(),m.TgZ(12,"div",11),m.TgZ(13,"button",12),m.NdJ("click",function(){return m.CHM(e),m.oxw().addCalendar()}),m._UZ(14,"mat-icon",13),m._uU(15),m.qZA(),m.qZA(),m.qZA(),m.TgZ(16,"p",14),m._uU(17),m.qZA(),m.TgZ(18,"div",15),m.TgZ(19,"div",16),m.TgZ(20,"div",17),m.TgZ(21,"div",18),m._uU(22),m.qZA(),m.TgZ(23,"div",19),m._uU(24),m.qZA(),m.TgZ(25,"div",19),m._uU(26),m.qZA(),m.TgZ(27,"div",19),m._uU(28),m.qZA(),m.TgZ(29,"div",18),m._uU(30),m.qZA(),m.qZA(),m.TgZ(31,"div"),m.YNc(32,H,1,1,"mat-progress-bar",20),m.qZA(),m.YNc(33,B,2,1,"div",21),m.qZA(),m.qZA(),m.TgZ(34,"p",14),m._uU(35),m.qZA(),m.TgZ(36,"div",15),m.TgZ(37,"div",16),m.TgZ(38,"div",17),m.TgZ(39,"div",18),m._uU(40),m.qZA(),m.TgZ(41,"div",19),m._uU(42),m.qZA(),m.TgZ(43,"div",19),m._uU(44),m.qZA(),m.TgZ(45,"div",19),m._uU(46),m.qZA(),m.TgZ(47,"div",18),m._uU(48),m.qZA(),m.qZA(),m.TgZ(49,"div"),m.YNc(50,W,1,1,"mat-progress-bar",20),m.qZA(),m.YNc(51,z,2,1,"div",21),m.qZA(),m.qZA(),m.TgZ(52,"p",14),m._uU(53),m.qZA(),m.TgZ(54,"div",15),m.TgZ(55,"div",16),m.TgZ(56,"div",22),m.TgZ(57,"div",18),m._uU(58),m.qZA(),m.TgZ(59,"div",19),m._uU(60),m.qZA(),m.TgZ(61,"div",19),m._uU(62),m.qZA(),m.TgZ(63,"div",19),m._uU(64),m.qZA(),m.TgZ(65,"div",18),m._uU(66),m.qZA(),m.qZA(),m.TgZ(67,"div"),m.YNc(68,X,1,1,"mat-progress-bar",20),m.qZA(),m.YNc(69,te,2,1,"div",21),m.qZA(),m.qZA(),m.qZA(),m.BQk()}if(2&e){const e=t.$implicit,i=m.MAs(8),r=m.oxw();m.xp6(5),m.Q6J("matDatepicker",i)("ngModel",r.startDate),m.xp6(1),m.Q6J("for",i),m.xp6(4),m.Q6J("ngModel",r.pcode),m.xp6(1),m.Q6J("ngForOf",r.pondsList),m.xp6(3),m.Q6J("svgIcon","iconsmind:folder_add"),m.xp6(1),m.hij(" ",e("ADD")," "),m.xp6(2),m.Oqu(e("FARM")),m.xp6(5),m.hij(" ",e("STATUS")," "),m.xp6(2),m.hij(" ",e("TIME")," "),m.xp6(2),m.hij(" ",e("CONTENT")," "),m.xp6(2),m.hij(" ",e("USER")," "),m.xp6(2),m.hij(" ",e("ACTIONS")," "),m.xp6(2),m.Q6J("ngIf",r.loadingFlag.pending),m.xp6(1),m.Q6J("ngIf",r.calendarListFarm&&!r.loadingFlag.pending),m.xp6(2),m.Oqu(e("POND")),m.xp6(5),m.hij(" ",e("STATUS")," "),m.xp6(2),m.hij(" ",e("TIME")," "),m.xp6(2),m.hij(" ",e("CONTENT")," "),m.xp6(2),m.hij(" ",e("USER")," "),m.xp6(2),m.hij(" ",e("ACTIONS")," "),m.xp6(2),m.Q6J("ngIf",r.loadingFlag.pending),m.xp6(1),m.Q6J("ngIf",r.calendarListPond&&!r.loadingFlag.pending),m.xp6(2),m.Oqu(e("SUGGEST")),m.xp6(5),m.hij(" ",e("STARTING_AGE")," "),m.xp6(2),m.hij(" ",e("END_AGE")," "),m.xp6(2),m.hij(" ",e("CONTENT")," "),m.xp6(2),m.hij(" ",e("POND")," "),m.xp6(2),m.hij(" ",e("ACTIONS")," "),m.xp6(2),m.Q6J("ngIf",r.loadingFlag.pending),m.xp6(1),m.Q6J("ngIf",r.calendarListSuggest&&!r.loadingFlag.pending)}}let re=(()=>{class e{constructor(e,t,i,r,a,s,c){this._farmService=e,this._matDialog=t,this._alertService=i,this._translateService=r,this._activatedRoute=a,this._fuseConfirmationService=s,this._calendarService=c,this.calendarListFarm=[],this.calendarListPond=[],this.beginDay="",this.pcode="",this.fcode="",this.pondsList=[],this.usersList=[],this.calendarListUser=[],this.ucode="",this.presentDay=l()().startOf("day").valueOf()/1e3,this.loadingFlag=new n.E,this.startDate=new Date,this.date=new o.NI(new Date),this.serializedDate=new o.NI((new Date).toISOString())}ngOnInit(){""==this.beginDay&&(this.beginDay=l()().startOf("day").valueOf()/1e3),this.getPondsList(),this.calendarListApi(),this.calendarSuggestList(),setTimeout(()=>{this.checkPonds()},1500),""==this.pcode&&(this.pcode=this.pondsList[0].code)}onTyping(e){this.beginDay=e.startOf("day").valueOf()/1e3,this.calendarListApi()}onChange(e){this.pcode=e.value,this.calendarListApi()}checkPonds(){""==this.pcode&&(this.pcode=this.pondsList[0].code),console.log(this.pcode),console.log(this.pondsList[0].code)}parameterFarm(){return this._activatedRoute.parent.snapshot.paramMap.get("code")}getPondsList(){this._farmService.loadPonds().pipe().subscribe(e=>{console.log(e.data),0==e.status?this._alertService.error(e.error):(this.pondsList=e.data,console.log("pondslist:",this.pondsList),this.calendarListPond.length>0&&(this.pcode=this.calendarListPond[0].pond_id))},e=>{this._alertService.error(this._translateService.translate("CONNECT_ERROR"))})}getUserList(){this._farmService.loadUsers().pipe().subscribe(e=>{0==e.status?this._alertService.error(e.error):(this.usersList=e.data,this.calendarListUser.length>0&&(this.ucode=this.calendarListUser[0].user_id))},e=>{this._alertService.error(this._translateService.translate("CONNECT_ERROR"))})}calendarListApi(){this.loadingFlag.setPending(!0),console.log(10),this._farmService.getCalendarList(this.beginDay,this.pcode).subscribe(e=>{0==e.status?this._alertService.error(e.error):(this.calendarListFarm=e.data.farm,this.calendarListPond=e.data.pond,console.log("hi calculentor"),this.calendarListPond.length>0&&(this.pcode=this.calendarListPond[0].pond_id)),this.loadingFlag.setResult(!0)},e=>{this._alertService.error(this._translateService.translate("CONNECT_ERROR")),this.loadingFlag.setResult(!1)})}calendarSuggestList(){this.loadingFlag.setPending(!0),this._farmService.calendarSuggestAPI().subscribe(e=>{0==e.status?this._alertService.error(e.error):this.calendarListSuggest=e.data,this.loadingFlag.setResult(!0)},e=>{this._alertService.error(this._translateService.translate("CONNECT_ERROR")),this.loadingFlag.setResult(!1)})}setDone(e){this._calendarService.changeState(e.id).subscribe(e=>{1==e.status?(this._alertService.success(e.message),console.log(e)):this._alertService.error(e.error)},()=>{this._alertService.error(this._translateService.translate("CONNECT_ERROR"))})}addCalendar(){this._matDialog.open(C,{width:"650px",data:{parameter:this.parameterFarm()}}).afterClosed().subscribe(e=>{e&&(this._alertService.success(this._translateService.translate("FARM.CALENDARS.ADD_SUCCESSFUL_CA")),this.calendarListApi())})}editCalendar(e){this._matDialog.open(M,{width:"650px",data:e}).afterClosed().subscribe(e=>{e&&(this._alertService.success(this._translateService.translate("FARM.CALENDARS.ADD_SUCCESSFUL_CA")),this.calendarListApi())})}addSuggest(e){e.parameter=this.parameterFarm(),this._matDialog.open(C,{width:"650px",data:e}).afterClosed().subscribe(e=>{e&&(this._alertService.success(this._translateService.translate("FARM.CALENDARS.ADD_SUCCESSFUL")),this.beginDay="",this.calendarListApi())})}presentDelete(e){this._fuseConfirmationService.open({title:this._translateService.translate("FARM.MANAGER.WARN"),message:this._translateService.translate("FARM.CALENDARS.DELETECALENDAR"),actions:{confirm:{label:this._translateService.translate("CONFIRM")},cancel:{label:this._translateService.translate("CANCEL")}}}).afterClosed().subscribe(t=>{t&&"confirmed"==t&&this.delete(e)})}delete(e){const t=e.id;this.presentDay<=this.beginDay?this._calendarService.deleteItem(t).pipe((0,c.P)()).subscribe(e=>{1===e.status?(this._alertService.success(e.message),this.calendarListApi()):(this._alertService.error(e.error),console.log(e),console.log(t))}):this._alertService.error(this._translateService.translate("FARM.CALENDARS.ADD_ERROR"))}}return e.\u0275fac=function(t){return new(t||e)(m.Y36(u.D),m.Y36(d.uw),m.Y36(f.c),m.Y36(p.Vn),m.Y36(a.gz),m.Y36(D.R),m.Y36(Q.o))},e.\u0275cmp=m.Xpm({type:e,selectors:[["app-farm-calendar"]],decls:1,vars:1,consts:[[4,"transloco","translocoRead"],[1,"w-full"],[1,"flex","flex-col","sm:flex-row","flex-0","sm:items-center","sm:justify-between"],[1,"flex","justify-items-start"],["appearance","fill",1,"flex-auto"],["matInput","",3,"matDatepicker","ngModel","ngModelChange"],["matSuffix","",3,"for"],["picker2",""],["appearance","fill",1,"flex-auto","w-40"],["required","",3,"ngModel","selectionChange","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[1,"justify-items-end"],["mat-raised-button","","color","primary",1,"mb-4","w-max",3,"click"],["color","warn",1,"icon-size-5","mt-0.5","mr-2",3,"svgIcon"],[1,"text-xl","font-semibold","pb-3","text-orange-500"],[1,"bg-card","shadow","rounded-2xl","overflow-hidden","w-full","mb-8"],[1,"grid"],[1,"grid-cols-8","z-10","sticky","top-0","grid","gap-4","py-4","px-8","shadow","text-md","font-semibold","bg-gray-50"],[1,"col-span-1"],[1,"col-span-2"],[3,"mode",4,"ngIf"],["class","max-h-80 overflow-y-auto",4,"ngIf"],[1,"grid-cols-9","z-10","sticky","top-0","grid","gap-4","py-4","px-8","shadow","text-md","font-semibold","bg-gray-50"],[3,"value"],[3,"mode"],[1,"max-h-80","overflow-y-auto"],["class","grid-cols-8 grid items-center gap-4 py-3 px-8 border-b",4,"ngFor","ngForOf"],[1,"grid-cols-8","grid","items-center","gap-4","py-3","px-8","border-b"],["color","primary",3,"checked","change"],["class","example-chip","cdkDropList","","cdkDropListOrientation","horizontal",3,"cdkDropListDropped",4,"ngIf"],["mat-icon-button","",3,"matMenuTriggerFor"],["svgIcon","heroicons_outline:dots-vertical"],["menu","matMenu"],["mat-menu-item","",3,"click"],["svgIcon","heroicons_outline:pencil-alt"],["svgIcon","heroicons_outline:trash",1,"text-red-500"],["cdkDropList","","cdkDropListOrientation","horizontal",1,"example-chip",3,"cdkDropListDropped"],["cdkDrag","","color","primary","selected","",1,"example-box","cursor-pointer"],[1,"text-white"],["class","grid-cols-9 grid items-center gap-4 py-3 px-8 border-b",4,"ngFor","ngForOf"],[1,"grid-cols-9","grid","items-center","gap-4","py-3","px-8","border-b"],["mat-icon-button","",3,"click"],["svgIcon","add_circle_outline"]],template:function(e,t){1&e&&m.YNc(0,ie,70,31,"ng-container",0),2&e&&m.Q6J("translocoRead","FARM.CALENDARS")},directives:[p.KI,Z.KE,v.Nt,_.hl,o.Fj,o.JJ,o.On,_.nW,Z.R9,_.Mq,x.gD,o.Q7,r.sg,g.lW,h.Hw,r.O5,A.ey,T.pW,L.oG,Y.p6,Y.VK,Y.OP,P.qn,P.HS],pipes:[r.uU],styles:["mat-form-field[_ngcontent-%COMP%]{margin-right:12px}"]}),e})();var ae=i(95352),oe=i(42120);let ne=(()=>{class e{constructor(e,t,i){this.reqAPISevice=e,this.dbLocalService=t,this.router=i,this.checkedItems=[{code:"",package:{},used:{}}],this._API="/manager/package-check",this.uprageLink=""}addChecked(e){this.checkedItems.push(e)}checkOnline(e,t){this.reqAPISevice.get(this._API+"?object="+t+"&code="+e).subscribe(t=>{t.status&&this.addChecked({code:e,package:t.data.current,used:t.data.used})})}check(e,t){-1==this.checkedItems.findIndex(t=>t.code==e)&&this.checkOnline(e,t)}localCheck(e,t){let i=this.checkedItems.find(t=>t.code==e);return console.log(i),null!=i.package?i.used[t]<i.package[t]:"farm_quantity"==t&&i.used[t]<1||"pond_quantity"==t&&i.used[t]<5}checkIsOwner(){return!!this.dbLocalService.company&&(this.uprageLink="/company/"+this.dbLocalService.company.code+"/setting",!0)}goToUpgrade(){console.log(this.uprageLink),this.router.navigate([this.uprageLink,{act:"package"}])}}return e.\u0275fac=function(t){return new(t||e)(m.LFG(ae.$),m.LFG(oe.T),m.LFG(a.F0))},e.\u0275prov=m.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var se=i(4885);function le(e,t){1&e&&m._UZ(0,"mat-progress-spinner",10),2&e&&m.Q6J("diameter",24)("mode","indeterminate")}function ce(e,t){if(1&e){const e=m.EpF();m.TgZ(0,"div",11),m.TgZ(1,"p"),m._uU(2),m.qZA(),m.TgZ(3,"button",12),m.NdJ("click",function(){return m.CHM(e),m.oxw(2).goToCreatePond()}),m.TgZ(4,"span",13),m._uU(5),m.qZA(),m._UZ(6,"mat-icon",14),m.qZA(),m.qZA()}if(2&e){const e=m.oxw().$implicit;m.xp6(2),m.Oqu(e("CREATE_POND")),m.xp6(1),m.Q6J("color","primary"),m.xp6(2),m.Oqu(e("GO_TO_CREATE_POND")),m.xp6(1),m.Q6J("svgIcon","heroicons_solid:chevron-right")}}function de(e,t){if(1&e&&(m.TgZ(0,"div",24),m._uU(1),m.qZA()),2&e){const e=m.oxw(3).$implicit;m.xp6(1),m.hij(" ",e("EMPTY"),"")}}function me(e,t){1&e&&(m.TgZ(0,"div",24),m._uU(1," --"),m.qZA())}function ue(e,t){if(1&e&&(m.TgZ(0,"div",24),m._uU(1),m.qZA()),2&e){const e=m.oxw().$implicit;m.xp6(1),m.Oqu(e.infor.species)}}function pe(e,t){if(1&e&&(m.TgZ(0,"div",24),m._uU(1),m.ALo(2,"number"),m.ALo(3,"number"),m.qZA()),2&e){const e=m.oxw().$implicit,t=m.oxw(2).$implicit,i=m.oxw();m.xp6(1),m.AsE("",m.xi3(2,2,(i.now-e.infor.start_time)/86400,"0.0-0")," ",m.xi3(3,5,(i.now-e.infor.start_time)/86400,"0.0-0").replace(",","")>1?t("DAYS"):t("DAY")," ")}}function fe(e,t){if(1&e&&(m.TgZ(0,"a",18),m.TgZ(1,"div",19),m._UZ(2,"mat-icon",20),m.TgZ(3,"div",21),m.TgZ(4,"div",22),m._uU(5),m.qZA(),m.YNc(6,de,2,1,"div",23),m.YNc(7,me,2,0,"div",23),m.YNc(8,ue,2,1,"div",23),m.YNc(9,pe,4,8,"div",23),m.qZA(),m.qZA(),m.qZA()),2&e){const e=t.$implicit;m.MGl("routerLink","/pond/",e.infor.code,""),m.xp6(2),m.Q6J("ngClass",0!=e.infor.current_season&&0==e.infor.warning?"text-blue-400":0!=e.infor.current_season&&1==e.infor.warning?"text-red-500":""),m.xp6(2),m.Q6J("ngClass",0!=e.infor.current_season&&0==e.infor.warning?"text-blue-400":0!=e.infor.current_season&&1==e.infor.warning?"text-red-500":""),m.xp6(1),m.hij(" ",e.infor.name,""),m.xp6(1),m.Q6J("ngIf",0==e.infor.current_season),m.xp6(1),m.Q6J("ngIf",0==e.infor.current_season),m.xp6(1),m.Q6J("ngIf",0!=e.infor.current_season),m.xp6(1),m.Q6J("ngIf",0!=e.infor.current_season)}}function ge(e,t){if(1&e&&(m.TgZ(0,"div",15),m.TgZ(1,"div",16),m.YNc(2,fe,10,8,"a",17),m.qZA(),m.qZA()),2&e){const e=m.oxw(2);m.xp6(2),m.Q6J("ngForOf",e.localDb.filterPond("farm_id",null==e.farmService.farm?null:e.farmService.farm.id))}}function he(e,t){if(1&e&&(m.ynx(0),m.TgZ(1,"div",1),m.TgZ(2,"div",2),m.TgZ(3,"div",3),m.TgZ(4,"div",4),m.TgZ(5,"div",5),m.TgZ(6,"div"),m.TgZ(7,"div",6),m._uU(8),m.qZA(),m.qZA(),m.qZA(),m.TgZ(9,"div"),m.YNc(10,le,1,2,"mat-progress-spinner",7),m.qZA(),m.YNc(11,ce,7,4,"div",8),m.YNc(12,ge,3,1,"div",9),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.BQk()),2&e){const e=t.$implicit,i=m.oxw();m.xp6(8),m.hij("",e("POND_LIST")," "),m.xp6(2),m.Q6J("ngIf",i.loadingFlag.pending),m.xp6(1),m.Q6J("ngIf",i.loadingFlag.result&&0==i.farmService.numberOfPonds),m.xp6(1),m.Q6J("ngIf",i.farmService.numberOfPonds>0)}}let Ze=(()=>{class e{constructor(e,t,i,r,a,o){this._alertService=e,this._translateService=t,this._packageService=i,this._router=r,this.farmService=a,this.localDb=o,this.loadingFlag=new n.E,this.now=(new Date).valueOf()/1e3}ngOnInit(){this.getPonds(),this._packageService.check(this.farmService.fcode,"farm")}getPonds(){this.loadingFlag.setPending(!0),this.farmService.loadPonds().pipe().subscribe(e=>{if(0==e.status)this._alertService.error(e.error);else{this.farmService.numberOfPonds=e.data.length,e.data.reverse();let t="";t=void 0!==e.permission?e.permission:this.farmService.permission,e.data.forEach(e=>{e.permission=t;let i=this.localDb.ponds.findIndex(t=>t.infor.code==e.code);i<0?this.localDb.ponds.push({infor:e,devices:[]}):this.localDb.ponds[i]={infor:e,devices:[]}}),this.localDb.setLocalData("ponds",this.localDb.ponds)}this.loadingFlag.setResult(!0)},e=>{this._alertService.error(this._translateService.translate("CONNECT_ERROR")),this.loadingFlag.setResult(!1)})}goToCreatePond(){this._router.navigateByUrl("farm/"+this.farmService.fcode+"/pond-create")}}return e.\u0275fac=function(t){return new(t||e)(m.Y36(f.c),m.Y36(p.Vn),m.Y36(ne),m.Y36(a.F0),m.Y36(u.D),m.Y36(oe.T))},e.\u0275cmp=m.Xpm({type:e,selectors:[["app-farm-dashboard"]],decls:1,vars:1,consts:[[4,"transloco","translocoRead"],[1,"flex","flex-col","flex-auto","min-w-0"],[1,"flex-auto"],[1,"flex","flex-col","flex-auto","w-full"],[1,"flex","flex-wrap","w-full","max-w-screen-xl"],[1,"flex","items-center","justify-between","w-full"],[1,"text-3xl","font-semibold","tracking-tight","leading-8"],[3,"diameter","mode",4,"ngIf"],["class","mt-3 p-6 bg-card shadow rounded-2xl overflow-hidden text-lg font-medium",4,"ngIf"],["class","grid grid-cols-1 w-full mt-8",4,"ngIf"],[3,"diameter","mode"],[1,"mt-3","p-6","bg-card","shadow","rounded-2xl","overflow-hidden","text-lg","font-medium"],["mat-raised-button","",1,"fuse-mat-button","mt-3",3,"color","click"],[1,"mr-2"],[1,"icon-size-5",3,"svgIcon"],[1,"grid","grid-cols-1","w-full","mt-8"],[1,"grid","grid-cols-1","sm:grid-cols-3","gap-6","w-full","min-w-0"],["class","p-6 bg-card shadow rounded-2xl overflow-hidden",3,"routerLink",4,"ngFor","ngForOf"],[1,"p-6","bg-card","shadow","rounded-2xl","overflow-hidden",3,"routerLink"],[1,"flex","items-center","max-w-80","w-full","p-6","filter-info"],["svgIcon","heroicons_solid:farmext-pond",1,"icon-size-12","mr-6",3,"ngClass"],[1,"py-4","px-0.5"],[1,"text-2xl","font-semibold","leading-tight","text-secondary",3,"ngClass"],["class","text-md text-secondary truncate",4,"ngIf"],[1,"text-md","text-secondary","truncate"]],template:function(e,t){1&e&&m.YNc(0,he,13,4,"ng-container",0),2&e&&m.Q6J("translocoRead","DASHBOARD")},directives:[p.KI,r.O5,se.Ou,g.lW,h.Hw,r.sg,a.yS,r.mk],pipes:[r.JJ],styles:[""]}),e})();var ve=i(82958),_e=i(92340),xe=i(28288),Ae=i(44342),Te=i(19602);const qe=["fuseCard"];function Se(e,t){if(1&e&&(m.TgZ(0,"div",6),m.TgZ(1,"div",7),m._UZ(2,"mat-icon",49),m.TgZ(3,"div",9),m.TgZ(4,"span",10),m._uU(5),m.qZA(),m.qZA(),m.qZA(),m.TgZ(6,"span",11),m._uU(7),m.qZA(),m.qZA()),2&e){const e=m.oxw().$implicit,t=m.oxw();m.xp6(5),m.Oqu(e("AREA")),m.xp6(2),m.hij("",null==t.farmService.farm?null:t.farmService.farm.area," (ha)")}}function be(e,t){if(1&e&&(m.TgZ(0,"div",6),m.TgZ(1,"div",7),m._UZ(2,"mat-icon",50),m.TgZ(3,"div",9),m.TgZ(4,"span",10),m._uU(5),m.qZA(),m.qZA(),m.qZA(),m.TgZ(6,"span",11),m._uU(7),m.qZA(),m.qZA()),2&e){const e=m.oxw().$implicit,t=m.oxw();m.xp6(5),m.Oqu(e("SPECIES")),m.xp6(2),m.Oqu(t.farmSpecies.name)}}function Ne(e,t){1&e&&m._UZ(0,"mat-icon",51)}function Fe(e,t){1&e&&m._UZ(0,"mat-icon",52)}function ye(e,t){if(1&e&&(m.TgZ(0,"span",11),m._uU(1),m.qZA()),2&e){const e=m.oxw().$implicit;m.xp6(1),m.Oqu(e("MANAGER"))}}function we(e,t){if(1&e&&(m.TgZ(0,"span",11),m._uU(1),m.qZA()),2&e){const e=m.oxw().$implicit;m.xp6(1),m.Oqu(e("FOLLOWERS"))}}function Ce(e,t){if(1&e&&(m.TgZ(0,"span",11),m._uU(1),m.qZA()),2&e){const e=m.oxw().$implicit;m.xp6(1),m.Oqu(e("PUBLIC"))}}function Ie(e,t){if(1&e&&(m.TgZ(0,"div",6),m.TgZ(1,"div",7),m._UZ(2,"mat-icon",53),m.TgZ(3,"div",9),m.TgZ(4,"span",10),m._uU(5),m.qZA(),m.qZA(),m.qZA(),m.TgZ(6,"span",11),m._uU(7),m.ALo(8,"number"),m.ALo(9,"number"),m.qZA(),m.qZA()),2&e){const e=m.oxw().$implicit,t=m.oxw();m.xp6(5),m.Oqu(e("LOCATION")),m.xp6(2),m.AsE("",m.xi3(8,3,null==t.farmService.farm?null:t.farmService.farm.longitude,"1.2-8")," : ",m.xi3(9,6,null==t.farmService.farm?null:t.farmService.farm.latitude,"1.2-8"),"")}}function Re(e,t){if(1&e&&(m.TgZ(0,"mat-option",54),m._uU(1),m.qZA()),2&e){const e=t.$implicit;m.Q6J("value",e.id),m.xp6(1),m.hij("",e.name," ")}}function Ee(e,t){if(1&e&&(m.TgZ(0,"mat-option",54),m._uU(1),m.qZA()),2&e){const e=t.$implicit;m.Q6J("value",e.id),m.xp6(1),m.hij("",e.name," ")}}function Oe(e,t){if(1&e&&(m.TgZ(0,"mat-option",54),m._uU(1),m.qZA()),2&e){const e=t.$implicit;m.Q6J("value",e.id),m.xp6(1),m.hij("",e.name," ")}}function Ue(e,t){if(1&e&&(m.TgZ(0,"mat-option",54),m._uU(1),m.qZA()),2&e){const e=t.$implicit;m.Q6J("value",e.id),m.xp6(1),m.hij("",e.name," ")}}function ke(e,t){1&e&&m._UZ(0,"mat-progress-bar",55)}function Je(e,t){if(1&e){const e=m.EpF();m.ynx(0),m.TgZ(1,"fuse-card",1,2),m.ynx(3,3),m.TgZ(4,"div",4),m.TgZ(5,"div",5),m._uU(6),m.qZA(),m.TgZ(7,"div",6),m.TgZ(8,"div",7),m._UZ(9,"mat-icon",8),m.TgZ(10,"div",9),m.TgZ(11,"span",10),m._uU(12),m.qZA(),m.qZA(),m.qZA(),m.TgZ(13,"span",11),m._uU(14),m.qZA(),m.qZA(),m.TgZ(15,"div",6),m.TgZ(16,"div",7),m._UZ(17,"mat-icon",12),m.TgZ(18,"div",9),m.TgZ(19,"span",10),m._uU(20),m.qZA(),m.qZA(),m.qZA(),m.TgZ(21,"span",11),m._uU(22),m.qZA(),m.qZA(),m.YNc(23,Se,8,2,"div",13),m.YNc(24,be,8,2,"div",13),m.TgZ(25,"div",6),m.TgZ(26,"div",7),m.YNc(27,Ne,1,0,"mat-icon",14),m.YNc(28,Fe,1,0,"mat-icon",15),m.TgZ(29,"div",9),m.TgZ(30,"span",10),m._uU(31),m.qZA(),m.qZA(),m.qZA(),m.YNc(32,ye,2,1,"span",16),m.YNc(33,we,2,1,"span",16),m.YNc(34,Ce,2,1,"span",16),m.qZA(),m.YNc(35,Ie,10,9,"div",13),m._UZ(36,"div",17),m.TgZ(37,"div",18),m.TgZ(38,"button",19),m.NdJ("click",function(){return m.CHM(e),m.MAs(2).face="back"}),m._UZ(39,"mat-icon",20),m._uU(40),m.qZA(),m.qZA(),m.qZA(),m.BQk(),m.ynx(41,21),m.TgZ(42,"div",22),m.TgZ(43,"div",23),m.TgZ(44,"button",24),m.NdJ("click",function(){return m.CHM(e),m.MAs(2).face="front"}),m._UZ(45,"mat-icon",20),m.qZA(),m.TgZ(46,"span",25),m._uU(47),m.qZA(),m.qZA(),m.TgZ(48,"div",26),m.TgZ(49,"div",27),m.TgZ(50,"div",28),m.TgZ(51,"div",29),m.TgZ(52,"mat-form-field",30),m._UZ(53,"input",31),m._UZ(54,"mat-icon",32),m.qZA(),m.qZA(),m.TgZ(55,"div",29),m.TgZ(56,"mat-form-field",33),m._UZ(57,"input",34),m._UZ(58,"mat-icon",35),m.qZA(),m.TgZ(59,"mat-form-field",30),m.TgZ(60,"mat-select",36),m.YNc(61,Re,2,2,"mat-option",37),m.qZA(),m._UZ(62,"mat-icon",38),m.qZA(),m.qZA(),m.TgZ(63,"div",29),m.TgZ(64,"mat-form-field",30),m._UZ(65,"input",39),m._UZ(66,"mat-icon",40),m.qZA(),m.qZA(),m.TgZ(67,"div",29),m.TgZ(68,"mat-form-field",33),m.TgZ(69,"mat-select",41),m.NdJ("selectionChange",function(t){return m.CHM(e),m.oxw().changeProvince(t)}),m.YNc(70,Ee,2,2,"mat-option",37),m.qZA(),m.qZA(),m.TgZ(71,"mat-form-field",33),m.TgZ(72,"mat-select",42),m.NdJ("selectionChange",function(t){return m.CHM(e),m.oxw().changeDistrict(t)}),m.YNc(73,Oe,2,2,"mat-option",37),m.qZA(),m.qZA(),m.TgZ(74,"mat-form-field",30),m.TgZ(75,"mat-select",43),m.YNc(76,Ue,2,2,"mat-option",37),m.qZA(),m.qZA(),m.qZA(),m.TgZ(77,"div",29),m.TgZ(78,"mat-form-field",33),m._UZ(79,"input",44),m.qZA(),m.TgZ(80,"mat-form-field",30),m._UZ(81,"input",45),m.qZA(),m.qZA(),m._UZ(82,"div",46),m.qZA(),m.qZA(),m.qZA(),m.TgZ(83,"div",18),m.TgZ(84,"button",47),m.NdJ("click",function(){return m.CHM(e),m.oxw().saveInfor()}),m.YNc(85,ke,1,0,"mat-progress-bar",48),m._UZ(86,"mat-icon",20),m._uU(87),m.qZA(),m.qZA(),m.qZA(),m.BQk(),m.qZA(),m.BQk()}if(2&e){const e=t.$implicit,i=m.oxw();m.xp6(1),m.Q6J("flippable",!0),m.xp6(5),m.Oqu(e("TITLE")),m.xp6(6),m.Oqu(e("FARM_NAME")),m.xp6(2),m.Oqu(null==i.farmService.farm?null:i.farmService.farm.name),m.xp6(6),m.Oqu(e("ADDRESS")),m.xp6(2),m.Oqu(null==i.farmService.farm?null:i.farmService.farm.address),m.xp6(1),m.Q6J("ngIf",null==i.farmService.farm?null:i.farmService.farm.area),m.xp6(1),m.Q6J("ngIf",i.farmSpecies),m.xp6(3),m.Q6J("ngIf",1==(null==i.farmService.farm?null:i.farmService.farm.public)),m.xp6(1),m.Q6J("ngIf",1!=(null==i.farmService.farm?null:i.farmService.farm.public)),m.xp6(3),m.Oqu(e("PRIVACY")),m.xp6(1),m.Q6J("ngIf",1==(null==i.farmService.farm?null:i.farmService.farm.public)),m.xp6(1),m.Q6J("ngIf",2==(null==i.farmService.farm?null:i.farmService.farm.public)),m.xp6(1),m.Q6J("ngIf",3==(null==i.farmService.farm?null:i.farmService.farm.public)),m.xp6(1),m.Q6J("ngIf",(null==i.farmService.farm?null:i.farmService.farm.longitude)&&(null==i.farmService.farm?null:i.farmService.farm.latitude)),m.xp6(3),m.Q6J("color","primary"),m.xp6(1),m.Q6J("svgIcon","heroicons_outline:pencil-alt"),m.xp6(1),m.hij(" ",e("UPDATE")," "),m.xp6(4),m.Q6J("color","primary"),m.xp6(1),m.Q6J("svgIcon","heroicons_outline:arrow-left"),m.xp6(2),m.Oqu(e("UPDATE_TITLE")),m.xp6(1),m.Q6J("formGroup",i.editFarm),m.xp6(5),m.Q6J("placeholder",e("FARM_NAME")),m.xp6(4),m.Q6J("placeholder",e("AREA")),m.xp6(3),m.Q6J("placeholder",e("SPECIES")),m.xp6(1),m.Q6J("ngForOf",i.species),m.xp6(4),m.Q6J("placeholder",e("ADDRESS")),m.xp6(1),m.Q6J("svgIcon","heroicons_solid:location-marker"),m.xp6(3),m.Q6J("placeholder",e("PROVINCE")),m.xp6(1),m.Q6J("ngForOf",i.listProvince),m.xp6(2),m.Q6J("placeholder",e("DISTRICT")),m.xp6(1),m.Q6J("ngForOf",i.listDistrict),m.xp6(2),m.Q6J("placeholder",e("WARD")),m.xp6(1),m.Q6J("ngForOf",i.listWards),m.xp6(3),m.Q6J("placeholder",e("LONGITUDE"))("readonly",!0),m.xp6(2),m.Q6J("placeholder",e("LATITUDE"))("readonly",!0),m.xp6(3),m.Q6J("disabled",i.editFarm.invalid)("color","primary"),m.xp6(1),m.Q6J("ngIf",i.savingFlag.pending),m.xp6(1),m.Q6J("svgIcon","heroicons_outline:check"),m.xp6(1),m.hij(" ",e("SAVE")," ")}}let Me=(()=>{class e{constructor(e,t,i,r,a,o,s,l){this._localDb=e,this._alertService=t,this._formBuilder=i,this._translateService=r,this._router=a,this._route=o,this.farmService=s,this.companyService=l,this.savingFlag=new n.E,this.species=[]}ngOnInit(){this.createForm(),this.getSpecies(),this.getListProvince(0),this.prepareAddressData(),this._indexFarm=this._localDb.farms.findIndex(e=>e.infor.code===this.farmService.fcode)}ngAfterViewInit(){let e=this.farmService.farm;e.longitude&&e.latitude&&this.loadMap()}createForm(){this.editFarm=this._formBuilder.group({name:[this.farmService.farm.name,o.kI.required],address:[this.farmService.farm.address,o.kI.required],area:[this.farmService.farm.area,o.kI.required],species_id:[this.farmService.farm.species_id,o.kI.required],longitude:this.farmService.farm.longitude||"",latitude:this.farmService.farm.latitude||"",province:this.farmService.farm.province_id||"",district:this.farmService.farm.district_id||"",wards:this.farmService.farm.wards_id||""})}getSpecies(){this.companyService.loadSpecies().subscribe(e=>{e.error||1!=e.status?this._alertService.error(e.error):(this.species=e.data,this.farmService.farm.species_id&&(this.farmSpecies=this.species.find(e=>e.id===this.farmService.farm.species_id)))},e=>{this._alertService.error(this._translateService.translate("CONNECT_ERROR"))})}changeProvince(e){let t=e.value;this.listDistrict=[],this.listWards=[],this.editFarm.value.district=0,this.editFarm.value.wards=0,this.getListDistrict(t)}changeDistrict(e){let t=e.value;this.listWards=[],this.editFarm.value.wards=0,this.getListWards(t)}getListProvince(e){this.companyService.listAddress(e).subscribe(e=>{1==e.status?this.listProvince=e.data:this._alertService.error(e.error)},()=>{this._alertService.error(this._translateService.translate("CONNECT_ERROR"))})}getListDistrict(e){this.companyService.listAddress(e).subscribe(e=>{1==e.status?this.listDistrict=e.data:this._alertService.error(e.error)},()=>{this._alertService.error(this._translateService.translate("CONNECT_ERROR"))})}getListWards(e){this.companyService.listAddress(e).subscribe(e=>{1==e.status?this.listWards=e.data:this._alertService.error(e.error)},()=>{this._alertService.error(this._translateService.translate("CONNECT_ERROR"))})}prepareAddressData(){let e=this.farmService.farm;e.province_id&&(this.getListDistrict(e.province_id),e.district_id&&this.getListWards(e.district_id))}loadMap(){ve.accessToken=_e.Jj.TOKEN,this.map_info=new ve.Map({container:"map-info",style:"mapbox://styles/mapbox/streets-v11",center:[this.editFarm.value.longitude,this.editFarm.value.latitude],zoom:5}),this._infoMarker=new ve.Marker({draggable:!1}).setLngLat([this.editFarm.value.longitude,this.editFarm.value.latitude]).addTo(this.map_info),this.mapa=new ve.Map({container:"map",style:"mapbox://styles/mapbox/streets-v11",center:[this.editFarm.value.longitude,this.editFarm.value.latitude],zoom:5}),this._marker=new ve.Marker({draggable:!1}).setLngLat([this.editFarm.value.longitude,this.editFarm.value.latitude]).addTo(this.mapa),this.mapa.on("click",e=>{this.editFarm.patchValue({latitude:e.lngLat.wrap().lat,longitude:e.lngLat.wrap().lng}),this._marker.setLngLat([e.lngLat.wrap().lng,e.lngLat.wrap().lat])});const e=new ve.GeolocateControl({positionOptions:{enableHighAccuracy:!1},trackUserLocation:!0});this.mapa.addControl(e),e.on("geolocate",e=>{this.editFarm.patchValue({latitude:e.coords.latitude,longitude:e.coords.longitude}),this._marker.setLngLat([e.coords.longitude,e.coords.latitude])})}saveInfor(){this.farmService.updateFarm(this.editFarm.value).pipe().subscribe(e=>{0==e.status?this._alertService.error(e.error):(this.farmService.farm.name=this.editFarm.value.name,this.farmService.farm.address=this.editFarm.value.address,this.farmService.farm.area=this.editFarm.value.area,this.farmService.farm.species_id=this.editFarm.value.species_id,this.farmService.farm.longitude=this.editFarm.value.longitude,this.farmService.farm.latitude=this.editFarm.value.latitude,this.farmService.farm.provice_id=this.editFarm.value.province,this.farmService.farm.district_id=this.editFarm.value.district,this.farmService.farm.wards_id=this.editFarm.value.wards,this.farmSpecies=this.species.find(e=>e.id===this.farmService.farm.species_id),this.map_info.flyTo({center:[this.editFarm.value.longitude,this.editFarm.value.latitude]}),this._infoMarker.setLngLat([this.editFarm.value.longitude,this.editFarm.value.latitude]),this._alertService.success(this._translateService.translate("UPDATE_SUCCESS")),this.fuseCard.face="front",-1!=this._indexFarm&&(this._localDb.farms[this._indexFarm].infor=this.farmService.farm,this._localDb.setLocalData("farms",this._localDb.farms)),this._localDb.currentFarm=this.farmService.farm,this._localDb.setLocalData("currentFarm",this._localDb.currentFarm))},e=>{this._alertService.error(this._translateService.translate("CONNECT_ERROR"))})}}return e.\u0275fac=function(t){return new(t||e)(m.Y36(oe.T),m.Y36(f.c),m.Y36(o.qu),m.Y36(p.Vn),m.Y36(a.F0),m.Y36(a.gz),m.Y36(u.D),m.Y36(Ae.J))},e.\u0275cmp=m.Xpm({type:e,selectors:[["app-farm-info"]],viewQuery:function(e,t){if(1&e&&m.Gf(qe,5),2&e){let e;m.iGM(e=m.CRH())&&(t.fuseCard=e.first)}},decls:1,vars:1,consts:[[4,"transloco","translocoRead"],[1,"flex","flex-col","w-full",3,"flippable"],["fuseCard",""],["fuseCardFront",""],[1,"flex","flex-col","px-8","py-6","pb-3"],[1,"text-lg","font-bold"],[1,"p-4","flex","justify-between","fuse-vertical-navigation-item-wrapper"],[1,"flex","justify-start","fuse-vertical-navigation-item-wrapper"],["svgIcon","heroicons_solid:farmext-farm",1,"mr-1"],[1,"text-base","fuse-vertical-navigation-item-wrapper"],[2,"vertical-align","sub"],[1,"text-base"],["svgIcon","iconsmind:map2",1,"mr-1"],["class","p-4 flex justify-between fuse-vertical-navigation-item-wrapper",4,"ngIf"],["class","mr-1","svgIcon","heroicons_outline:lock-closed",4,"ngIf"],["class","mr-1","svgIcon","heroicons_outline:eye",4,"ngIf"],["class","text-base",4,"ngIf"],["id","map-info",1,"mapbox","mb-4"],[1,"mt-3","-mx-3","self-end"],["mat-button","",3,"color","click"],[1,"icon-size-5",3,"svgIcon"],["fuseCardBack",""],[1,"flex","flex-col","flex-auto","px-8","py-6","pt-3"],[1,"mb-2","-mx-3"],["mat-icon-button","",3,"color","click"],[1,"text-lg","font-medium"],[1,"flex","flex-col","px-8",3,"formGroup"],[1,"w-full"],[1,"flex","flex-col","px-8","pt-5","bg-card","shadow","rounded","overflow-hidden","w-full"],[1,"flex"],[1,"flex-auto"],["matInput","","formControlName","name",3,"placeholder"],["matPrefix","","svgIcon","heroicons_solid:farmext-farm",1,"icon-size-5"],[1,"flex-auto","mr-1"],["matInput","","formControlName","area",3,"placeholder"],["matPrefix","","svgIcon","mat_solid:crop",1,"icon-size-5"],["formControlName","species_id",3,"placeholder"],[3,"value",4,"ngFor","ngForOf"],["matPrefix","","svgIcon","iconsmind:fish",1,"icon-size-5"],["matInput","","formControlName","address",3,"placeholder"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["formControlName","province",3,"placeholder","selectionChange"],["formControlName","district",3,"placeholder","selectionChange"],["formControlName","wards",3,"placeholder"],["matInput","","formControlName","longitude",3,"placeholder","readonly"],["matInput","","formControlName","latitude",3,"placeholder","readonly"],["id","map",1,"mapbox","mb-4"],["mat-raised-button","",3,"disabled","color","click"],["mode","indeterminate",4,"ngIf"],["svgIcon","mat_solid:crop",1,"mr-1"],["svgIcon","iconsmind:fish",1,"mr-1"],["svgIcon","heroicons_outline:lock-closed",1,"mr-1"],["svgIcon","heroicons_outline:eye",1,"mr-1"],["svgIcon","mat_solid:location_on",1,"mr-1"],[3,"value"],["mode","indeterminate"]],template:function(e,t){1&e&&m.YNc(0,Je,88,43,"ng-container",0),2&e&&m.Q6J("translocoRead","FARM.INFO")},directives:[p.KI,Te.y,h.Hw,r.O5,g.lW,o.JL,o.sg,Z.KE,v.Nt,o.Fj,o.JJ,o.u,Z.qo,x.gD,r.sg,A.ey,T.pW],pipes:[r.JJ],styles:[".mapbox[_ngcontent-%COMP%]{width:100%;height:250px}"],data:{animation:xe.L}}),e})();var De=i(49457),Qe=i.n(De),Le=i(93104),Ye=i(32091);function Pe(e,t){1&e&&(m.TgZ(0,"div"),m._UZ(1,"mat-progress-spinner",3),m.qZA()),2&e&&(m.xp6(1),m.Q6J("diameter",24)("mode","indeterminate"))}function je(e,t){1&e&&m._UZ(0,"mat-progress-spinner",3),2&e&&m.Q6J("diameter",24)("mode","indeterminate")}function He(e,t){1&e&&m._UZ(0,"mat-icon",46),2&e&&m.Q6J("svgIcon","heroicons_outline:cloud-download")}function $e(e,t){if(1&e){const e=m.EpF();m.TgZ(0,"button",47),m.NdJ("click",function(){const t=m.CHM(e).index;return m.oxw(3).selectShowPonds(t)}),m._uU(1),m.qZA()}if(2&e){const e=t.$implicit,i=m.oxw(3);m.Q6J("color",e.mod==i.modPondSeleted.mod?"warn":""),m.xp6(1),m.Oqu(e.label)}}function Ge(e,t){if(1&e&&(m.TgZ(0,"th",48),m._uU(1),m.qZA()),2&e){const e=m.oxw(2).$implicit;m.xp6(1),m.hij(" ",e("NAME")," ")}}function Be(e,t){if(1&e&&(m.TgZ(0,"td",49),m._uU(1),m.qZA()),2&e){const e=t.$implicit;m.xp6(1),m.hij(" ",e.name," ")}}function We(e,t){if(1&e&&(m.TgZ(0,"th",48),m._uU(1),m.qZA()),2&e){const e=m.oxw(2).$implicit;m.xp6(1),m.hij(" ",e("FOOD")," ")}}function Ve(e,t){if(1&e&&(m.TgZ(0,"td",49),m._uU(1),m.ALo(2,"number"),m.qZA()),2&e){const e=t.$implicit;m.xp6(1),m.hij(" ",m.xi3(2,1,e.total_feed,"0.0-1")," ")}}function Ke(e,t){if(1&e&&(m.TgZ(0,"th",48),m._uU(1),m.qZA()),2&e){const e=m.oxw(2).$implicit;m.xp6(1),m.hij(" ",e("COST")," ")}}function ze(e,t){if(1&e&&(m.TgZ(0,"td",49),m._uU(1),m.ALo(2,"number"),m.qZA()),2&e){const e=t.$implicit;m.xp6(1),m.hij(" ",m.xi3(2,1,e.total_cost,"0.0-1")," ")}}function Xe(e,t){1&e&&(m.TgZ(0,"th",48),m._uU(1," Size "),m.qZA())}function et(e,t){if(1&e&&(m.TgZ(0,"td",49),m._uU(1),m.qZA()),2&e){const e=t.$implicit;m.xp6(1),m.hij(" ",e.weight," ")}}function tt(e,t){if(1&e&&(m.TgZ(0,"th",48),m._uU(1),m.qZA()),2&e){const e=m.oxw(2).$implicit;m.xp6(1),m.hij(" ",e("PROBLEM")," ")}}function it(e,t){if(1&e&&(m.TgZ(0,"td",49),m._UZ(1,"span",50),m.qZA()),2&e){const e=t.$implicit;m.xp6(1),m.Q6J("innerHTML",e.note?e.note:"",m.oJD)}}function rt(e,t){1&e&&m._UZ(0,"tr",51)}function at(e,t){1&e&&m._UZ(0,"tr",52)}function ot(e,t){if(1&e){const e=m.EpF();m.TgZ(0,"button",47),m.NdJ("click",function(){const t=m.CHM(e).index;return m.oxw(3).selectShowStore(t)}),m._uU(1),m.qZA()}if(2&e){const e=t.$implicit,i=m.oxw(3);m.Q6J("color",e.mod==i.modStoreSeleted.mod?"warn":""),m.xp6(1),m.Oqu(e.label)}}function nt(e,t){if(1&e&&(m.TgZ(0,"th",48),m._uU(1),m.qZA()),2&e){const e=m.oxw(2).$implicit;m.xp6(1),m.hij(" ",e("PRODUCT")," ")}}function st(e,t){if(1&e&&(m.TgZ(0,"td",49),m._uU(1),m.qZA()),2&e){const e=t.$implicit;m.xp6(1),m.hij(" ",e.product_name," ")}}function lt(e,t){if(1&e&&(m.TgZ(0,"th",48),m._uU(1),m.qZA()),2&e){const e=m.oxw(2).$implicit;m.xp6(1),m.hij(" ",e("MANU")," ")}}function ct(e,t){if(1&e&&(m.TgZ(0,"td",49),m._uU(1),m.qZA()),2&e){const e=t.$implicit;m.xp6(1),m.hij(" ",e.manufacturer_name," ")}}function dt(e,t){if(1&e&&(m.TgZ(0,"th",48),m._uU(1),m.qZA()),2&e){const e=m.oxw(2).$implicit;m.xp6(1),m.hij(" ",e("PRICE")," ")}}function mt(e,t){if(1&e&&(m.TgZ(0,"td",49),m._uU(1),m.ALo(2,"number"),m.qZA()),2&e){const e=t.$implicit;m.xp6(1),m.hij(" ",m.xi3(2,1,e.price,"0.0-1")," ")}}function ut(e,t){if(1&e&&(m.TgZ(0,"th",48),m._uU(1),m.qZA()),2&e){const e=m.oxw(2).$implicit;m.xp6(1),m.hij(" ",e("WAREHOUSE")," ")}}function pt(e,t){if(1&e&&(m.TgZ(0,"td",49),m._uU(1),m.qZA()),2&e){const e=t.$implicit;m.xp6(1),m.hij(" ",e.quantity_current," ")}}function ft(e,t){1&e&&m._UZ(0,"tr",51)}function gt(e,t){1&e&&m._UZ(0,"tr",52)}function ht(e,t){if(1&e){const e=m.EpF();m.TgZ(0,"div",4),m.TgZ(1,"div",5),m.TgZ(2,"div",6),m.TgZ(3,"button",7),m.NdJ("click",function(){return m.CHM(e),m.oxw(2).dowloadFileSeasons()}),m.TgZ(4,"span",8),m._uU(5),m.qZA(),m.YNc(6,je,1,2,"mat-progress-spinner",9),m.YNc(7,He,1,1,"mat-icon",10),m.qZA(),m.qZA(),m.qZA(),m.TgZ(8,"div",5),m.TgZ(9,"p",11),m._uU(10),m.qZA(),m.qZA(),m.TgZ(11,"div",12),m.TgZ(12,"div",13),m.TgZ(13,"div",14),m.TgZ(14,"p",15),m._uU(15),m.qZA(),m._UZ(16,"div",16),m.qZA(),m.qZA(),m.TgZ(17,"div",17),m.TgZ(18,"div",14),m.TgZ(19,"p",18),m._uU(20),m.qZA(),m.TgZ(21,"div",19),m.TgZ(22,"h1",20),m._uU(23),m.qZA(),m.TgZ(24,"p",21),m._uU(25,"kg"),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.TgZ(26,"div",17),m.TgZ(27,"div",14),m.TgZ(28,"p",18),m._uU(29),m.qZA(),m.TgZ(30,"div",19),m.TgZ(31,"h1",20),m._uU(32),m.ALo(33,"number"),m.qZA(),m.TgZ(34,"p",21),m._uU(35,"kg"),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.TgZ(36,"div",22),m.TgZ(37,"div",17),m.TgZ(38,"div",23),m.TgZ(39,"p",18),m._uU(40),m.qZA(),m._UZ(41,"div",24),m.TgZ(42,"p",25),m._uU(43),m.qZA(),m.qZA(),m.qZA(),m.TgZ(44,"div",17),m.TgZ(45,"div",23),m.TgZ(46,"div",26),m.TgZ(47,"p",15),m._uU(48),m.qZA(),m.YNc(49,$e,2,2,"button",27),m.qZA(),m.TgZ(50,"table",28),m.ynx(51,29),m.YNc(52,Ge,2,1,"th",30),m.YNc(53,Be,2,1,"td",31),m.BQk(),m.ynx(54,32),m.YNc(55,We,2,1,"th",30),m.YNc(56,Ve,3,4,"td",31),m.BQk(),m.ynx(57,33),m.YNc(58,Ke,2,1,"th",30),m.YNc(59,ze,3,4,"td",31),m.BQk(),m.ynx(60,34),m.YNc(61,Xe,2,0,"th",30),m.YNc(62,et,2,1,"td",31),m.BQk(),m.ynx(63,35),m.YNc(64,tt,2,1,"th",30),m.YNc(65,it,2,1,"td",31),m.BQk(),m.YNc(66,rt,1,0,"tr",36),m.YNc(67,at,1,0,"tr",37),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.TgZ(68,"div",5),m.TgZ(69,"p",11),m._uU(70),m.qZA(),m.qZA(),m.TgZ(71,"div",38),m.TgZ(72,"div",39),m.TgZ(73,"div",23),m.TgZ(74,"p",18),m._uU(75),m.qZA(),m._UZ(76,"div",16),m.qZA(),m.qZA(),m.TgZ(77,"div",17),m.TgZ(78,"div",40),m.TgZ(79,"p",18),m._uU(80),m.qZA(),m.TgZ(81,"div",19),m.TgZ(82,"h1",20),m._uU(83),m.ALo(84,"number"),m.qZA(),m.TgZ(85,"p",21),m._uU(86,"\u0111\u1ed3ng"),m.qZA(),m.qZA(),m.qZA(),m.TgZ(87,"div",41),m.TgZ(88,"p",18),m._uU(89),m.qZA(),m.TgZ(90,"div",19),m.TgZ(91,"h1",20),m._uU(92),m.ALo(93,"number"),m.qZA(),m.TgZ(94,"p",21),m._uU(95,"\u0111\u1ed3ng"),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.TgZ(96,"div",38),m.TgZ(97,"div",39),m.TgZ(98,"div",23),m.TgZ(99,"div",26),m.TgZ(100,"p",15),m._uU(101),m.qZA(),m.YNc(102,ot,2,2,"button",27),m.qZA(),m.TgZ(103,"table",28),m.ynx(104,42),m.YNc(105,nt,2,1,"th",30),m.YNc(106,st,2,1,"td",31),m.BQk(),m.ynx(107,43),m.YNc(108,lt,2,1,"th",30),m.YNc(109,ct,2,1,"td",31),m.BQk(),m.ynx(110,44),m.YNc(111,dt,2,1,"th",30),m.YNc(112,mt,3,4,"td",31),m.BQk(),m.ynx(113,45),m.YNc(114,ut,2,1,"th",30),m.YNc(115,pt,2,1,"td",31),m.BQk(),m.YNc(116,ft,1,0,"tr",36),m.YNc(117,gt,1,0,"tr",37),m.qZA(),m.qZA(),m.qZA(),m.TgZ(118,"div",17),m.TgZ(119,"div",40),m.TgZ(120,"p",18),m._uU(121),m.qZA(),m.TgZ(122,"div",19),m.TgZ(123,"h1",20),m._uU(124),m.ALo(125,"number"),m.qZA(),m.TgZ(126,"p",21),m._uU(127),m.qZA(),m.qZA(),m.qZA(),m.TgZ(128,"div",41),m.TgZ(129,"p",18),m._uU(130),m.qZA(),m.TgZ(131,"div",19),m.TgZ(132,"h1",20),m._uU(133),m.qZA(),m.TgZ(134,"p",21),m._uU(135),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.qZA()}if(2&e){const e=m.oxw().$implicit,t=m.oxw();m.xp6(3),m.Q6J("color","primary")("disabled",t.loadingDownload.pending),m.xp6(2),m.Oqu(e("EXPORT_SEASONS")),m.xp6(1),m.Q6J("ngIf",t.loadingDownload.pending),m.xp6(1),m.Q6J("ngIf",!t.loadingDownload.pending),m.xp6(3),m.Oqu(e("REPORT_TECH")),m.xp6(5),m.Oqu(e("PRODUCTION_RATE")),m.xp6(1),m.Q6J("options",t.optionsTech),m.xp6(4),m.Oqu(e("TOTAL_FEED")),m.xp6(3),m.Oqu(t.dataReport.tech.feed),m.xp6(6),m.Oqu(e("TOTAL_QUANTITY")),m.xp6(3),m.hij(" ",m.xi3(33,38,t.dataReport.tech.total_harvest,"0.0-1"),""),m.xp6(8),m.Oqu(e("CHART_TITLE")),m.xp6(1),m.Q6J("options",t.options),m.xp6(2),m.Oqu(e("NOTE")),m.xp6(5),m.hij("",e("REPORT_POND")," "),m.xp6(1),m.Q6J("ngForOf",t.arrPondMod),m.xp6(1),m.Q6J("dataSource",t.modPondSeleted.list),m.xp6(16),m.Q6J("matHeaderRowDef",t.displayedColumns),m.xp6(1),m.Q6J("matRowDefColumns",t.displayedColumns),m.xp6(3),m.Oqu(e("REPORT_FINANCE")),m.xp6(5),m.Oqu(e("ANALYST_MONTH")),m.xp6(1),m.Q6J("options",t.optionsFinance),m.xp6(4),m.Oqu(e("TOTAL_IN")),m.xp6(3),m.hij("",m.xi3(84,41,t.totalIn,"0.0-1"),"tr"),m.xp6(6),m.Oqu(e("TOTAL_OUT")),m.xp6(3),m.hij("",m.xi3(93,44,t.totalOut,"0.0-1"),"tr "),m.xp6(9),m.Oqu(e("STORE")),m.xp6(1),m.Q6J("ngForOf",t.arrStoreMod),m.xp6(1),m.Q6J("dataSource",t.modStoreSeleted.list),m.xp6(13),m.Q6J("matHeaderRowDef",t.displayedColumnStore),m.xp6(1),m.Q6J("matRowDefColumns",t.displayedColumnStore),m.xp6(4),m.Oqu(e("TOTAL_WAREHOUSE")),m.xp6(3),m.hij("",m.xi3(125,47,t.dataReport.finance.total_warehouse,"0.0-1"),"tr"),m.xp6(3),m.Oqu(e("MONEY")),m.xp6(3),m.Oqu(e("NUM_PRODUCT")),m.xp6(3),m.hij("",t.dataReport.finance.total_product," "),m.xp6(2),m.Oqu(e("PRODUCT"))}}function Zt(e,t){if(1&e&&(m.ynx(0),m.YNc(1,Pe,2,2,"div",1),m.YNc(2,ht,136,50,"div",2),m.BQk()),2&e){const e=m.oxw();m.xp6(1),m.Q6J("ngIf",e.loadingFlag.pending),m.xp6(1),m.Q6J("ngIf",e.dataReport)}}let vt=(()=>{class e{constructor(e,t,i,r){this.farmService=e,this.translateService=t,this._alertService=i,this._translateService=r,this.loadingFlag=new n.E,this.loadingDownload=new n.E,this.options={},this.arrPondMod=[{mod:"pond_coming",label:this._translateService.translate("FARM.REPORT.POND_COMING")},{mod:"pond_new",label:this._translateService.translate("FARM.REPORT.POND_NEW")},{mod:"pond_warning",label:this._translateService.translate("FARM.REPORT.POND_WARNING")}],this.arrStoreMod=[{mod:"store_come_empty",label:this._translateService.translate("FARM.REPORT.STORE_COME_EMPTY")},{mod:"store_new",label:this._translateService.translate("FARM.REPORT.STORE_NEW")}],this.optionsTech={},this.optionsFinance={},this.displayedColumns=["name","feed","cost","size","warning"],this.displayedColumnStore=["product_name","manufacturer_name","price","quantity_current"],this.totalIn=0,this.totalOut=0}ngOnInit(){this.data=this.farmService.estimate,this.initOptions(),this.loadReport(),this.lang=this._translateService.getActiveLang()}initOptions(){if(!this.data)return;let e=(new Date).getMonth()+1,t=[],i=["Species"],r=[],a=[];[{key:"recent",detail:this.translateService.translate("FARM.REPORT.MONTH_AGO")},{key:"current",detail:"T"+e.toString()}].forEach(e=>{let o=[e.detail];for(let t in this.data.char_seed[e.key])a.length<Object.keys(this.data.char_seed[e.key]).length&&a.push({type:"bar"}),i.length<Object.keys(this.data.char_seed[e.key]).length+1&&(i.push(this.data.char_seed[e.key][t].name),r.push(this.data.char_seed[e.key][t].id)),o.push((parseInt(this.data.char_seed[e.key][t].quantity)/1e3).toString());t.push(o)}),t.unshift(i),console.log(t);let o=(new Date).getTime()/1e3;for(let n=1;n<=3;n++){let a=new Array(i.length-1).fill("0");this.data.list_season_doing.forEach(e=>{let t=(o-e.seed_date)/86400,i=r.indexOf(e.procedure?e.procedure.species_id:e.species_id);-1!=i&&(a[i]=this.processEstimateSpecies(30*n,t,e).toString())}),a.unshift("T"+(e+n).toString()),t.push(a)}this.options={legend:{},tooltip:{trigger:"item"},dataset:{source:t},xAxis:{type:"category"},yAxis:{show:!1},series:a}}processEstimateSpecies(e,t,i){let r=0,a=parseFloat(i.seed_weight),o=0;i.weight.length>0&&(a=null!=i.weight[0].weight?parseFloat(i.weight[0].weight):parseFloat(i.seed_weight),a!=i.seed_weight&&(r=s().diff(s(i.weight[0].date),"days"))),o=i.procedure?i.procedure.grow_speed:a/t,a+=r*o;let n=t+e;i.sum.loss||(i.sum.loss=0);let l=parseInt(i.seed_quantity)-parseInt(i.sum.loss);if(i.procedure&&i.procedure.culture_day>0&&i.procedure.survival_ratio>0){if(n<i.procedure.culture_day||t>i.procedure.culture_day)return 0;l=t*i.seed_quantity*i.procedure.survival_ratio/i.procedure.culture_day}return(l*(o*e+a)/1e3).toFixed(2)}loadReport(){this.loadingFlag.setPending(!0),this.farmService.loadReport().pipe().subscribe(e=>{0==e.status?this._alertService.error(e.error):(console.log(e.data),this.dataReport=e.data,this.prepareChartTech(e.data.tech.analyst_pond),this.prepareChartCost(e.data.finance),this.selectShowPonds(0),this.selectShowStore(0)),this.loadingFlag.setResult(!0)},e=>{this._alertService.error(this._translateService.translate("CONNECT_ERROR")),this.loadingFlag.setResult(!1)})}prepareChartTech(e){let t={tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},legend:{orient:"vertical",bottom:"bottom"},series:[{name:this._translateService.translate("FARM.REPORT.INFOR"),type:"pie",radius:"55%",data:[{value:e.warning,name:this._translateService.translate("BAD_POND")},{value:e.empty,name:this._translateService.translate("EMPTY_POND")},{value:e.good,name:this._translateService.translate("GOOD_POND")}],label:{show:!1,position:"center"},labelLine:{show:!1}}]};this.optionsTech=t}prepareChartCost(e){let t={tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},yAxis:{type:"value",boundaryGap:[0,.01]},xAxis:{type:"category",data:[]},series:[{name:this._translateService.translate("FARM.REPORT.TOTAL_IN"),type:"bar",data:[]},{name:this._translateService.translate("FARM.REPORT.TOTAL_OUT"),type:"bar",data:[]}]},i={};this.totalIn=0,this.totalOut=0,e.chart_in.forEach(e=>{i[e.time]={in:0,out:0}}),e.chart_out.forEach(e=>{i[e.time]={in:0,out:0}}),e.chart_in.forEach(e=>{i[e.time].in=(e.total/1e6).toFixed(0),this.totalIn+=parseInt(e.total)}),e.chart_out.forEach(e=>{i[e.time].out=(e.total/1e6).toFixed(0),this.totalOut+=parseInt(e.total)});for(let r in i)t.xAxis.data.push(r),t.series[0].data.push(i[r].in),t.series[1].data.push(i[r].out);this.totalIn=parseInt((this.totalIn/1e6).toFixed(0)),this.totalOut=parseInt((this.totalOut/1e6).toFixed(0)),this.dataReport.finance.total_warehouse=parseInt((this.dataReport.finance.total_warehouse/1e6).toFixed(0)),this.optionsFinance=t}selectShowPonds(e){this.modPondSeleted={mod:this.arrPondMod[e].mod,list:this.dataReport.tech[this.arrPondMod[e].mod]}}selectShowStore(e){this.modStoreSeleted={mod:this.arrStoreMod[e].mod,list:this.dataReport.finance[this.arrStoreMod[e].mod]}}dowloadFileSeasons(){this.loadingDownload.setPending(!0),this.farmService.dowloadFileSeasonReport().subscribe(e=>{const t=new Blob([e],{type:"text/csv"});let i="Farmext-FarmingSeason-"+this.farmService.fcode+".xlsx";Qe()(t,i),this.loadingDownload.setResult(!0)},e=>{this._alertService.error(this._translateService.translate("CONNECT_ERROR")),this.loadingDownload.setResult(!1)})}}return e.\u0275fac=function(t){return new(t||e)(m.Y36(u.D),m.Y36(p.Vn),m.Y36(f.c),m.Y36(p.Vn))},e.\u0275cmp=m.Xpm({type:e,selectors:[["app-farm-report"]],decls:1,vars:1,consts:[[4,"transloco","translocoRead"],[4,"ngIf"],["class","w-full",4,"ngIf"],[3,"diameter","mode"],[1,"w-full"],[1,"grid","grid-cols-1"],[1,"text-right"],["mat-flat-button","",1,"fuse-mat-button",3,"color","disabled","click"],[1,"mr-2"],[3,"diameter","mode",4,"ngIf"],[3,"svgIcon",4,"ngIf"],[1,"text-xl","font-medium","text-gray-400","py-4"],[1,"grid","grid-cols-1","sm:grid-cols-3"],[1,"md:p-2","sm:p-0","boxCardSmall"],[1,"flex","flex-col","px-8","py-6","mb-3","bg-card","shadow","rounded-2xl","overflow-hidden","w-full","h-100"],[1,"text-lg","font-medium"],["echarts","",1,"demoChart",3,"options"],[1,"md:p-2","sm:p-0","boxCardSmal"],[1,"text-lg","font-medium","mb-6"],[1,"flex","flex-col","justify-center","content-center","h-100"],[1,"text-center","text-7xl","font-medium","text-gray-400"],[1,"text-center"],[1,"grid","grid-cols-1","sm:grid-cols-2"],[1,"flex","flex-col","px-8","py-6","mb-3","bg-card","shadow","rounded-2xl","overflow-hidden","w-full","h-full"],["echarts","",3,"options"],[1,"font-medium","mt-3","text-center","text-xs"],[1,"w-full","flex","justify-between","items-center"],["mat-button","",3,"color","click",4,"ngFor","ngForOf"],["mat-table","",1,"mt-3",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","feed"],["matColumnDef","cost"],["matColumnDef","size"],["matColumnDef","warning"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[1,"grid","grid-cols-1","sm:grid-cols-3","pt-3"],[1,"md:p-2","sm:p-0","boxCardSmal","col-span-2","h-full"],[1,"flex","flex-col","px-8","py-6","mb-3","bg-card","shadow","rounded-2xl","overflow-hidden","h-50","w-full"],[1,"flex","flex-col","px-8","py-6","bg-card","shadow","rounded-2xl","overflow-hidden","h-50","w-full"],["matColumnDef","product_name"],["matColumnDef","manufacturer_name"],["matColumnDef","price"],["matColumnDef","quantity_current"],[3,"svgIcon"],["mat-button","",3,"color","click"],["mat-header-cell",""],["mat-cell",""],["color","text-red-500",3,"innerHTML"],["mat-header-row",""],["mat-row",""]],template:function(e,t){1&e&&m.YNc(0,Zt,3,2,"ng-container",0),2&e&&m.Q6J("translocoRead","FARM.REPORT")},directives:[p.KI,r.O5,se.Ou,g.lW,Le.w,r.sg,Ye.BZ,Ye.w1,Ye.fO,Ye.Dz,Ye.as,Ye.nj,h.Hw,Ye.ge,Ye.ev,Ye.XQ,Ye.Gk],pipes:[r.JJ],styles:[".demoChart[_ngcontent-%COMP%]{max-height:250px}.boxCardSmal[_ngcontent-%COMP%]{height:90%;padding-top:15px}"]}),e})();var _t=i(79765),xt=i(46782),At=i(89822),Tt=i(21611),qt=i(54395),St=i(82613);function bt(e,t){if(1&e&&(m.TgZ(0,"mat-radio-button",14),m._uU(1),m.qZA()),2&e){const e=t.$implicit;m.Q6J("value",e.value),m.xp6(1),m.hij(" ",e.label," ")}}function Nt(e,t){if(1&e){const e=m.EpF();m.ynx(0),m.TgZ(1,"div",1),m.TgZ(2,"div",2),m.TgZ(3,"div",3),m._UZ(4,"span",4),m.qZA(),m.TgZ(5,"button",5),m._UZ(6,"mat-icon",6),m.qZA(),m.qZA(),m.TgZ(7,"div",7),m.TgZ(8,"label"),m._uU(9),m.TgZ(10,"span",8),m._uU(11),m.qZA(),m.qZA(),m.TgZ(12,"mat-radio-group",9),m.NdJ("ngModelChange",function(t){return m.CHM(e),m.oxw().farmRole=t})("ngModelChange",function(t){return m.CHM(e),m.oxw().valueChange(t)}),m.YNc(13,bt,2,2,"mat-radio-button",10),m.qZA(),m.qZA(),m.TgZ(14,"div",11),m.TgZ(15,"button",12),m.NdJ("click",function(){return m.CHM(e),m.oxw().sendForm()}),m._uU(16),m.qZA(),m.TgZ(17,"button",13),m.NdJ("click",function(){return m.CHM(e),m.oxw().onCancel()}),m._uU(18),m.qZA(),m.qZA(),m.qZA(),m.BQk()}if(2&e){const e=t.$implicit,i=m.oxw();m.xp6(4),m.Q6J("innerHTML",e("CONFIRM_ADD"),m.oJD),m.xp6(1),m.Q6J("tabIndex",-1),m.xp6(1),m.Q6J("svgIcon","heroicons_outline:x"),m.xp6(3),m.hij("",e("CHOOSE_ROLE")," "),m.xp6(2),m.Oqu(i.data.member.username),m.xp6(1),m.Q6J("ngModel",i.farmRole),m.xp6(1),m.Q6J("ngForOf",i.data.roleList),m.xp6(3),m.Oqu(e("CONFIRM")),m.xp6(2),m.Oqu(e("CANCEL"))}}let Ft=(()=>{class e{constructor(e,t){this.dialogRef=e,this.data=t}valueChange(e){this.role=e}onCancel(){this.dialogRef.close()}sendForm(){this.dialogRef.close(this.role)}}return e.\u0275fac=function(t){return new(t||e)(m.Y36(d.so),m.Y36(d.WI))},e.\u0275cmp=m.Xpm({type:e,selectors:[["app-add-role-dialog"]],decls:1,vars:1,consts:[[4,"transloco","translocoRead"],[1,"flex","flex-col","max-w-240","max-h-screen","-m-6"],[1,"flex","flex-0","items-center","justify-between","h-16","pr-3","sm:pr-5","pl-6","sm:pl-8","bg-primary","text-on-primary"],[1,"text-lg","font-medium"],[1,"title","dialog-title",3,"innerHTML"],["mat-icon-button","","mat-dialog-close","",3,"tabIndex"],[1,"text-current",3,"svgIcon"],[1,"flex","flex-col","flex-auto","p-6","sm:p-8","overflow-y-auto","sm:pb-0"],[1,"font-bold"],[1,"flex","flex-col","my-4",3,"ngModel","ngModelChange"],["class","my-1",3,"value",4,"ngFor","ngForOf"],[1,"flex","flex-0","items-center","justify-end","h-16","pr-3","sm:pr-5","pl-6","sm:pl-8"],["mat-flat-button","","color","primary","cdkFocusInitial","",1,"mr-3",3,"click"],["mat-stroked-button","",3,"click"],[1,"my-1",3,"value"]],template:function(e,t){1&e&&m.YNc(0,Nt,19,9,"ng-container",0),2&e&&m.Q6J("translocoRead","FARM.MANAGER")},directives:[p.KI,g.lW,d.ZT,h.Hw,St.VQ,o.JJ,o.On,r.sg,St.U0],styles:[""]}),e})();var yt=i(5653);function wt(e,t){1&e&&m._UZ(0,"mat-progress-bar",17),2&e&&m.Q6J("mode","indeterminate")}function Ct(e,t){1&e&&m._UZ(0,"mat-progress-bar",18)}function It(e,t){if(1&e){const e=m.EpF();m.TgZ(0,"div",19),m.TgZ(1,"div",20),m._UZ(2,"img",21),m.TgZ(3,"p"),m._uU(4),m.qZA(),m.qZA(),m.TgZ(5,"div",22),m.TgZ(6,"div",23),m._uU(7),m.qZA(),m.TgZ(8,"button",24),m.NdJ("click",function(){const t=m.CHM(e).index;return m.oxw(2).presentRemoveUser(t)}),m._UZ(9,"mat-icon",25),m.qZA(),m.qZA(),m.qZA()}if(2&e){const e=t.$implicit,i=m.oxw().$implicit,r=m.oxw();m.xp6(2),m.Q6J("src",r.memberService.getSitePath()+"/upload/users/avatars/medium/"+e.photo,m.LSH),m.xp6(2),m.Oqu(e.user_name),m.xp6(3),m.Oqu("farm_manager"===e.permission&&i("FARM_MANAGER")||"store_manager"===e.permission&&i("STORE_MANAGER")||"keeper_manager"===e.permission&&i("KEEPER_MANAGER")||"farm_operation"===e.permission&&i("FARM_OPERATION"))}}function Rt(e,t){if(1&e){const e=m.EpF();m.TgZ(0,"div"),m.TgZ(1,"div",26),m.TgZ(2,"div",20),m._UZ(3,"img",21),m.TgZ(4,"p"),m._uU(5),m.qZA(),m.qZA(),m.TgZ(6,"button",27),m.NdJ("click",function(){const t=m.CHM(e).$implicit;return m.oxw(2).presentAddUser(t)}),m._UZ(7,"mat-icon",28),m.qZA(),m.qZA(),m.qZA()}if(2&e){const e=t.$implicit,i=m.oxw(2);m.xp6(3),m.Q6J("src",i.memberService.getSitePath()+"/upload/users/avatars/medium/"+e.photo,m.LSH),m.xp6(2),m.Oqu(e.username),m.xp6(1),m.Q6J("disabled",i.disableAddBtn(e))}}function Et(e,t){if(1&e&&(m.ynx(0),m.TgZ(1,"div",1),m.TgZ(2,"div",2),m.TgZ(3,"div",3),m._UZ(4,"span",4),m.qZA(),m.TgZ(5,"button",5),m._UZ(6,"mat-icon",6),m.qZA(),m.qZA(),m.TgZ(7,"div",7),m.TgZ(8,"div"),m.YNc(9,wt,1,1,"mat-progress-bar",8),m.YNc(10,Ct,1,0,"mat-progress-bar",9),m.qZA(),m.TgZ(11,"div",10),m.YNc(12,It,10,3,"div",11),m.TgZ(13,"mat-form-field",12),m.TgZ(14,"mat-label"),m._uU(15),m.qZA(),m._UZ(16,"input",13),m.qZA(),m.TgZ(17,"div"),m.YNc(18,Rt,8,3,"div",14),m.ALo(19,"async"),m.qZA(),m.qZA(),m.qZA(),m.TgZ(20,"div",15),m.TgZ(21,"button",16),m.TgZ(22,"span"),m._uU(23),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.BQk()),2&e){const e=t.$implicit,i=m.oxw();m.xp6(4),m.Q6J("innerHTML",e("MANAGER"),m.oJD),m.xp6(1),m.Q6J("tabIndex",-1),m.xp6(1),m.Q6J("svgIcon","heroicons_outline:x"),m.xp6(3),m.Q6J("ngIf",i.savingFlag.pending),m.xp6(1),m.Q6J("ngIf",i.loadingFlag.pending),m.xp6(2),m.Q6J("ngForOf",i.oldManager),m.xp6(3),m.Oqu(e("SEARCH")),m.xp6(1),m.Q6J("placeholder",e("ENTER_USERNAME"))("formControl",i.searchWord),m.xp6(2),m.Q6J("ngForOf",m.lcZ(19,12,i.members$)),m.xp6(3),m.Q6J("color","primary"),m.xp6(2),m.hij(" ",e("DONE")," ")}}let Ot=(()=>{class e{constructor(e,t,i,r,a,s,l,c){this.farmService=e,this.memberService=t,this.alertService=i,this.dialogRef=r,this.data=a,this._fuseConfirmationService=s,this._translateService=l,this.dialog=c,this.savingFlag=new n.E,this.loadingFlag=new n.E,this.searchWord=new o.NI,this.oldManager=[],this.roleList=[{value:"farm_manager",label:this._translateService.translate("FARM.MANAGER.FARM_MANAGER")},{value:"farm_operation",label:this._translateService.translate("FARM.MANAGER.FARM_OPERATION")},{value:"store_manager",label:this._translateService.translate("FARM.MANAGER.STORE_MANAGER")},{value:"keeper_manager",label:this._translateService.translate("FARM.MANAGER.KEEPER_MANAGER")}]}ngOnInit(){this.oldManager=this.data.managerData,this.searchWord.valueChanges.pipe((0,qt.b)(300)).subscribe(e=>{this.getListMember(e)})}getListMember(e){e.length>=2&&(this.loadingFlag.setPending(!0),this.members$=this.memberService.searchMember(e).pipe(e=>(this.message=0==e.length?this._translateService.translate("FARM.MANAGER.NOT_FOUND"):"",this.loadingFlag.setResult(!0),e)))}disableAddBtn(e){return this.oldManager.findIndex(t=>t.user_name===e.username)>=0}onSelect(e){this.memberSelected=e}addPermission(e,t){this.farmService.updatePrivate({user_manager:e.user_id,fid:this.farmService.farm.id,position:t}).pipe().subscribe(i=>{0==i.status?this.alertService.error(i.error):(this.farmService.manager.push({user_name:e.username,user_id:e.user_id,permission:t}),this.farmService.onLoaded$.next(1),this.alertService.success(this._translateService.translate("FARM.MANAGER.SUCCESS"))),this.savingFlag.setResult(!0)},e=>{this.savingFlag.setResult(!1),this.alertService.error(this._translateService.translate("CONNECT_ERROR"))})}removePermission(e){this.farmService.removePermission(this.oldManager[e].user_id,this.oldManager[e].permission).pipe().subscribe(t=>{0==t.status?this.alertService.error(t.error):(this.alertService.success(this._translateService.translate("FARM.MANAGER.DELETE_SUCCESS")),this.farmService.manager.splice(e,1),this.farmService.onLoaded$.next(1)),this.savingFlag.setResult(!0)},e=>{this.savingFlag.setResult(!1),this.alertService.error(this._translateService.translate("CONNECT_ERROR"))})}presentRemoveUser(e){this._fuseConfirmationService.open({title:this._translateService.translate("FARM.MANAGER.WARN"),message:this._translateService.translate("FARM.MANAGER.CONFIRM_DELETE"),actions:{confirm:{label:this._translateService.translate("CONFIRM")},cancel:{label:this._translateService.translate("CANCEL")}}}).afterClosed().subscribe(t=>{t&&"confirmed"==t&&this.removePermission(e)})}presentAddUser(e){var t=this;return(0,Tt.Z)(function*(){t.dialog.open(Ft,{width:"350px",data:{member:e,roleList:t.roleList}}).afterClosed().subscribe(i=>{i&&t.addPermission(e,i)})})()}}return e.\u0275fac=function(t){return new(t||e)(m.Y36(u.D),m.Y36(yt.n),m.Y36(f.c),m.Y36(d.so),m.Y36(d.WI),m.Y36(D.R),m.Y36(p.Vn),m.Y36(d.uw))},e.\u0275cmp=m.Xpm({type:e,selectors:[["app-farm-manager"]],decls:1,vars:1,consts:[[4,"transloco","translocoRead"],[1,"flex","flex-col","max-w-240","md:min-w-120","-m-6"],[1,"flex","flex-0","items-center","justify-between","h-16","pr-3","sm:pr-5","pl-6","sm:pl-8","bg-primary","text-on-primary"],[1,"text-lg","font-medium"],[1,"title","dialog-title",3,"innerHTML"],["mat-icon-button","","mat-dialog-close","",3,"tabIndex"],[1,"text-current",3,"svgIcon"],[1,"flex","flex-col","flex-auto","p-6","sm:p-8","overflow-y-auto"],[3,"mode",4,"ngIf"],["mode","indeterminate",4,"ngIf"],[1,"w-full"],["class","flex justify-between items-center py-1",4,"ngFor","ngForOf"],["appearance","legacy",1,"w-full"],["matInput","",3,"placeholder","formControl"],[4,"ngFor","ngForOf"],[1,"flex","flex-0","items-center","justify-end","h-16","pr-3","sm:pr-5","pl-6","sm:pl-8"],["mat-flat-button","","mat-dialog-close","",1,"fuse-mat-button",3,"color"],[3,"mode"],["mode","indeterminate"],[1,"flex","justify-between","items-center","py-1"],[1,"flex","justify-start","items-center"],["onError","this.src='assets/images/avatars/default-profile.jpg'",2,"border-radius","50%","width","32px","margin-right","5px",3,"src"],[1,"flex","justify-end","items-center"],[1,"font-bold","mr-1"],["mat-icon-button","","color","warn",3,"click"],["svgIcon","mat_solid:delete"],[1,"flex","justify-between","items-center","py-1","w-full"],["mat-icon-button","","color","primary",3,"disabled","click"],["svgIcon","mat_solid:add"]],template:function(e,t){1&e&&m.YNc(0,Et,24,14,"ng-container",0),2&e&&m.Q6J("translocoRead","FARM.MANAGER")},directives:[p.KI,g.lW,d.ZT,h.Hw,r.O5,r.sg,Z.KE,Z.hX,v.Nt,o.Fj,o.JJ,o.oH,T.pW],pipes:[r.Ov],styles:[""]}),e})();function Ut(e,t){if(1&e){const e=m.EpF();m.ynx(0),m.TgZ(1,"div",1),m.TgZ(2,"div",2),m.TgZ(3,"div",3),m._uU(4),m.qZA(),m.TgZ(5,"button",4),m._UZ(6,"mat-icon",5),m.qZA(),m.qZA(),m.TgZ(7,"div",6),m.TgZ(8,"p",7),m._uU(9),m.qZA(),m.TgZ(10,"mat-radio-group",8),m.NdJ("ngModelChange",function(t){return m.CHM(e),m.oxw().data=t}),m.TgZ(11,"mat-radio-button",9),m._uU(12),m.TgZ(13,"p",10),m._uU(14),m.qZA(),m.qZA(),m.TgZ(15,"mat-radio-button",11),m._uU(16),m.TgZ(17,"p",10),m._uU(18),m.qZA(),m.qZA(),m.TgZ(19,"mat-radio-button",12),m._uU(20),m.TgZ(21,"p",10),m._uU(22),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.TgZ(23,"div",13),m.TgZ(24,"button",14),m.TgZ(25,"span"),m._uU(26),m.qZA(),m.qZA(),m.TgZ(27,"button",15),m.TgZ(28,"span"),m._uU(29),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.BQk()}if(2&e){const e=t.$implicit,i=m.oxw();m.xp6(4),m.Oqu(e("TITLE")),m.xp6(1),m.Q6J("tabIndex",-1),m.xp6(1),m.Q6J("svgIcon","heroicons_outline:x"),m.xp6(3),m.Oqu(e("SUBTITLE")),m.xp6(1),m.Q6J("ngModel",i.data),m.xp6(2),m.hij(" ",e("PUBLIC")," "),m.xp6(2),m.Oqu(e("PUBLIC_NOTE")),m.xp6(2),m.hij(" ",e("FOLLOWED")," "),m.xp6(2),m.Oqu(e("FOLLOWED_NOTE")),m.xp6(2),m.hij(" ",e("PRIVATE")," "),m.xp6(2),m.Oqu(e("PRIVATE_NOTE")),m.xp6(2),m.Q6J("color","primary")("mat-dialog-close",i.data),m.xp6(2),m.hij(" ",e("SAVE")," "),m.xp6(1),m.Q6J("color","secondary"),m.xp6(2),m.hij(" ",e("CANCEL")," ")}}let kt=(()=>{class e{constructor(e,t,i){this.data=e,this.farmService=t,this.localDb=i}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)(m.Y36(d.WI),m.Y36(u.D),m.Y36(oe.T))},e.\u0275cmp=m.Xpm({type:e,selectors:[["app-farm-private-setting"]],decls:1,vars:1,consts:[[4,"transloco","translocoRead"],[1,"flex","flex-col","max-w-240","md:min-w-160","-m-6"],[1,"flex","flex-0","items-center","justify-between","h-16","pr-3","sm:pr-5","pl-6","sm:pl-8","bg-primary","text-on-primary"],[1,"text-lg","font-medium"],["mat-icon-button","","mat-dialog-close","",3,"tabIndex"],[1,"text-current",3,"svgIcon"],[1,"flex","flex-col","flex-auto","p-6","sm:p-8","overflow-y-auto"],[1,"text-xl","font-bold","mb-3"],[1,"flex","flex-col","divide-y",3,"ngModel","ngModelChange"],["value","3",1,"font-medium","pb-2"],[1,"text-sm"],["value","2",1,"font-medium","py-2"],["value","1",1,"font-medium","pt-2"],[1,"flex","flex-0","items-center","justify-end","h-16","pr-3","sm:pr-5","pl-6","sm:pl-8"],["mat-flat-button","",1,"fuse-mat-button","mr-3",3,"color","mat-dialog-close"],["mat-stroked-button","","mat-dialog-close","",1,"fuse-mat-button",3,"color"]],template:function(e,t){1&e&&m.YNc(0,Ut,30,16,"ng-container",0),2&e&&m.Q6J("translocoRead","FARM.PRIVATE")},directives:[p.KI,g.lW,d.ZT,h.Hw,St.VQ,o.JJ,o.On,St.U0],styles:[""]}),e})();var Jt=i(25578),Mt=i(47101),Dt=i(77526),Qt=i(11436),Lt=i(23017),Yt=i(29551);const Pt=function(){return["company_manager","farm_manager","farm_operation"]};function jt(e,t){if(1&e&&(m.TgZ(0,"button",15),m._UZ(1,"mat-icon",16),m.qZA()),2&e){const e=m.oxw().$implicit,t=m.oxw();m.Q6J("appPermission",m.DdM(6,Pt))("currentPermission",t.farmService.permission)("routerLink","calendar")("color","primary")("matTooltip",e("CALENDAR")),m.xp6(1),m.Q6J("svgIcon","iconsmind:calendar_4")}}const Ht=function(){return["company_manager","farm_manager"]};function $t(e,t){if(1&e&&(m.TgZ(0,"button",15),m._UZ(1,"mat-icon",16),m.qZA()),2&e){const e=m.oxw().$implicit,t=m.oxw();m.Q6J("appPermission",m.DdM(6,Ht))("currentPermission",t.farmService.permission)("routerLink","report")("color","primary")("matTooltip",e("REPORTS")),m.xp6(1),m.Q6J("svgIcon","iconsmind:bar_chart2")}}function Gt(e,t){1&e&&m._UZ(0,"mat-progress-bar",29),2&e&&m.Q6J("mode","indeterminate")}function Bt(e,t){1&e&&m._UZ(0,"router-outlet")}const Wt=function(){return["company_manager","farm_operation","farm_manager","keeper_manager","store_manager"]},Vt=function(){return["company_manager","farm_manager","keeper_manager"]};function Kt(e,t){if(1&e){const e=m.EpF();m.ynx(0),m.TgZ(1,"div",1),m.TgZ(2,"div",2),m.TgZ(3,"div",3),m.TgZ(4,"div"),m.TgZ(5,"a",4),m._uU(6),m.qZA(),m.qZA(),m.TgZ(7,"div",5),m._UZ(8,"mat-icon",6),m.TgZ(9,"a",4),m._uU(10),m.qZA(),m.qZA(),m.qZA(),m.TgZ(11,"div",7),m.TgZ(12,"a",8),m._UZ(13,"mat-icon",6),m.TgZ(14,"span",9),m._uU(15,"Back"),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.TgZ(16,"div",10),m.TgZ(17,"div",11),m.TgZ(18,"div",12),m.TgZ(19,"h2",13),m._uU(20),m.qZA(),m.qZA(),m.qZA(),m.TgZ(21,"div",14),m.TgZ(22,"button",15),m._UZ(23,"mat-icon",16),m.qZA(),m.TgZ(24,"button",15),m._UZ(25,"mat-icon",16),m.qZA(),m.YNc(26,jt,2,7,"button",17),m.YNc(27,$t,2,7,"button",17),m.TgZ(28,"button",18),m.NdJ("click",function(){return m.CHM(e),m.MAs(32).toggle()}),m._UZ(29,"mat-icon",19),m.qZA(),m.qZA(),m.qZA(),m.TgZ(30,"mat-drawer-container",20),m.TgZ(31,"mat-drawer",21,22),m._UZ(33,"fuse-vertical-navigation",23),m.qZA(),m.TgZ(34,"mat-drawer-content",24),m.TgZ(35,"div",25),m.TgZ(36,"div",26),m.TgZ(37,"div"),m.YNc(38,Gt,1,1,"mat-progress-bar",27),m.qZA(),m.YNc(39,Bt,1,0,"router-outlet",28),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.BQk()}if(2&e){const e=t.$implicit,i=m.oxw();m.xp6(5),m.MGl("routerLink","/company/",null==i.localDb.company?null:i.localDb.company.code,""),m.xp6(1),m.Oqu(null==i.farmService.farm?null:i.farmService.farm.company_name),m.xp6(2),m.Q6J("svgIcon","heroicons_solid:chevron-right"),m.xp6(1),m.MGl("routerLink","/farm/",null==i.farmService.farm?null:i.farmService.farm.code,""),m.xp6(1),m.Oqu(null==i.farmService.farm?null:i.farmService.farm.name),m.xp6(2),m.Q6J("routerLink","./.."),m.xp6(1),m.Q6J("svgIcon","heroicons_solid:chevron-left"),m.xp6(7),m.hij(" ",null==i.farmService.farm?null:i.farmService.farm.name," "),m.xp6(2),m.MGl("routerLink","/store/",null==i.farmService.farm?null:i.farmService.farm.code,"/list-store"),m.Q6J("appPermission",m.DdM(34,Wt))("currentPermission",i.farmService.permission)("color","primary")("matTooltip",e("WAREHOUSE")),m.xp6(1),m.Q6J("svgIcon","iconsmind:warehouse"),m.xp6(1),m.Q6J("appPermission",m.DdM(35,Vt))("currentPermission",i.farmService.permission)("routerLink","finance")("color","primary")("matTooltip",e("BOOKKEEPING")),m.xp6(1),m.Q6J("svgIcon","iconsmind:money_2"),m.xp6(1),m.Q6J("ngIf",i.loadingFlag.result),m.xp6(1),m.Q6J("ngIf",i.loadingFlag.result),m.xp6(2),m.Q6J("svgIcon","heroicons_outline:menu"),m.xp6(2),m.Q6J("autoFocus",!1)("mode",i.drawerMode)("opened",i.drawerOpened)("position","end"),m.xp6(2),m.Q6J("navigation",i.menuData)("inner",!0)("mode","side")("name","company-components-navigation")("opened",!0),m.xp6(5),m.Q6J("ngIf",i.loadingFlag.pending),m.xp6(1),m.Q6J("ngIf",i.farmService.farm&&!i.loadingFlag.pending)}}function zt(e,t){1&e&&(m.TgZ(0,"mat-error"),m._uU(1," Kh\xf4ng qu\xe1 20 k\xed t\u1ef1 "),m.qZA())}function Xt(e,t){if(1&e&&(m.TgZ(0,"mat-error"),m._uU(1),m.qZA()),2&e){const e=m.oxw().$implicit;m.xp6(1),m.hij(" ",e("VALIDATION_MESSAGE.NAME")," ")}}function ei(e,t){if(1&e&&(m.TgZ(0,"mat-error"),m._uU(1),m.qZA()),2&e){const e=m.oxw().$implicit;m.xp6(1),m.hij(" ",e("VALIDATION_MESSAGE.AREAS")," ")}}function ti(e,t){if(1&e&&(m.TgZ(0,"mat-error"),m._uU(1),m.qZA()),2&e){const e=m.oxw().$implicit;m.xp6(1),m.hij(" ",e("VALIDATION_MESSAGE.AREA")," ")}}function ii(e,t){if(1&e&&(m.TgZ(0,"mat-error"),m._uU(1),m.qZA()),2&e){const e=m.oxw().$implicit;m.xp6(1),m.hij(" ",e("VALIDATION_MESSAGE.DEEPS")," ")}}function ri(e,t){if(1&e&&(m.TgZ(0,"mat-error"),m._uU(1),m.qZA()),2&e){const e=m.oxw().$implicit;m.xp6(1),m.hij(" ",e("VALIDATION_MESSAGE.DEEP")," ")}}function ai(e,t){if(1&e&&(m.TgZ(0,"p",20),m._uU(1),m.ALo(2,"number"),m.qZA()),2&e){const e=m.oxw(2);m.xp6(1),m.hij(" ",m.xi3(2,1,e.formCost/e.form.value.expire,"1.0-0")," \u0111 ")}}function oi(e,t){1&e&&m._UZ(0,"mat-progress-bar",21)}function ni(e,t){if(1&e){const e=m.EpF();m.ynx(0),m.TgZ(1,"div",1),m.TgZ(2,"form",2),m.TgZ(3,"p",3),m._uU(4),m.qZA(),m.TgZ(5,"div",4),m.TgZ(6,"mat-form-field",5),m._UZ(7,"input",6),m._UZ(8,"mat-icon",7),m.YNc(9,zt,2,0,"mat-error",8),m.YNc(10,Xt,2,1,"mat-error",8),m.qZA(),m.qZA(),m.TgZ(11,"div",4),m.TgZ(12,"mat-form-field",5),m._UZ(13,"input",9),m._UZ(14,"mat-icon",10),m.YNc(15,ei,2,1,"mat-error",8),m.YNc(16,ti,2,1,"mat-error",8),m.qZA(),m.qZA(),m.TgZ(17,"div",4),m.TgZ(18,"mat-form-field",5),m._UZ(19,"input",11),m._UZ(20,"mat-icon",12),m.YNc(21,ii,2,1,"mat-error",8),m.YNc(22,ri,2,1,"mat-error",8),m.qZA(),m.qZA(),m.TgZ(23,"div",4),m.TgZ(24,"mat-form-field",5),m.TgZ(25,"input",13),m.NdJ("input",function(t){return m.CHM(e),m.oxw().updateFormCost(t.target.value)}),m.qZA(),m._UZ(26,"mat-icon",12),m.qZA(),m.qZA(),m.TgZ(27,"div",4),m.TgZ(28,"mat-form-field",5),m._UZ(29,"input",14),m._UZ(30,"mat-icon",12),m.qZA(),m.qZA(),m.TgZ(31,"p",15),m._uU(32),m.qZA(),m.YNc(33,ai,3,4,"p",16),m.YNc(34,oi,1,0,"mat-progress-bar",17),m.TgZ(35,"div",18),m.TgZ(36,"button",19),m.NdJ("click",function(){return m.CHM(e),m.oxw().createPond()}),m._uU(37),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.BQk()}if(2&e){const e=t.$implicit,i=m.oxw();m.xp6(2),m.Q6J("formGroup",i.form),m.xp6(2),m.Oqu(e("TITLE")),m.xp6(3),m.Q6J("placeholder",e("POND_NAME")),m.xp6(2),m.Q6J("ngIf",i.form.get("name").hasError("maxlength")&&i.form.get("area").hasError("required")),m.xp6(1),m.Q6J("ngIf",i.form.get("name").hasError("required")),m.xp6(3),m.Q6J("placeholder",e("AREA")),m.xp6(2),m.Q6J("ngIf",i.form.get("area").value>=1<=5e4&&!i.form.get("area").hasError("required")),m.xp6(1),m.Q6J("ngIf",i.form.get("area").hasError("required")),m.xp6(3),m.Q6J("placeholder",e("DEPTH")),m.xp6(1),m.Q6J("svgIcon","iconsmind:ruler"),m.xp6(1),m.Q6J("ngIf",i.form.get("deep").value>=0<=10&&!i.form.get("deep").hasError("required")),m.xp6(1),m.Q6J("ngIf",i.form.get("deep").hasError("required")),m.xp6(3),m.Q6J("placeholder",e("COST")),m.xp6(1),m.Q6J("svgIcon","iconsmind:coin"),m.xp6(3),m.Q6J("placeholder",e("CROP_NUMBER")),m.xp6(1),m.Q6J("svgIcon","heroicons_outline:question-mark-circle"),m.xp6(2),m.hij(" ",e("DEPR_COST")," "),m.xp6(1),m.Q6J("ngIf",i.formCost&&i.form.value.expire),m.xp6(1),m.Q6J("ngIf",i.savingFlag.pending),m.xp6(2),m.Q6J("disabled",i.form.invalid),m.xp6(1),m.Oqu(e("CREATE"))}}const si=[{path:"",component:(()=>{class e{constructor(e,t,i,r,a,o,s,l,c){this._fuseMediaWatcherService=e,this._matDialog=t,this._translateService=i,this._router=r,this._alertService=a,this._route=o,this.farmService=s,this.localDb=l,this._storeService=c,this._unsubscribeAll=new _t.xQ,this.drawerMode="side",this.drawerOpened=!0,this.loadingFlag=new n.E,this.storeDetailList=[]}ngOnInit(){this._fuseMediaWatcherService.onMediaChange$.pipe((0,xt.R)(this._unsubscribeAll)).subscribe(({matchingAliases:e})=>{e.includes("lg")?(this.drawerMode="side",this.drawerOpened=!0):(this.drawerMode="over",this.drawerOpened=!1)}),this.sub$=this._route.params.subscribe(e=>{this.farmService.setCode(e.code),this.getFarmInfo()}),this.farmService.onLoaded$.subscribe(e=>{1==e&&this.filterSideBar()})}ngOnDestroy(){this._unsubscribeAll.next(),this._unsubscribeAll.complete(),this.sub$.unsubscribe()}getFarmInfo(){this.loadingFlag.setPending(!0),this.farmService.loadFarm().pipe().subscribe(e=>{if(0==e.status)this._alertService.error(e.error),this._router.navigate(["/dashboard"]);else{let t=e.data;t.permission=e.permission,this.farmService.setFarm(t),void 0===this.findLocalDbFarm()&&this.localDb.addItem("farms",{infor:t,store:[]}),this.localDb.setLocalData("currentFarm",t),this.farmService.permission=e.permission,this.permission=e.permission,this.farmService.estimate=e.estimate,this._indexFarm=this.localDb.farms.findIndex(e=>e.infor.code===this.farmService.fcode),this.loadSettings()}this.loadingFlag.setResult(!0)},e=>{this._router.navigate(["/dashboard"]),this.loadingFlag.setResult(!1),this._alertService.error(this._translateService.translate("CONNECT_ERROR"))})}findLocalDbFarm(){return this.localDb.farms.find(e=>e.infor.code==this.farmService.fcode)}loadSettings(){this.farmService.getSettings().pipe().subscribe(e=>{if(1==e.status){const{farm_manager:t=[],store_manager:i=[],keeper_manager:r=[],farm_operation:a=[]}=e.data.manager;this.farmService.manager=[...t,...a,...i,...r],this.filterSideBar()}})}initSideBar(){this.menuData=[],["store_manager","keeper_manager","farm_manager","farm_operation","company_manager"].includes(this.farmService.permission)&&this.menuData.push({title:this._translateService.translate("FARM.INVENTORY"),type:"group",children:[{title:this._translateService.translate("FARM.WAREHOUSE"),icon:"iconsmind:warehouse",type:"basic",link:"/store/"+this.farmService.fcode+"/list-store"},{title:this._translateService.translate("FARM.ADD_STORE"),icon:"mat_solid:bar_chart",type:"basic",link:"/store/"+this.farmService.fcode+"/chart"}]}),["keeper_manager","farm_manager","company_manager"].includes(this.farmService.permission)&&this.menuData.push({title:this._translateService.translate("FARM.BOOKKEEPING"),type:"group",children:[{title:this._translateService.translate("FARM.WRITE_RECORD"),icon:"iconsmind:pen",type:"basic",function:()=>this.addFinanceRecord()},{title:this._translateService.translate("FARM.BOOKKEEPING_LIST"),icon:"iconsmind:money_2",type:"basic",link:"finance"},{title:"B\xe1o c\xe1o",icon:"mat_solid:bar_chart",type:"basic",link:"finance/analyst"},{title:"C\xf4ng n\u1ee3",icon:"mat_outline:menu_book",type:"basic",link:"finance/fastPay"}]}),["farm_operation","farm_manager","company_manager"].includes(this.farmService.permission)&&this.menuData.push({title:this._translateService.translate("FARM.SETTINGS"),type:"group",children:[{title:this._translateService.translate("FARM.SETTINGS_INFO"),icon:"mat_outline:info",type:"basic",link:"info"},{title:this._translateService.translate("FARM.SETTINGS_PRIVACY"),icon:"mat_outline:vpn_lock",type:"basic",function:()=>this.openPrivateSetting()},{title:this._translateService.translate("FARM.SETTINGS_CREATEPOND"),icon:"mat_outline:add_box",type:"basic",link:"pond-create"},{title:this._translateService.translate("FARM.SETTINGS_MANAGER"),badge:{title:"0",classes:"px-2 bg-primary text-on-primary rounded-full"},icon:"mat_outline:group_add",type:"basic",function:()=>this.openManagerSetting()},{title:this._translateService.translate("FARM.CALENDAR"),icon:"mat_solid:calendar_today",type:"basic",link:"calendar"}]})}filterSideBar(){this.initSideBar(),this.menuData[this.menuData.length-1].children[1].subtitle=3==this.farmService.farm.public?"M\u1ecdi ng\u01b0\u1eddi":2==this.farmService.farm.public?"Ng\u01b0\u1eddi theo d\xf5i":"Ri\xeang t\u01b0",this.menuData[this.menuData.length-1].children[3].badge.title=this.farmService.manager.length.toString()}openPrivateSetting(){this._matDialog.open(kt,{autoFocus:!1,data:this.farmService.farm.public}).afterClosed().subscribe(e=>{e&&this.farmService.updatePrivate({public:e,fid:this.farmService.farm.id}).pipe().subscribe(t=>{0==t.status?this._alertService.error(t.error):(this.farmService.farm.public=e,this.localDb.farms[this._indexFarm].infor.public=e,this.localDb.currentFarm.public=e,this.localDb.setLocalData("farms",this.localDb.farms),this._alertService.success(t.message))},e=>{this._alertService.error(this._translateService.translate("CONNECT_ERROR"))})})}openManagerSetting(){this._matDialog.open(Ot,{autoFocus:!1,data:{managerData:this.farmService.manager}})}addFinanceRecord(){this._matDialog.open(At.r,{autoFocus:!1}).afterClosed().subscribe(e=>{e&&(this._alertService.success(this._translateService.translate("FARM.ADD.ADD_SUCCESS")),this._router.navigate([`farm/${this.farmService.fcode}/finance`]))})}getDataStoreDetail(){this.loadingFlag.setPending(!0),this._storeService.fetchStoreDetail().subscribe(e=>{1==e.status&&e.data?this.storeDetailList=e.data.list:this._alertService.error(e.message),this.loadingFlag.setResult(!0)})}}return e.\u0275fac=function(t){return new(t||e)(m.Y36(Jt.T),m.Y36(d.uw),m.Y36(p.Vn),m.Y36(a.F0),m.Y36(f.c),m.Y36(a.gz),m.Y36(u.D),m.Y36(oe.T),m.Y36(Mt.d))},e.\u0275cmp=m.Xpm({type:e,selectors:[["app-farm"]],decls:1,vars:1,consts:[[4,"transloco","translocoRead"],[1,"flex","flex-col","flex-auto","min-w-0"],[1,"px-6","pt-6","sm:pt-6","sm:px-10","bg-card","dark:bg-transparent"],[1,"hidden","sm:flex","flex-wrap","items-center","font-medium"],[1,"whitespace-nowrap","text-primary-500",3,"routerLink"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[1,"flex","sm:hidden"],[1,"inline-flex","items-center","-ml-1.5","text-secondary","font-medium",3,"routerLink"],[1,"ml-1"],[1,"flex","flex-col","sm:flex-row","flex-0","sm:items-center","sm:justify-between","p-6","pb-22","sm:pt-6","sm:pb-28","sm:px-10","bg-card","dark:bg-transparent"],[1,"flex-1","min-w-0"],[1,"mt-2"],[1,"text-3xl","md:text-4xl","font-extrabold","tracking-tight","leading-7","sm:leading-10","truncate"],[1,"flex","flex-shrink-0","items-center","mt-6","sm:mt-0","sm:ml-4"],["mat-stroked-button","",1,"mr-2",3,"appPermission","currentPermission","routerLink","color","matTooltip"],[1,"icon-size-5",3,"svgIcon"],["class","mr-2","mat-stroked-button","",3,"appPermission","currentPermission","routerLink","color","matTooltip",4,"ngIf"],["mat-icon-button","",3,"click"],[3,"svgIcon"],[1,"flex-auto","-mt-16","rounded-t-2xl","shadow","bg-default"],[1,"w-72","dark:bg-gray-900",3,"autoFocus","mode","opened","position"],["matDrawer",""],[3,"navigation","inner","mode","name","opened"],[1,"flex","flex-col"],[1,"flex-auto","p-6","sm:p-10"],[1,"min-h-200","rounded-2xl"],[3,"mode",4,"ngIf"],[4,"ngIf"],[3,"mode"]],template:function(e,t){1&e&&m.YNc(0,Kt,40,36,"ng-container",0),2&e&&m.Q6J("translocoRead","FARM")},directives:[p.KI,a.yS,h.Hw,g.lW,Dt.l,a.rH,Qt.gM,r.O5,Lt.kh,Lt.jA,Yt.j,Lt.LW,T.pW,a.lC],styles:[""]}),e})(),children:[{path:"",component:Ze},{path:"material",loadChildren:()=>i.e(522).then(i.bind(i,92522)).then(e=>e.MaterialModule)},{path:"finance",loadChildren:()=>i.e(475).then(i.bind(i,51475)).then(e=>e.FinanceModule)},{path:"calendar",component:re},{path:"info",component:Me},{path:"report",component:vt},{path:"pond-create",component:(()=>{class e{constructor(e,t,i,r,a,o){this._farmService=e,this._formBuilder=t,this._translateService=i,this._localDb=r,this._alertService=a,this._router=o,this.savingFlag=new n.E}ngOnInit(){this.createForm()}createForm(){this.form=this._formBuilder.group({name:[null,o.kI.compose([o.kI.required,o.kI.maxLength(20)])],area:["",[o.kI.required,o.kI.max(5e4),o.kI.min(0)]],deep:["",[o.kI.required,o.kI.min(1),o.kI.max(10)]],cost:[""],expire:[""]})}createPond(){let e={fid:this._farmService.farm.id,name:this.form.value.name,area:this.form.value.area,deep:this.form.value.deep,cost:this.form.value.cost.replace(/\,/g,""),expire:this.form.value.expire};this.savingFlag.setPending(!0),this._farmService.insertOnePond(e).subscribe(t=>{if(t.error)this._alertService.error(t.error);else{this._alertService.success(this._translateService.translate("FARM.CREATE_POND.SUCCESS"));let i={infor:{id:0,code:t.data.code,name:e.name,public:1,area:e.area,create_cost:e.cost,deep:e.deep,expire_date:e.expire,add_time:(new Date).getTime(),warning:0,current_season:"",farm_id:this._farmService.farm.id,permission:"farm_manager"},devices:[]};this._localDb.ponds.push(i),this._localDb.setLocalData("ponds",this._localDb.ponds),this._router.navigate(["farm/"+this._farmService.fcode])}this.savingFlag.setResult(!0)},e=>{this.savingFlag.setResult(!1),this._alertService.error(this._translateService.translate("CONNECT_ERROR"))})}numberWithCommas(e){return e?e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","):""}updateFormCost(e){e=e.replace(/\,/g,""),this.formCost=e,this.form.patchValue({cost:this.numberWithCommas(e)})}}return e.\u0275fac=function(t){return new(t||e)(m.Y36(u.D),m.Y36(o.qu),m.Y36(p.Vn),m.Y36(oe.T),m.Y36(f.c),m.Y36(a.F0))},e.\u0275cmp=m.Xpm({type:e,selectors:[["app-pond-create"]],decls:1,vars:1,consts:[[4,"transloco","translocoRead"],[1,"w-full"],[1,"flex","flex-col","px-8","py-6","pb-3","bg-card","shadow","rounded-2xl","overflow-hidden","w-full",3,"formGroup"],[1,"text-lg","font-medium","mb-6"],[1,"flex"],[1,"flex-auto"],["matInput","","formControlName","name","id","name",3,"placeholder"],["matPrefix","","svgIcon","heroicons_solid:farmext-pond",1,"icon-size-5"],[4,"ngIf"],["matInput","","formControlName","area","id","area","type","number","step","0.01",3,"placeholder"],["matPrefix","","svgIcon","mat_solid:crop",1,"icon-size-5"],["matInput","","formControlName","deep","id","deep","type","number",3,"placeholder"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","","formControlName","cost",3,"placeholder","input"],["matInput","","formControlName","expire",3,"placeholder"],[1,"text-md","font-medium","mt-2"],["class","text-secondary text-lg mb-2",4,"ngIf"],["mode","indeterminate",4,"ngIf"],[1,"flex","justify-end"],["mat-button","",1,"bg-primary","text-on-primary","mb-4","mt-2",3,"disabled","click"],[1,"text-secondary","text-lg","mb-2"],["mode","indeterminate"]],template:function(e,t){1&e&&m.YNc(0,ni,38,21,"ng-container",0),2&e&&m.Q6J("translocoRead","FARM.CREATE_POND")},directives:[p.KI,o._Y,o.JL,o.sg,Z.KE,v.Nt,o.Fj,o.JJ,o.u,h.Hw,Z.qo,r.O5,o.wV,g.lW,Z.TO,T.pW],pipes:[r.JJ],styles:["input[_ngcontent-%COMP%]::-webkit-inner-spin-button, input[_ngcontent-%COMP%]::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield}"]}),e})()}]}];let li=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=m.oAB({type:e}),e.\u0275inj=m.cJS({imports:[[a.Bz.forChild(si)],a.Bz]}),e})();var ci=i(44466),di=i(82808),mi=i(84900),ui=i(4083);let pi=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=m.oAB({type:e}),e.\u0275inj=m.cJS({imports:[[r.ez,p.y4,ci.m,ui.q,li,di.PU,mi.Z,Le.N]]}),e})()},89822:(e,t,i)=>{"use strict";i.d(t,{r:()=>K});var r=i(3679),a=i(22238),o=i(53040),n=i(5396),s=i(16738),l=i(37716),c=i(76891),d=i(40704),m=i(8394),u=i(32705),p=i(51095),f=i(76627),g=i(38583),h=i(98295),Z=i(49983),v=i(43220),_=i(67441),x=i(72458),A=i(21554),T=i(12178),q=i(58341);function S(e,t){1&e&&l._UZ(0,"mat-progress-bar",43),2&e&&l.Q6J("mode","indeterminate")}function b(e,t){if(1&e&&(l.TgZ(0,"mat-option",44),l._uU(1),l.qZA()),2&e){const e=t.$implicit;l.Q6J("value",e.code),l.xp6(1),l.hij("",e.name," ")}}function N(e,t){if(1&e&&(l.TgZ(0,"mat-option",44),l._uU(1),l.qZA()),2&e){const e=t.$implicit;l.Q6J("value",e.customer_name),l.xp6(1),l.hij(" ",e.customer_name," ")}}function F(e,t){if(1&e){const e=l.EpF();l.TgZ(0,"mat-form-field",50),l.TgZ(1,"mat-label"),l._uU(2,"Th\xeam nh\xf3m"),l.qZA(),l.TgZ(3,"input",51,27),l.NdJ("focusout",function(){return l.CHM(e),l.oxw(3).saveGroup()}),l.qZA(),l.TgZ(5,"button",52),l.NdJ("click",function(){return l.CHM(e),l.oxw(3).saveGroup()}),l._uU(6,"OK"),l.qZA(),l.qZA()}}function y(e,t){if(1&e&&(l.TgZ(0,"mat-option",44),l._uU(1),l.qZA()),2&e){const e=l.oxw().$implicit;l.Q6J("value",e.key),l.xp6(1),l.hij(" ",e.value.name," ")}}function w(e,t){if(1&e&&(l.TgZ(0,"div"),l.YNc(1,y,2,2,"mat-option",55),l.qZA()),2&e){const e=t.$implicit;l.xp6(1),l.Q6J("ngIf","out"==e.value.type&&"Tr\u1ea3 n\u1ee3"!==e.value.name)}}function C(e,t){if(1&e&&(l.TgZ(0,"mat-form-field",38),l.TgZ(1,"mat-label"),l._uU(2,"Nh\xf3m"),l.qZA(),l.TgZ(3,"mat-select",53),l.YNc(4,w,2,1,"div",54),l.ALo(5,"keyvalue"),l.qZA(),l.qZA()),2&e){const e=l.oxw(2).$implicit,t=l.oxw();l.xp6(3),l.Q6J("placeholder",e("TYPE")),l.xp6(1),l.Q6J("ngForOf",l.lcZ(5,2,t.listCategory))}}function I(e,t){if(1&e){const e=l.EpF();l.TgZ(0,"mat-icon",56),l.NdJ("click",function(){l.CHM(e);const t=l.oxw(3);return t.isFalshy=!t.isFalshy}),l.qZA()}}function R(e,t){if(1&e){const e=l.EpF();l.TgZ(0,"mat-icon",57),l.NdJ("click",function(){l.CHM(e);const t=l.oxw(3);return t.isFalshy=!t.isFalshy}),l.qZA()}}function E(e,t){if(1&e&&(l.TgZ(0,"div",45),l.YNc(1,F,7,0,"mat-form-field",46),l.YNc(2,C,6,4,"mat-form-field",47),l.YNc(3,I,1,0,"mat-icon",48),l.YNc(4,R,1,0,"mat-icon",49),l.qZA()),2&e){const e=l.oxw(2);l.xp6(1),l.Q6J("ngIf",e.isFalshy),l.xp6(1),l.Q6J("ngIf",!e.isFalshy),l.xp6(1),l.Q6J("ngIf",!e.isFalshy),l.xp6(1),l.Q6J("ngIf",e.isFalshy)}}function O(e,t){if(1&e){const e=l.EpF();l.TgZ(0,"mat-form-field",50),l.TgZ(1,"mat-label"),l._uU(2,"Th\xeam nh\xf3m"),l.qZA(),l.TgZ(3,"input",59,27),l.NdJ("blur",function(){return l.CHM(e),l.oxw(3).saveGroup()}),l.qZA(),l.TgZ(5,"button",52),l.NdJ("click",function(){return l.CHM(e),l.oxw(3).saveGroup()}),l._uU(6,"OK"),l.qZA(),l.qZA()}}function U(e,t){if(1&e&&(l.TgZ(0,"mat-option",44),l._uU(1),l.qZA()),2&e){const e=l.oxw().$implicit;l.Q6J("value",e.key),l.xp6(1),l.hij(" ",e.value.name," ")}}function k(e,t){if(1&e&&(l.TgZ(0,"div"),l.YNc(1,U,2,2,"mat-option",55),l.qZA()),2&e){const e=t.$implicit;l.xp6(1),l.Q6J("ngIf","in"==e.value.type)}}function J(e,t){if(1&e&&(l.TgZ(0,"mat-form-field",38),l.TgZ(1,"mat-label"),l._uU(2,"Nh\xf3m"),l.qZA(),l.TgZ(3,"mat-select",53),l.YNc(4,k,2,1,"div",54),l.ALo(5,"keyvalue"),l.qZA(),l.qZA()),2&e){const e=l.oxw(2).$implicit,t=l.oxw();l.xp6(3),l.Q6J("placeholder",e("TYPE")),l.xp6(1),l.Q6J("ngForOf",l.lcZ(5,2,t.listCategory))}}function M(e,t){if(1&e){const e=l.EpF();l.TgZ(0,"mat-icon",56),l.NdJ("click",function(){l.CHM(e);const t=l.oxw(3);return t.isFalshy=!t.isFalshy}),l.qZA()}}function D(e,t){if(1&e){const e=l.EpF();l.TgZ(0,"mat-icon",57),l.NdJ("click",function(){l.CHM(e);const t=l.oxw(3);return t.isFalshy=!t.isFalshy}),l.qZA()}}function Q(e,t){if(1&e&&(l.TgZ(0,"div",45),l.YNc(1,O,7,0,"mat-form-field",46),l.YNc(2,J,6,4,"mat-form-field",58),l.YNc(3,M,1,0,"mat-icon",48),l.YNc(4,D,1,0,"mat-icon",49),l.qZA()),2&e){const e=l.oxw(2);l.xp6(1),l.Q6J("ngIf",e.isFalshy),l.xp6(1),l.Q6J("ngIf",!e.isFalshy),l.xp6(1),l.Q6J("ngIf",!e.isFalshy),l.xp6(1),l.Q6J("ngIf",e.isFalshy)}}function L(e,t){1&e&&(l.TgZ(0,"div",30),l.TgZ(1,"p",60),l._uU(2,"Chi ph\xed s\u1ebd chia \u0111\u1ec1u c\xe1c ao theo di\u1ec7n t\xedch n\u1ebfu l\xe0 chi ph\xed chung"),l.qZA(),l.qZA())}function Y(e,t){1&e&&(l.TgZ(0,"mat-icon",66),l._uU(1,"cancel"),l.qZA())}function P(e,t){if(1&e){const e=l.EpF();l.TgZ(0,"mat-chip",64),l.NdJ("click",function(t){const i=l.CHM(e),r=i.$implicit,a=i.index,o=l.oxw(3);return"farm"==r.type?t.stopPropagation():o.removePond(a)}),l._uU(1),l.YNc(2,Y,2,0,"mat-icon",65),l.qZA()}if(2&e){const e=t.$implicit;l.xp6(1),l.hij(" ",null==e?null:e.name," "),l.xp6(1),l.Q6J("ngIf","farm"!=e.type)}}function j(e,t){if(1&e&&(l.TgZ(0,"div",61),l.TgZ(1,"mat-chip-list",62),l.YNc(2,P,3,2,"mat-chip",63),l.qZA(),l.qZA()),2&e){const e=l.oxw(2);l.xp6(2),l.Q6J("ngForOf",e.pondSeleted)}}function H(e,t){1&e&&(l.TgZ(0,"div",30),l.TgZ(1,"p",60),l._uU(2,"Chi ph\xed s\u1ebd chia \u0111\u1ec1u c\xe1c ao theo ao n\u1ebfu l\xe0 chi ph\xed chung"),l.qZA(),l.qZA())}function $(e,t){1&e&&(l.TgZ(0,"mat-error"),l._uU(1," Kh\xf4ng \u0111\u01b0\u1ee3c nh\u1ecf h\u01a1n "),l.qZA())}function G(e,t){1&e&&(l.TgZ(0,"mat-error"),l._uU(1," Kh\xf4ng \u0111\u01b0\u1ee3c nh\u1ecf h\u01a1n "),l.qZA())}function B(e,t){1&e&&(l.TgZ(0,"mat-hint"),l.TgZ(1,"strong",68),l._uU(2,"Kh\xf4ng l\u1edbn h\u01a1n s\u1ed1 ti\u1ec1n tr\u1ea3"),l.qZA(),l.qZA())}function W(e,t){if(1&e){const e=l.EpF();l.TgZ(0,"mat-form-field",25),l.TgZ(1,"mat-label"),l._uU(2,"S\u1ed1 ti\u1ec1n \u0111\xe3 tr\u1ea3"),l.qZA(),l.TgZ(3,"input",67),l.NdJ("input",function(t){return l.CHM(e),l.oxw(2).numberFormatCostNumber.setValue(t.target.value)})("keypress",function(t){return l.CHM(e),l.oxw(2).validateNo(t)}),l.qZA(),l.YNc(4,G,2,0,"mat-error",36),l.TgZ(5,"mat-error"),l._uU(6," Vui l\xf2ng nh\u1eadn s\u1ed1 "),l.qZA(),l.YNc(7,B,3,0,"mat-hint",36),l.qZA()}if(2&e){const e=l.oxw().$implicit,t=l.oxw();l.xp6(3),l.Q6J("placeholder",e("AMOUNT"))("value",t.numberFormatCostNumber.fakeView),l.xp6(1),l.Q6J("ngIf",t.addForm.get("amounts_payed").value<0),l.xp6(3),l.Q6J("ngIf",t.numberFormatCost.realValue<t.numberFormatCostNumber.realValue)}}function V(e,t){if(1&e){const e=l.EpF();l.ynx(0),l.TgZ(1,"div",1),l.TgZ(2,"div",2),l.TgZ(3,"div",3),l._uU(4),l.qZA(),l.TgZ(5,"button",4),l._UZ(6,"mat-icon",5),l.qZA(),l.qZA(),l.TgZ(7,"div",6),l.TgZ(8,"div"),l.YNc(9,S,1,1,"mat-progress-bar",7),l.qZA(),l.TgZ(10,"div",8),l.TgZ(11,"div",9),l.TgZ(12,"div",10),l.TgZ(13,"mat-form-field",11),l.TgZ(14,"mat-label"),l._uU(15),l.qZA(),l.TgZ(16,"input",12),l.NdJ("click",function(){return l.CHM(e),l.MAs(19).open()}),l.qZA(),l._UZ(17,"mat-datepicker-toggle",13),l._UZ(18,"mat-datepicker",null,14),l.qZA(),l.TgZ(20,"mat-form-field",15),l.TgZ(21,"mat-label"),l._uU(22),l.qZA(),l.TgZ(23,"mat-select",16),l.TgZ(24,"mat-option",17),l._uU(25),l.qZA(),l.TgZ(26,"mat-option",18),l._uU(27),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.TgZ(28,"div",10),l.TgZ(29,"mat-form-field",19),l.TgZ(30,"mat-label"),l._uU(31),l.qZA(),l.TgZ(32,"mat-select",20),l.NdJ("selectionChange",function(t){return l.CHM(e),l.oxw().chooseType(t)}),l.TgZ(33,"mat-option",21),l._uU(34),l.qZA(),l.TgZ(35,"mat-option",22),l._uU(36,"Chung (m2) "),l.qZA(),l.TgZ(37,"mat-option",23),l._uU(38,"Chia \u0111\u1ec1u theo ao "),l.qZA(),l.YNc(39,b,2,2,"mat-option",24),l.qZA(),l.qZA(),l.TgZ(40,"mat-form-field",25),l.TgZ(41,"mat-label"),l._uU(42),l.qZA(),l.TgZ(43,"input",26,27),l.NdJ("keyup",function(t){return l.CHM(e),l.oxw().getValueCustomer(t.target.value)}),l.qZA(),l.TgZ(45,"mat-autocomplete",28,29),l.NdJ("optionSelected",function(t){return l.CHM(e),l.oxw().getValueCustomer(t.option.value)}),l.YNc(47,N,2,2,"mat-option",24),l.qZA(),l.qZA(),l.qZA(),l.TgZ(48,"div",30),l.YNc(49,E,5,4,"div",31),l.YNc(50,Q,5,4,"div",31),l.qZA(),l.YNc(51,L,3,0,"div",32),l.YNc(52,j,3,1,"div",33),l.YNc(53,H,3,0,"div",32),l.TgZ(54,"div",10),l.TgZ(55,"mat-form-field",34),l.TgZ(56,"mat-label"),l._uU(57),l.qZA(),l.TgZ(58,"input",35),l.NdJ("input",function(t){return l.CHM(e),l.oxw().numberFormatCost.setValue(t.target.value)})("blur",function(){return l.CHM(e),l.oxw().valueCheckBlur()})("keypress",function(t){return l.CHM(e),l.oxw().validateNo(t)}),l.qZA(),l.YNc(59,$,2,0,"mat-error",36),l.TgZ(60,"mat-error"),l._uU(61," Vui l\xf2ng nh\u1eadn s\u1ed1 "),l.qZA(),l.qZA(),l.YNc(62,W,8,4,"mat-form-field",37),l.qZA(),l.TgZ(63,"div",30),l.TgZ(64,"mat-form-field",38),l.TgZ(65,"mat-label"),l._uU(66),l.qZA(),l._UZ(67,"input",39),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.TgZ(68,"div",40),l.TgZ(69,"button",41),l.NdJ("click",function(){return l.CHM(e),l.oxw().save()}),l.TgZ(70,"span"),l._uU(71),l.qZA(),l.qZA(),l.TgZ(72,"button",42),l.TgZ(73,"span"),l._uU(74),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.BQk()}if(2&e){const e=t.$implicit,i=l.MAs(19),r=l.MAs(46),a=l.oxw();l.xp6(4),l.Oqu(e("TITLE")),l.xp6(1),l.Q6J("tabIndex",-1),l.xp6(1),l.Q6J("svgIcon","heroicons_outline:x"),l.xp6(1),l.Q6J("formGroup",a.addForm),l.xp6(2),l.Q6J("ngIf",a.savingFlag.pending),l.xp6(4),l.Q6J("hideRequiredMarker",!0),l.xp6(2),l.Oqu(e("DATE")),l.xp6(1),l.Q6J("matDatepicker",i)("placeholder",e("DATE"))("max",a.maxDate.format("YYYY-MM-DD"))("min",a.minDate.format("YYYY-MM-DD")),l.xp6(1),l.Q6J("for",i),l.xp6(3),l.Q6J("hideRequiredMarker",!0),l.xp6(2),l.Oqu(e("RECORD_TYPE")),l.xp6(1),l.Q6J("placeholder",e("TYPE")),l.xp6(2),l.hij("",e("INCOME")," "),l.xp6(2),l.hij("",e("EXPENSE")," "),l.xp6(4),l.AsE("",e("POND")," / ",e("FARM")," "),l.xp6(1),l.Q6J("placeholder",e("TYPE")),l.xp6(2),l.hij("",e("FARM")," "),l.xp6(5),l.Q6J("ngForOf",a.listPonds),l.xp6(3),l.Oqu(e("CUSTOMER")),l.xp6(1),l.Q6J("placeholder",e("CUSTOMER"))("matAutocomplete",r),l.xp6(4),l.Q6J("ngForOf",a.listCustomer),l.xp6(2),l.Q6J("ngIf","out"==a.addForm.controls.type.value),l.xp6(1),l.Q6J("ngIf","in"==a.addForm.controls.type.value),l.xp6(1),l.Q6J("ngIf","all_area"==a.addForm.value.typeAdd),l.xp6(1),l.Q6J("ngIf",a.pondSeleted.length>0),l.xp6(1),l.Q6J("ngIf","all_same"==a.addForm.value.typeAdd),l.xp6(4),l.Oqu(e("AMOUNT")),l.xp6(1),l.Q6J("placeholder",e("AMOUNT"))("value",a.numberFormatCost.fakeView),l.xp6(1),l.Q6J("ngIf",a.addForm.get("amounts").value<0),l.xp6(3),l.Q6J("ngIf","out"==a.addForm.controls.type.value),l.xp6(4),l.Oqu(e("NOTE")),l.xp6(1),l.Q6J("placeholder",e("NOTE")),l.xp6(2),l.Q6J("color","primary")("disabled",!a.addForm.valid||a.numberFormatCost.realValue<a.numberFormatCostNumber.realValue),l.xp6(2),l.hij(" ",e("SAVE")," "),l.xp6(1),l.Q6J("color","secondary"),l.xp6(2),l.hij(" ",e("CANCEL")," ")}}let K=(()=>{class e{constructor(e,t,i,a,l,c,d){this.data=e,this.dialogRef=t,this.farmService=i,this._alertService=a,this._translateService=l,this._moneyService=c,this._farmService=d,this.maxDate=s(),this.minDate=s().subtract(180,"days"),this.numberFormatCost=new o.y(""),this.numberFormatCostNumber=new o.y(""),this.listCategory=[],this.savingFlag=new n.E,this.pondSeleted=[],this.pondSelectedPonds=[],this.isFalshy=!1,this.addForm=new r.cw({type:new r.NI("out",r.kI.required),typeAdd:new r.NI("farm",r.kI.required),title:new r.NI("",r.kI.required),today:new r.NI(s().format("YYYY-MM-DD"),r.kI.required),amounts:new r.NI("",[r.kI.required,r.kI.min(0)]),amounts_payed:new r.NI("",[r.kI.required,r.kI.min(0)]),group_id:new r.NI("",r.kI.required),title_customer:new r.NI(""),content_group:new r.NI("")})}ngOnInit(){console.log("fcode",this._farmService.fcode),this._moneyService.setCode(this._farmService.fcode),this.pondSeleted=[{name:this._translateService.translate("SEASON.LIST.COST")+" "+this._translateService.translate("SEASON.DETAIL_MOD.FARM"),code:"",type:"farm"}],this.getListPond(),this.getDataForListCategory(),console.log(this.data)}validateNo(e){const t=e.which?e.which:e.keyCode;return!(t>31&&(t<48||t>57))}getDataForListCategory(){this._moneyService.fetchFinanceListCategory(this._farmService.fcode).pipe().subscribe(e=>{0==e.status?this._alertService.error(e.error):(this.listCategory=e.data,console.log(this.listCategory))},e=>{this._alertService.error(this._translateService.translate("CONNECT_ERROR")),this.dialogRef.close()})}getListPond(){this.farmService.loadPonds().pipe().subscribe(e=>{0==e.status?this._alertService.error(e.error):this.listPonds=e.data},e=>{this._alertService.error(this._translateService.translate("CONNECT_ERROR")),this.dialogRef.close()})}valueCheckBlur(e){this.addForm.patchValue({amounts_payed:this.numberFormatCost.fakeView})}getValueCustomer(e){console.log(e);let t={name:e,type:this.addForm.value.type};console.log(t),""!==e&&this._moneyService.searchCustomers(t).pipe().subscribe(e=>{0==e.status?this._alertService.error(e.error):this.listCustomer=e.data},e=>{this._alertService.error(this._translateService.translate("CONNECT_ERROR"))})}save(){this.savingFlag.setPending(!0);let e={type:this.addForm.value.type,typeAdd:this.addForm.value.typeAdd,ponds:this.pondSeleted.map(e=>e.code),title:this.addForm.value.title,amounts:this.numberFormatCost.realValue,amounts_payed:this.numberFormatCostNumber.realValue,today:s(this.addForm.value.today).unix(),fcode:this.farmService.fcode,accounting_by:"all_area"==this.addForm.value.typeAdd?"area":"all_same"==this.addForm.value.typeAdd?"same":"farm"==this.addForm.value.typeAdd?"":this.addForm.value.typeAdd,group_id:this.addForm.value.group_id,customer_name:this.addForm.value.title_customer,content_group:this.addForm.value.content_group};console.log("\ud83d\ude80\ud83d\ude80\ud83c\udf89 >>> paramAdd",e),this.addForm.valid&&this._moneyService.createRecord(e).pipe().subscribe(t=>{0==t.status?this._alertService.error(t.error):(console.log(e),console.log(t),this.dialogRef.close(e)),this.savingFlag.setResult(!0)},e=>{this._alertService.error(this._translateService.translate("CONNECT_ERROR")),this.savingFlag.setResult(!1)})}saveGroup(){if(""!=this.addForm.value.content_group){this.savingFlag.setPending(!0);let e={name:this.addForm.value.content_group,type:this.addForm.value.type};console.log(e),this._moneyService.addGroups(e).pipe().subscribe(t=>{if(0==t.status){this._alertService.success("\u0110\xe3 c\xf3 s\u1eb5n kh\xf4ng th\u1ec3 th\xeam, \u0111\xe3 ch\u1ecdn gi\xfap b\u1ea1n!!"),this.isFalshy=!1;let t=this.listCategory,r=[];for(var i in t)r.push(t[i]);const a=r.filter(t=>e.name==t.name&&e.type==t.type);this.addForm.patchValue({group_id:a[0].id})}else this.getDataForListCategory(),setTimeout(()=>{let t=this.listCategory,i=[];for(var r in t)i.push(t[r]);const a=i.filter(t=>e.name==t.name&&e.type==t.type);this.addForm.patchValue({group_id:a[0].id}),this.isFalshy=!1},1e3);this.savingFlag.setResult(!0)},e=>{this._alertService.error(this._translateService.translate("CONNECT_ERROR")),this.savingFlag.setResult(!1)})}}chooseType(e){console.log(e.value),"farm"==e.value?this.pondSeleted=[{name:this._translateService.translate("SEASON.LIST.COST")+" "+this._translateService.translate("SEASON.DETAIL_MOD.FARM"),code:"",type:"farm"}]:"all_area"==e.value?this.pondSeleted=this.listPonds.reduce((e,t)=>(t.area>0&&e.push({name:t.name,code:t.code,type:"all_area"}),e),[]):"all_same"==e.value?this.pondSeleted=this.listPonds.reduce((e,t)=>(t.area>0&&e.push({name:t.name,code:t.code,type:"all_same"}),e),[]):(this.pondSeleted.findIndex(e=>"all_area"==e.type||"farm"==e.type||"all_same"==e.type)>=0&&(this.pondSeleted=[]),this.pondSeleted.push(this.listPonds[this.listPonds.findIndex(t=>t.code===e.value)]),this.pondSeleted=this.pondSeleted.filter((e,t,i)=>i.indexOf(e)==t))}removePond(e){this.pondSeleted.length>1&&this.pondSeleted.splice(e,1)}}return e.\u0275fac=function(t){return new(t||e)(l.Y36(a.WI),l.Y36(a.so),l.Y36(c.D),l.Y36(d.c),l.Y36(m.Vn),l.Y36(u.r),l.Y36(c.D))},e.\u0275cmp=l.Xpm({type:e,selectors:[["app-finance-add"]],decls:1,vars:1,consts:[[4,"transloco","translocoRead"],[1,"flex","flex-col","max-w-240","md:min-w-160","-m-6","max-h-screen","-m-6"],[1,"flex","flex-0","items-center","justify-between","h-16","pr-3","sm:pr-5","pl-6","sm:pl-8","bg-primary","text-on-primary"],[1,"text-lg","font-medium"],["mat-icon-button","","mat-dialog-close","",3,"tabIndex"],[1,"text-current",3,"svgIcon"],[1,"flex","flex-col","flex-auto","p-6","sm:p-8","overflow-y-auto",3,"formGroup"],[3,"mode",4,"ngIf"],[1,"w-full"],[1,"flex","flex-col","w-full"],[1,"flex","justify-between"],[1,"flex-auto","mr-2",3,"hideRequiredMarker"],["matInput","","formControlName","today","required","",3,"matDatepicker","placeholder","max","min","click"],["matSuffix","",3,"for"],["picker",""],[1,"flex-auto","ml-2",3,"hideRequiredMarker"],["formControlName","type",3,"placeholder"],["value","in"],["value","out"],[1,"flex-auto","mr-2",2,"width","150px"],["formControlName","typeAdd",3,"placeholder","selectionChange"],["value","farm"],["value","all_area"],["value","all_same"],[3,"value",4,"ngFor","ngForOf"],[1,"flex-auto","ml-2"],["matInput","","formControlName","title_customer",3,"placeholder","matAutocomplete","keyup"],["ip",""],[3,"optionSelected"],["auto","matAutocomplete"],[1,"flex"],["class","flex w-full",4,"ngIf"],["class","flex",4,"ngIf"],["class","flex mb-1",4,"ngIf"],[1,"flex-auto","mr-2"],["matInput","","formControlName","amounts","required","",3,"placeholder","value","input","blur","keypress"],[4,"ngIf"],["class","flex-auto ml-2",4,"ngIf"],[1,"flex-auto"],["matInput","","formControlName","title",3,"placeholder"],[1,"flex","flex-0","items-center","justify-end","h-16","pr-3","sm:pr-5","pl-6","sm:pl-8"],["mat-flat-button","",1,"fuse-mat-button","mr-3",3,"color","disabled","click"],["mat-stroked-button","","mat-dialog-close","",1,"fuse-mat-button",3,"color"],[3,"mode"],[3,"value"],[1,"flex","w-full"],["class","example-full-width w-full","appearance","fill",4,"ngIf"],["class"," flex-auto",4,"ngIf"],["class","cursor-pointer h-full text-blue-700","svgIcon","mat_outline:add_circle_outline",3,"click",4,"ngIf"],["class","cursor-pointer h-full text-blue-700","svgIcon","mat_outline:close",3,"click",4,"ngIf"],["appearance","fill",1,"example-full-width","w-full"],["placeholder","Th\xeam nh\xf3m","matInput","","formControlName","content_group",3,"focusout"],[3,"click"],["formControlName","group_id",3,"placeholder"],[4,"ngFor","ngForOf"],[3,"value",4,"ngIf"],["svgIcon","mat_outline:add_circle_outline",1,"cursor-pointer","h-full","text-blue-700",3,"click"],["svgIcon","mat_outline:close",1,"cursor-pointer","h-full","text-blue-700",3,"click"],["class","flex-auto",4,"ngIf"],["matInput","","placeholder","Th\xeam nh\xf3m","formControlName","content_group",3,"blur"],[1,"text-green-400"],[1,"flex","mb-1"],["aria-label","Pond selection"],["color","success",3,"click",4,"ngFor","ngForOf"],["color","success",3,"click"],["class","ml-1",4,"ngIf"],[1,"ml-1"],["matInput","","formControlName","amounts_payed","required","",3,"placeholder","value","input","keypress"],[1,"text-red-500"]],template:function(e,t){1&e&&l.YNc(0,V,75,43,"ng-container",0),2&e&&l.Q6J("translocoRead","FARM.ADD")},directives:[m.KI,p.lW,a.ZT,f.Hw,r.JL,r.sg,g.O5,h.KE,h.hX,Z.Nt,r.Fj,v.hl,r.JJ,r.u,r.Q7,v.nW,h.R9,v.Mq,_.gD,x.ey,g.sg,A.ZL,A.XC,h.TO,T.pW,q.qn,q.HS,h.bx],pipes:[g.Nd],styles:[".transform[_ngcontent-%COMP%]{transform:rotate(45deg)}"]}),e})()},32705:(e,t,i)=>{"use strict";i.d(t,{r:()=>n});var r=i(88002),a=i(37716),o=i(95352);let n=(()=>{class e{constructor(e){this.reqAPIService=e,this.urlApiFinance="/manager/finance-api"}setCode(e){this.fcode=e}loadMoney(){return this.reqAPIService.get(this.urlApiFinance+"?fcode="+this.fcode+"&action=list").pipe((0,r.U)(e=>e))}getMoneyList(e,t=0){return this.reqAPIService.get(this.urlApiFinance+"?fcode="+e+"&action=list&page="+(t+1)).pipe((0,r.U)(e=>e))}getMoneySearch(e,t){return this.reqAPIService.get(this.urlApiFinance+"?fcode="+e+"&action=search"+t)}search(e){return this.reqAPIService.get(this.urlApiFinance+"?fcode="+this.fcode+"&action=search&keyword="+e.keyword+"&type="+e.type+"&timeFrom="+e.timeFrom+"&timeTo="+e.timeTo+"&page=0&numRow=20").pipe((0,r.U)(e=>e))}add(e){return this.reqAPIService.post(this.urlApiFinance+"?fcode="+this.fcode+"&action=add",e)}edit(e){return this.reqAPIService.post(this.urlApiFinance+"?fcode="+this.fcode+"&action=edit&item="+e.id+"&cr="+e.type,e)}delete(e){return this.reqAPIService.get(this.urlApiFinance+"?fcode="+this.fcode+"&action=detele&item="+e.item+"&cr="+e.cr)}getGroup(e,t){return this.reqAPIService.get(this.urlApiFinance+"?fcode="+this.fcode+"&action=getItemByCode&code="+e+"&cr="+t)}editGroup(e){return this.reqAPIService.post(this.urlApiFinance+"?fcode="+this.fcode+"&action=editTypeAll&item="+e.id+"&cr="+e.type,e)}fetchUpdateFund(e){return this.reqAPIService.post(this.urlApiFinance+"?fcode="+this.fcode+"&action=updateFund&value="+e,e).pipe((0,r.U)(e=>e))}fetchFinanceListCategory(e){return this.reqAPIService.get(this.urlApiFinance+"?fcode="+e+"&action=listCategory").pipe((0,r.U)(e=>e))}removeRecord(e){return this.reqAPIService.get(this.urlApiFinance+"?fcode="+this.fcode+"&action=detele&item="+e.item+"&cr="+e.cr)}updateConfirmRecord(e,t,i,a){return this.reqAPIService.post(this.urlApiFinance+"?action=confirm&ccode="+e+"&cr="+t+"&id="+i+"&confirm="+a,i).pipe((0,r.U)(e=>e))}createRecord(e){return this.reqAPIService.post(this.urlApiFinance+"?fcode="+this.fcode+"&action=add",e)}addGroups(e){return this.reqAPIService.post(this.urlApiFinance+"?fcode="+this.fcode+"&action=addCategory",e)}getDebtCustomers(e){return this.reqAPIService.post(this.urlApiFinance+"?fcode="+this.fcode+"&action=getDebtCustomer&customer_slug="+e,"")}getACustomer(e){return this.reqAPIService.post(this.urlApiFinance+"?fcode="+this.fcode+"&action=getACustomer&customer_slug="+e,"")}searchCustomers(e){return this.reqAPIService.post(this.urlApiFinance+"?fcode="+this.fcode+"&action=searchCustomer",e)}addMultiDebt(e){return this.reqAPIService.post(this.urlApiFinance+"?fcode="+this.fcode+"&action=addMultiDebt",e)}getCustomers(){return this.reqAPIService.post(this.urlApiFinance+"?fcode="+this.fcode+"&action=getCustomers","")}updateRecord(e,t,i){return this.reqAPIService.post(this.urlApiFinance+"?fcode="+this.fcode+"&action=edit&item="+e+"&cr="+t,i)}getAnalyst(){return this.reqAPIService.get(this.urlApiFinance+"?fcode="+this.fcode+"&action=analyst")}searchAnalyst(e){return this.reqAPIService.post(this.urlApiFinance+"?fcode="+this.fcode+"&action=analyst",e)}dowloadFileFundReport(e,t){return this.reqAPIService.downloadFile("/manager/export-report-farm-api?action=fund&fcode="+this.fcode+"&from="+e+"&end="+t).pipe()}dowloadFileCostReport(e,t){return this.reqAPIService.downloadFile("/manager/export-report-farm-api?action=pond-cost&fcode="+this.fcode+"&timeFrom="+e+"&timeEnd="+t).pipe()}dowloadFileCostBill(e,t){return this.reqAPIService.downloadFile("/manager/export-report-farm-api?action=getBill&fcode="+this.fcode+"&id="+e+"&type="+t).pipe()}}return e.\u0275fac=function(t){return new(t||e)(a.LFG(o.$))},e.\u0275prov=a.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()}}]);