(self.webpackChunk_fuse_demo=self.webpackChunk_fuse_demo||[]).push([[475],{51475:(t,e,i)=>{"use strict";i.r(e),i.d(e,{FinanceModule:()=>Ne});var a=i(38583),o=i(82808),n=i(8394),s=i(44466),r=i(4083),l=i(84900),c=i(95987),d=i(3679),m=i(5396),u=i(16738),p=i.n(u),g=i(37716),h=i(32705),f=i(76891),Z=i(40704),x=i(90171),_=i(76627),v=i(98295),b=i(49983),T=i(43220),A=i(51095),y=i(93104),q=i(12178);const F=["paginator"];function C(t,e){1&t&&g._UZ(0,"mat-progress-bar",31),2&t&&g.Q6J("mode","indeterminate")}function w(t,e){1&t&&g._UZ(0,"mat-progress-bar",31),2&t&&g.Q6J("mode","indeterminate")}function N(t,e){1&t&&g._UZ(0,"mat-progress-bar",31),2&t&&g.Q6J("mode","indeterminate")}const D=function(t,e){return{"text-green-500":t,"text-red-500":e}};let S=(()=>{class t{constructor(t,e,i,a,o){this._moneyService=t,this._farmService=e,this._alertService=i,this._translateService=a,this._formBuilder=o,this.isFiltered=!1,this.panelOpenState=!1,this.loadingFlag=new m.E,this.step=0,this.analystList=[],this.dataAnalystFund=[],this.startDate=new Date,this.date180DaysAgo=new Date((new Date).getFullYear(),(new Date).getMonth(),1),this.maxDateFrom=p()(),this.minDate=p()().subtract(10,"days"),this.maxDate=p()(),this.chartOptionTotalIn={},this.chartOptionTotalOut={},this.moneyFilteredList=[],this.totalList=[],this.totalLength=0}ngOnInit(){this._moneyService.setCode(this._farmService.fcode),this.getDataForListAnalyst(),this.buildForm(),setTimeout(()=>{this.onFilter()},1e3)}setStep(t){this.step=t}nextStep(){this.step++}prevStep(){this.step--}getDataForListAnalyst(){this._moneyService.getAnalyst().subscribe(t=>{if(1==t.status){this.analystList=t.data,this.totalFunds=this.analystList.total_in-this.analystList.total_out;let e=[];this.analystList.in.forEach(t=>{null==t.name&&(t.name="chung"),e.push(t)});const i=e.map(t=>({value:t.total,name:t.name}));let a=[];this.analystList.out.forEach(t=>{null==t.name&&(t.name="chung"),a.push(t)});const o=a.map(t=>({value:t.total,name:t.name}));this.chartOptionTotalIn={tooltip:{trigger:"item"},legend:{top:"bottom"},color:["#5470c6","#91cc75","#fac858","#ee6666","#73c0de","#3ba272","#fc8452","#9a60b4","#ea7ccc"],series:[{name:"T\u1ed5ng Thu",type:"pie",radius:[40,140],center:["50%","50%"],roseType:"area",itemStyle:{borderRadius:20},data:i}]},this.chartOptionTotalOut={tooltip:{trigger:"item"},legend:{top:"bottom"},color:["#5470c6","#91cc75","#fac858","#ee6666","#73c0de","#3ba272","#fc8452","#9a60b4","#ea7ccc"],series:[{name:"T\u1ed5ng Chi",type:"pie",radius:[40,140],center:["50%","50%"],roseType:"area",itemStyle:{borderRadius:8},data:o}]}}else this._alertService.error(t.error)},()=>{this._alertService.error(this._translateService.translate("CONNECT_ERROR"))})}buildForm(){this.analystListSearchForm=this._formBuilder.group({timeFrom:["",d.kI.required],timeEnd:[new Date,d.kI.required]})}onPage(t){this.isFiltered?this.onFilter():this.getDataForListAnalyst()}applyFilter(){this.onFilter()}onFilter(){this.loadingFlag.setPending(!0);let t={timeFrom:p()(this.analystListSearchForm.value.timeFrom).unix(),timeEnd:p()(this.analystListSearchForm.value.timeEnd).unix()};console.log("params",t),this._moneyService.searchAnalyst(t).pipe().subscribe(t=>{if(t.data&&0!=t.status){this.analystList=t.data,this.dataAnalystFund=t.data.fund;const e=this.analystList.fund.total_in-this.analystList.fund.total_out,i=this.analystList.total_in-this.analystList.total_out+e;this.head_surplus=e,this.totalFunds=i;let a=[];const o={Chung:0};this.analystList.in.forEach(t=>{null==t.name?(t.name="chung",o.Chung+=Number(t.total)):o[t.name]=t.total,a.push(t)});const n=a.map(t=>({value:t.total,name:t.name}));let s=[];this.analystList.out.forEach(t=>{null==t.name&&(t.name="chung"),s.push(t)});const r=s.map(t=>({value:t.total,name:t.name}));this.chartOptionTotalIn={tooltip:{trigger:"item"},legend:{top:"bottom"},color:["#5470c6","#91cc75","#fac858","#ee6666","#73c0de","#3ba272","#fc8452","#9a60b4","#ea7ccc"],series:[{name:"T\u1ed5ng Thu",type:"pie",radius:[40,140],center:["50%","50%"],roseType:"area",itemStyle:{borderRadius:20},data:n}]},this.chartOptionTotalOut={tooltip:{trigger:"item"},color:["#5470c6","#91cc75","#fac858","#ee6666","#73c0de","#3ba272","#fc8452","#9a60b4","#ea7ccc"],series:[{name:"T\u1ed5ng Chi",type:"pie",radius:[40,140],center:["50%","50%"],roseType:"area",itemStyle:{borderRadius:8},data:r}]}}else this.getDataForListAnalyst();this.loadingFlag.setResult(!0)},()=>{this.loadingFlag.setResult(!1),this._alertService.error(this._translateService.translate("CONNECT_ERROR"))})}clearFilter(){this.isFiltered&&(this.analystListSearchForm.reset(),this.paginator.firstPage())}}return t.\u0275fac=function(e){return new(e||t)(g.Y36(h.r),g.Y36(f.D),g.Y36(Z.c),g.Y36(n.Vn),g.Y36(d.qu))},t.\u0275cmp=g.Xpm({type:t,selectors:[["app-finance-analyst"]],viewQuery:function(t,e){if(1&t&&g.Gf(F,5),2&t){let t;g.iGM(t=g.CRH())&&(e.paginator=t.first)}},decls:119,vars:71,consts:[[1,"w-full"],[1,"example-headers-align"],[3,"mode",4,"ngIf"],["hideToggle","",3,"expanded","opened"],[1,"flex","items-center",3,"formGroup"],[1,"flex-auto","mr-4",3,"hideRequiredMarker"],["matInput","","formControlName","timeFrom","required","",3,"matDatepicker","placeholder","max","ngModel","click","ngModelChange"],["matSuffix","",3,"for"],["fromDate",""],["matInput","","formControlName","timeEnd","required","",3,"matDatepicker","placeholder","max","click"],["toDate",""],["mat-flat-button","",1,"fuse-mat-button","mr-4",3,"color","disabled","click"],[1,"mr-2"],[3,"svgIcon"],["mat-button","","color","primary",3,"click"],[1,"flex","flex-col","px-8","py-6","pb-3","mb-5","bg-card","overflow-hidden","w-7/12","justify-items-center","m-auto"],[1,"flex","flex-row","justify-between"],[1,"flex","flex-col","py-3"],[1,"text-base"],[1,"text-base","font-medium","py-3",3,"ngClass"],["mat-button","","color","warn",3,"click"],[1,"text-base","font-medium","py-3","text-secondary",3,"ngClass"],[1,"flex","flex-col","py-3","font-bold"],[1,"dashed","mt-3"],[1,"flex","flex-col","font-bold"],[1,"text-base","font-medium","text-secondary",3,"ngClass"],[1,"grid","grid-cols-1","sm:grid-cols-2","pt-5"],[1,"md:p-2","sm:p-0","boxCardSmal"],[1,"flex","flex-col","px-8","py-6","mb-3","bg-card","shadow","rounded-2xl","overflow-hidden","w-full","h-full"],[1,"text-lg","font-medium","mb-6"],["echarts","",3,"options"],[3,"mode"]],template:function(t,e){if(1&t){const t=g.EpF();g.ynx(0),g.TgZ(1,"div",0),g.TgZ(2,"mat-accordion",1),g.TgZ(3,"div"),g.YNc(4,C,1,1,"mat-progress-bar",2),g.qZA(),g.TgZ(5,"mat-expansion-panel",3),g.NdJ("opened",function(){return e.setStep(0)}),g.TgZ(6,"mat-expansion-panel-header"),g.TgZ(7,"mat-panel-title"),g._uU(8," L\u1ecdc "),g.qZA(),g.TgZ(9,"mat-panel-description"),g._uU(10," L\u1ecdc theo th\xe1ng "),g.TgZ(11,"mat-icon"),g._uU(12,"search"),g.qZA(),g.qZA(),g.qZA(),g.TgZ(13,"div",4),g.TgZ(14,"mat-form-field",5),g.TgZ(15,"mat-label"),g._uU(16,"T\u1eeb"),g.qZA(),g.TgZ(17,"input",6),g.NdJ("click",function(){return g.CHM(t),g.MAs(20).open()})("ngModelChange",function(t){return e.date180DaysAgo=t}),g.qZA(),g._UZ(18,"mat-datepicker-toggle",7),g._UZ(19,"mat-datepicker",null,8),g.qZA(),g.TgZ(21,"mat-form-field",5),g.TgZ(22,"mat-label"),g._uU(23,"T\u1edbi"),g.qZA(),g.TgZ(24,"input",9),g.NdJ("click",function(){return g.CHM(t),g.MAs(27).open()}),g.qZA(),g._UZ(25,"mat-datepicker-toggle",7),g._UZ(26,"mat-datepicker",null,10),g.qZA(),g.TgZ(28,"button",11),g.NdJ("click",function(){return e.applyFilter()}),g.TgZ(29,"span",12),g._uU(30,"L\u1ecdc"),g.qZA(),g._UZ(31,"mat-icon",13),g.qZA(),g.qZA(),g.TgZ(32,"mat-action-row"),g.TgZ(33,"button",14),g.NdJ("click",function(){return e.nextStep()}),g._uU(34,"Next"),g.qZA(),g.qZA(),g.qZA(),g.TgZ(35,"div"),g.YNc(36,w,1,1,"mat-progress-bar",2),g.qZA(),g.TgZ(37,"mat-expansion-panel",3),g.NdJ("opened",function(){return e.setStep(1)}),g.TgZ(38,"mat-expansion-panel-header"),g.TgZ(39,"mat-panel-title"),g._uU(40," \u0110\u1ea7u k\xec "),g.qZA(),g.TgZ(41,"mat-panel-description"),g._uU(42," S\u1ed1 d\u01b0 th\xe1ng tr\u01b0\u1edbc "),g.TgZ(43,"mat-icon"),g._uU(44,"paidicon"),g.qZA(),g.qZA(),g.qZA(),g.TgZ(45,"div",15),g.TgZ(46,"div",16),g.TgZ(47,"div",17),g.TgZ(48,"div",18),g._uU(49,"T\u1ed5ng Thu:"),g.qZA(),g.qZA(),g.TgZ(50,"div",19),g._uU(51),g.ALo(52,"number"),g.qZA(),g.qZA(),g.qZA(),g.TgZ(53,"mat-action-row"),g.TgZ(54,"button",20),g.NdJ("click",function(){return e.prevStep()}),g._uU(55,"Previous"),g.qZA(),g.TgZ(56,"button",14),g.NdJ("click",function(){return e.nextStep()}),g._uU(57,"Next"),g.qZA(),g.qZA(),g.qZA(),g.TgZ(58,"div"),g.YNc(59,N,1,1,"mat-progress-bar",2),g.qZA(),g.TgZ(60,"mat-expansion-panel",3),g.NdJ("opened",function(){return e.setStep(2)}),g.TgZ(61,"mat-expansion-panel-header"),g.TgZ(62,"mat-panel-title"),g._uU(63," Ng\xe0y cu\u1ed1i "),g.qZA(),g.TgZ(64,"mat-panel-description"),g._uU(65," T\u1ed3n qu\u1ef9 "),g.TgZ(66,"mat-icon"),g._uU(67,"paidicon"),g.qZA(),g.qZA(),g.qZA(),g.TgZ(68,"div",15),g.TgZ(69,"div",16),g.TgZ(70,"div",17),g.TgZ(71,"div",18),g._uU(72,"T\u1ed5ng Thu:"),g.qZA(),g.qZA(),g.TgZ(73,"div",19),g._uU(74),g.ALo(75,"number"),g.qZA(),g.qZA(),g.TgZ(76,"div",16),g.TgZ(77,"div",17),g.TgZ(78,"div",18),g._uU(79,"T\u1ed5ng chi: "),g.qZA(),g.qZA(),g.TgZ(80,"div",21),g._uU(81),g.ALo(82,"number"),g.qZA(),g.qZA(),g.TgZ(83,"div",16),g.TgZ(84,"div",17),g.TgZ(85,"div",18),g._uU(86,"T\u1ed5ng n\u1ee3: "),g.qZA(),g.qZA(),g.TgZ(87,"div",21),g._uU(88),g.ALo(89,"number"),g.qZA(),g.qZA(),g.TgZ(90,"div",16),g.TgZ(91,"div",22),g._uU(92," N\u1ee3 \u0111\xe3 tr\u1ea3 : "),g.qZA(),g.TgZ(93,"div",21),g._uU(94),g.ALo(95,"number"),g.qZA(),g.qZA(),g._UZ(96,"hr",23),g.TgZ(97,"div",16),g.TgZ(98,"div",24),g._uU(99," T\u1ed3n Qu\u1ef9 : "),g.qZA(),g.TgZ(100,"div",25),g._uU(101),g.ALo(102,"number"),g.qZA(),g.qZA(),g.qZA(),g.TgZ(103,"mat-action-row"),g.TgZ(104,"button",20),g.NdJ("click",function(){return e.prevStep()}),g._uU(105,"Previous"),g.qZA(),g.TgZ(106,"button",14),g.NdJ("click",function(){return e.nextStep()}),g._uU(107,"End"),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.TgZ(108,"div",26),g.TgZ(109,"div",27),g.TgZ(110,"div",28),g.TgZ(111,"p",29),g._uU(112,"T\u1ed5ng Thu"),g.qZA(),g._UZ(113,"div",30),g.qZA(),g.qZA(),g.TgZ(114,"div",27),g.TgZ(115,"div",28),g.TgZ(116,"p",29),g._uU(117,"T\u1ed5ng Chi"),g.qZA(),g._UZ(118,"div",30),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.BQk()}if(2&t){const t=g.MAs(20),i=g.MAs(27);g.xp6(4),g.Q6J("ngIf",e.loadingFlag.pending),g.xp6(1),g.Q6J("expanded",0===e.step),g.xp6(8),g.Q6J("formGroup",e.analystListSearchForm),g.xp6(1),g.Q6J("hideRequiredMarker",!0),g.xp6(3),g.Q6J("matDatepicker",t)("placeholder","t\u1eeb")("max",e.maxDateFrom.format("YYYY-MM-DD"))("ngModel",e.date180DaysAgo),g.xp6(1),g.Q6J("for",t),g.xp6(3),g.Q6J("hideRequiredMarker",!0),g.xp6(3),g.Q6J("matDatepicker",i)("placeholder","T\u1edbi")("max",e.maxDate.format("YYYY-MM-DD")),g.xp6(1),g.Q6J("for",i),g.xp6(3),g.Q6J("color","primary")("disabled",e.analystListSearchForm.invalid),g.xp6(3),g.Q6J("svgIcon","heroicons_outline:filter"),g.xp6(5),g.Q6J("ngIf",e.loadingFlag.pending),g.xp6(1),g.Q6J("expanded",1===e.step),g.xp6(13),g.Q6J("ngClass",g.WLB(53,D,e.head_surplus>0,e.head_surplus<0)),g.xp6(1),g.hij(" + ",g.xi3(52,35,e.head_surplus,"0.0-0")," \u0111 "),g.xp6(8),g.Q6J("ngIf",e.loadingFlag.pending),g.xp6(1),g.Q6J("expanded",2===e.step),g.xp6(13),g.Q6J("ngClass",g.WLB(56,D,e.analystList.total_in>0,e.analystList.total_in<0)),g.xp6(1),g.hij(" ",g.xi3(75,38,e.analystList.total_in,"0.0-0")," \u0111 "),g.xp6(6),g.Q6J("ngClass",g.WLB(59,D,e.analystList.total_out>0,e.analystList.total_out<0)),g.xp6(1),g.hij(" ",g.xi3(82,41,e.analystList.total_out,"0.0-0")," \u0111 "),g.xp6(6),g.Q6J("ngClass",g.WLB(62,D,e.analystList.debt>0,e.analystList.debt<0)),g.xp6(1),g.hij(" ",g.xi3(89,44,e.analystList.debt,"0.0-0")," \u0111 "),g.xp6(5),g.Q6J("ngClass",g.WLB(65,D,e.analystList.debt_payed>0,e.analystList.debt_payed<0)),g.xp6(1),g.hij(" ",g.xi3(95,47,e.analystList.debt_payed,"0.0-0")," \u0111 "),g.xp6(6),g.Q6J("ngClass",g.WLB(68,D,e.totalFunds+e.dataAnalystFund.total_in>0,e.totalFunds+e.dataAnalystFund.total_in<0)),g.xp6(1),g.hij(" ",g.xi3(102,50,e.totalFunds,"0.0-0")," \u0111 "),g.xp6(12),g.Q6J("options",e.chartOptionTotalIn),g.xp6(5),g.Q6J("options",e.chartOptionTotalOut)}},directives:[x.pp,a.O5,x.ib,x.yz,x.yK,x.u4,_.Hw,d.JL,d.sg,v.KE,v.hX,b.Nt,d.Fj,T.hl,d.JJ,d.u,d.Q7,T.nW,v.R9,T.Mq,A.lW,x.VG,a.mk,y.w,q.pW],pipes:[a.JJ],styles:[".example-headers-align[_ngcontent-%COMP%]   .mat-expansion-panel-header-description[_ngcontent-%COMP%], .example-headers-align[_ngcontent-%COMP%]   .mat-expansion-panel-header-title[_ngcontent-%COMP%]{flex-basis:0}.example-headers-align[_ngcontent-%COMP%]   .mat-expansion-panel-header-description[_ngcontent-%COMP%]{justify-content:space-between;align-items:center}.example-headers-align[_ngcontent-%COMP%]   .mat-form-field[_ngcontent-%COMP%] + .mat-form-field[_ngcontent-%COMP%]{margin-left:8px}.boxCardSmal[_ngcontent-%COMP%]{padding-top:15px}.dashed[_ngcontent-%COMP%]{border-top:1px dashed;border-bottom-width:0}"]}),t})();var J=i(22238),I=i(7539);function O(t,e){if(1&t&&(g.TgZ(0,"div",12),g._uU(1),g.qZA()),2&t){const t=g.oxw().$implicit;g.xp6(1),g.hij(" ",t("RECORD_TYPE")," ")}}function U(t,e){1&t&&g._UZ(0,"div",12)}function Q(t,e){if(1&t&&(g.TgZ(0,"div",12),g._uU(1),g.qZA()),2&t){const t=g.oxw().$implicit;g.xp6(1),g.hij(" ",t("DEBT")," ")}}function M(t,e){if(1&t&&(g.TgZ(0,"div",12),g._uU(1),g.qZA()),2&t){const t=g.oxw().$implicit;g.xp6(1),g.hij(" ",t("PAY")," ")}}function k(t,e){1&t&&g._UZ(0,"div",12)}function Y(t,e){if(1&t&&(g.TgZ(0,"div",28),g._uU(1),g.ALo(2,"number"),g.qZA()),2&t){const t=g.oxw().$implicit;g.Q6J("ngClass","text-red-500"),g.xp6(1),g.hij(" - ",g.xi3(2,2,t.amounts,"0.0-0")," \u0111 ")}}function R(t,e){if(1&t&&(g.TgZ(0,"div",29),g._uU(1),g.ALo(2,"number"),g.qZA()),2&t){const t=g.oxw().$implicit;g.xp6(1),g.hij(" - ",g.xi3(2,1,t.amounts-t.amounts_payed,"0.0-0")," \u0111 ")}}function E(t,e){if(1&t&&(g.TgZ(0,"div",30),g._uU(1),g.ALo(2,"number"),g.qZA()),2&t){const t=g.oxw().$implicit;g.xp6(1),g.hij(" + ",g.xi3(2,1,t.amounts,"0.0-0")," \u0111 ")}}function L(t,e){if(1&t&&(g.TgZ(0,"div",23),g.TgZ(1,"div",11),g._UZ(2,"mat-checkbox",24),g.qZA(),g.TgZ(3,"div",12),g._uU(4),g.ALo(5,"date"),g.qZA(),g.TgZ(6,"div",11),g.TgZ(7,"b"),g._uU(8),g.qZA(),g.qZA(),g.TgZ(9,"div",12),g.TgZ(10,"b"),g._uU(11),g.qZA(),g.qZA(),g.YNc(12,k,1,0,"div",13),g.YNc(13,Y,3,5,"div",25),g.YNc(14,R,3,4,"div",26),g.YNc(15,E,3,4,"div",27),g.qZA()),2&t){const t=e.$implicit;g.xp6(2),g.Q6J("color","primary")("checked",1==t.confirm),g.xp6(2),g.hij(" ",g.xi3(5,9,1e3*t.add_time,"dd/MM/yyyy")," "),g.xp6(4),g.hij("#",t.id," "),g.xp6(3),g.Oqu(t.title),g.xp6(1),g.Q6J("ngIf","in"==t.cr),g.xp6(1),g.Q6J("ngIf","out"==t.cr),g.xp6(1),g.Q6J("ngIf","out"==t.cr),g.xp6(1),g.Q6J("ngIf","in"==t.cr)}}function j(t,e){if(1&t&&(g.TgZ(0,"div",21),g.YNc(1,L,16,12,"div",22),g.qZA()),2&t){const t=g.oxw(2);g.xp6(1),g.Q6J("ngForOf",t.allFinance)}}function P(t,e){if(1&t&&(g.TgZ(0,"div",23),g.TgZ(1,"div",11),g._UZ(2,"mat-checkbox",24),g.qZA(),g.TgZ(3,"div",12),g._uU(4),g.ALo(5,"date"),g.qZA(),g.TgZ(6,"div",11),g.TgZ(7,"b"),g._uU(8),g.qZA(),g.qZA(),g.TgZ(9,"div",12),g.TgZ(10,"b"),g._uU(11),g.qZA(),g.qZA(),g._UZ(12,"div",12),g.TgZ(13,"div",33),g._uU(14),g.ALo(15,"number"),g.qZA(),g.qZA()),2&t){const t=g.oxw().$implicit;g.xp6(2),g.Q6J("color","primary")("checked",1==t.confirm),g.xp6(2),g.hij(" ",g.xi3(5,6,1e3*t.add_time,"dd/MM/yyyy")," "),g.xp6(4),g.hij("#",t.bill_id," "),g.xp6(3),g.Oqu(t.title),g.xp6(3),g.hij(" ",g.xi3(15,9,t.amounts,"0.0-0")," \u0111 ")}}function H(t,e){if(1&t&&(g.TgZ(0,"div",21),g.YNc(1,P,16,12,"div",32),g.qZA()),2&t){const t=e.$implicit;g.xp6(1),g.Q6J("ngIf",0!=t.amounts)}}function V(t,e){if(1&t&&(g.TgZ(0,"div"),g.YNc(1,H,2,1,"div",31),g.qZA()),2&t){const t=g.oxw(2);g.xp6(1),g.Q6J("ngForOf",t.billDebtCustomer)}}function $(t,e){if(1&t){const t=g.EpF();g.ynx(0),g.TgZ(1,"div",1),g.TgZ(2,"div",2),g.TgZ(3,"div",3),g._uU(4),g.qZA(),g.TgZ(5,"div",4),g.TgZ(6,"button",5),g.NdJ("click",function(){return g.CHM(t),g.oxw().tab=!0}),g._uU(7,"Thu chi"),g.qZA(),g.TgZ(8,"button",6),g.NdJ("click",function(){return g.CHM(t),g.oxw().tab=!1}),g._uU(9,"N\u1ee3"),g.qZA(),g.qZA(),g.TgZ(10,"button",7),g._UZ(11,"mat-icon",8),g.qZA(),g.qZA(),g.TgZ(12,"div",9),g.TgZ(13,"div",10),g._UZ(14,"div",11),g.TgZ(15,"div",12),g._uU(16),g.qZA(),g.TgZ(17,"div",11),g._uU(18),g.qZA(),g.TgZ(19,"div",12),g._uU(20),g.qZA(),g.YNc(21,O,2,1,"div",13),g.YNc(22,U,1,0,"div",13),g.YNc(23,Q,2,1,"div",13),g.YNc(24,M,2,1,"div",13),g.qZA(),g.qZA(),g.TgZ(25,"div",14),g.TgZ(26,"div",15),g.TgZ(27,"div",16),g.YNc(28,j,2,1,"div",17),g.YNc(29,V,2,1,"div",18),g.qZA(),g.qZA(),g.qZA(),g.TgZ(30,"div",19),g.TgZ(31,"button",20),g.TgZ(32,"span"),g._uU(33),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.BQk()}if(2&t){const t=e.$implicit,i=g.oxw();g.xp6(4),g.Oqu(t("DETAIL")),g.xp6(6),g.Q6J("tabIndex",-1),g.xp6(1),g.Q6J("svgIcon","heroicons_outline:x"),g.xp6(5),g.hij(" ",t("FROM_DATE")," "),g.xp6(2),g.hij(" ",t("BILL")," "),g.xp6(2),g.hij(" ",t("CONTENT")," "),g.xp6(1),g.Q6J("ngIf",i.firstShow),g.xp6(1),g.Q6J("ngIf",!i.firstShow),g.xp6(1),g.Q6J("ngIf",i.firstShow),g.xp6(1),g.Q6J("ngIf",!i.firstShow),g.xp6(1),g.Q6J("formGroup",i.detailForm),g.xp6(3),g.Q6J("ngIf",i.tab),g.xp6(1),g.Q6J("ngIf",!i.tab),g.xp6(2),g.Q6J("color","secondary"),g.xp6(2),g.hij(" ",t("CLOSE")," ")}}let B=(()=>{class t{constructor(t,e,i,a,o,n){this.data=t,this.dialogRef=e,this._alertService=i,this._translateService=a,this._moneyService=o,this._farmService=n,this.loadingFlag=new m.E,this.tab=!0,this.detailForm=new d.NI}ngOnInit(){this.firstShow=!0,this.list=this.data.bigData.filter(t=>t.customer_name==this.data.smallData.customer_name),this.financeCustomer=this.data.customerData.filter(t=>t.customer_name==this.data.smallData.customer_name),this.billDebtCustomer=this.financeCustomer.filter(t=>"0"!==t.bill_id),this.allFinance=this.financeCustomer.filter(t=>"0"==t.bill_id)}}return t.\u0275fac=function(e){return new(e||t)(g.Y36(J.WI),g.Y36(J.so),g.Y36(Z.c),g.Y36(n.Vn),g.Y36(h.r),g.Y36(f.D))},t.\u0275cmp=g.Xpm({type:t,selectors:[["app-finance-detail"]],decls:1,vars:1,consts:[[4,"transloco","translocoRead"],[1,"flex","flex-col","max-w-240","md:min-w-160","-m-6"],[1,"flex","flex-0","items-center","justify-between","h-16","pr-3","sm:pr-5","pl-6","sm:pl-8","bg-primary","text-on-primary"],[1,"text-lg","font-medium"],[1,"flex"],["mat-flat-button","",1,"fuse-mat-button","w-24","mr-2",3,"click"],["mat-flat-button","",1,"fuse-mat-button","w-24",3,"click"],["mat-icon-button","","mat-dialog-close","",3,"tabIndex"],[1,"text-current",3,"svgIcon"],[1,"bg-card","shadow","rounded-2xl","overflow-hidden","w-full","mt-6"],[1,"grid-cols-10","z-10","sticky","top-0","grid","gap-4","py-4","px-8","shadow","text-md","font-semibold","bg-gray-50"],[1,"col-span-1"],[1,"col-span-2"],["class","col-span-2",4,"ngIf"],[1,"flex","flex-col","flex-auto","overflow-y-auto","pb-7",3,"formGroup"],[1,"w-full"],[1,"flex","flex-col","w-full","max-h-96"],["class","max-h-160 overflow-y-auto",4,"ngIf"],[4,"ngIf"],[1,"flex","flex-0","items-center","justify-end","h-16","pr-3","sm:pr-5","pl-6","sm:pl-8"],["mat-flat-button","","mat-dialog-close","",1,"fuse-mat-button",3,"color"],[1,"max-h-160","overflow-y-auto"],["class","grid-cols-10 grid items-center gap-4 py-3 px-8 border-b",4,"ngFor","ngForOf"],[1,"grid-cols-10","grid","items-center","gap-4","py-3","px-8","border-b"],[1,"pointer-events-none",3,"color","checked"],["class","col-span-2",3,"ngClass",4,"ngIf"],["title","Chi","class","col-span-2 text-red-500",4,"ngIf"],["title","Thu","class","col-span-2 text-green-500",4,"ngIf"],[1,"col-span-2",3,"ngClass"],["title","Chi",1,"col-span-2","text-red-500"],["title","Thu",1,"col-span-2","text-green-500"],["class","max-h-160 overflow-y-auto",4,"ngFor","ngForOf"],["class","grid-cols-10 grid items-center gap-4 py-3 px-8 border-b",4,"ngIf"],["ngClass","text-orange-500",1,"col-span-2"]],template:function(t,e){1&t&&g.YNc(0,$,34,15,"ng-container",0),2&t&&g.Q6J("translocoRead","FARM.FINANCE")},directives:[n.KI,A.lW,J.ZT,_.Hw,a.O5,d.JL,d.sg,a.sg,I.oG,a.mk],pipes:[a.uU,a.JJ],styles:[""]}),t})();var W=i(53040);function G(t,e){1&t&&g._UZ(0,"mat-progress-bar",24),2&t&&g.Q6J("mode","indeterminate")}const K=function(t,e){return{"text-green-500":t,"text-red-500":e}};function X(t,e){if(1&t){const t=g.EpF();g.TgZ(0,"div",25),g.TgZ(1,"div",26),g.TgZ(2,"div",16),g.TgZ(3,"mat-checkbox",27),g.NdJ("change",function(e){const i=g.CHM(t),a=i.$implicit,o=i.index;return g.oxw(2).checkBox(a,e,o)}),g.qZA(),g.qZA(),g.TgZ(4,"div",28),g.TgZ(5,"b"),g._uU(6),g.ALo(7,"date"),g.qZA(),g.TgZ(8,"span"),g._uU(9),g.qZA(),g.TgZ(10,"span"),g._uU(11),g.qZA(),g.qZA(),g.TgZ(12,"div",16),g.TgZ(13,"div",29),g.TgZ(14,"span"),g._uU(15),g.qZA(),g._uU(16),g.ALo(17,"number"),g.qZA(),g.TgZ(18,"div",29),g._uU(19),g.ALo(20,"number"),g.qZA(),g.qZA(),g.qZA(),g.qZA()}if(2&t){const t=e.$implicit,i=g.oxw().$implicit;g.xp6(3),g.Q6J("color","primary")("checked","1"==t.confirm),g.xp6(3),g.Oqu(g.xi3(7,13,1e3*t.add_time,"dd-MM-YYYY")),g.xp6(3),g.HOy("",i("CONTENT")," ",t.title," ",i("OF")," (",t.pond_name,")"),g.xp6(2),g.Oqu(t.group_id),g.xp6(2),g.Q6J("ngClass",g.WLB(22,K,0===t.debt_payed,0!==t.debt_payed)),g.xp6(2),g.Oqu(0==t.debt_payed?"":"-"),g.xp6(1),g.hij(" ",g.xi3(17,16,t.amounts,"0.0-0")," \u0111 "),g.xp6(2),g.Q6J("ngClass",g.WLB(25,K,0===t.debt_payed,0!==t.debt_payed)),g.xp6(1),g.hij(" N\u1ee3 : ",g.xi3(20,19,t.debt_payed,"0.0-0")," \u0111 ")}}function z(t,e){if(1&t){const t=g.EpF();g.ynx(0),g.TgZ(1,"div",1),g.TgZ(2,"div",2),g.TgZ(3,"div",3),g._uU(4),g.qZA(),g.TgZ(5,"button",4),g._UZ(6,"mat-icon",5),g.qZA(),g.qZA(),g.TgZ(7,"div",6),g.TgZ(8,"div"),g.YNc(9,G,1,1,"mat-progress-bar",7),g.qZA(),g.TgZ(10,"div",8),g.YNc(11,X,21,28,"div",9),g.TgZ(12,"div",10),g.TgZ(13,"mat-form-field",11),g.TgZ(14,"mat-label"),g._uU(15),g.qZA(),g.TgZ(16,"input",12),g.NdJ("click",function(){return g.CHM(t),g.MAs(19).open()}),g.qZA(),g._UZ(17,"mat-datepicker-toggle",13),g._UZ(18,"mat-datepicker",null,14),g.qZA(),g.TgZ(20,"b",15),g._uU(21),g.qZA(),g.qZA(),g.TgZ(22,"div",16),g.TgZ(23,"mat-form-field",17),g.TgZ(24,"mat-label"),g._uU(25),g.qZA(),g._UZ(26,"input",18),g.qZA(),g.TgZ(27,"mat-form-field",17),g.TgZ(28,"mat-label"),g._uU(29,"T\u1ed5ng n\u1ee3"),g.qZA(),g.TgZ(30,"input",19,20),g.NdJ("keypress",function(e){return g.CHM(t),g.oxw().validateNo(e)}),g.qZA(),g._UZ(32,"mat-error"),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.TgZ(33,"div",21),g.TgZ(34,"button",22),g.NdJ("click",function(){return g.CHM(t),g.oxw().save()}),g.TgZ(35,"span"),g._uU(36),g.qZA(),g.qZA(),g.TgZ(37,"button",23),g.TgZ(38,"span"),g._uU(39),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.BQk()}if(2&t){const t=e.$implicit,i=g.MAs(19),a=g.oxw();g.xp6(4),g.Oqu(t("PAY")),g.xp6(1),g.Q6J("tabIndex",-1),g.xp6(1),g.Q6J("svgIcon","heroicons_outline:x"),g.xp6(1),g.Q6J("formGroup",a.payForm),g.xp6(2),g.Q6J("ngIf",a.savingFlag.pending),g.xp6(2),g.Q6J("ngForOf",a.list),g.xp6(2),g.Q6J("hideRequiredMarker",!0),g.xp6(2),g.Oqu(t("DAY")),g.xp6(1),g.Q6J("matDatepicker",i)("placeholder",t("DATE"))("max",a.date.toDate())("min",a.minDate),g.xp6(1),g.Q6J("for",i),g.xp6(4),g.Oqu(a.data.smallData.customer_name),g.xp6(4),g.Oqu(t("CONTENT")),g.xp6(1),g.Q6J("placeholder",t("CONTENT")),g.xp6(4),g.Q6J("placeholder",a.data.smallData.total_debt)("max",a.totalDebt),g.xp6(4),g.Q6J("disabled",!a.payForm.valid)("color","primary"),g.xp6(2),g.hij(" ",t("SAVE")," "),g.xp6(1),g.Q6J("color","secondary"),g.xp6(2),g.hij(" ",t("CANCEL")," ")}}let tt=(()=>{class t{constructor(t,e,i,a,o,n){this.data=t,this.dialogRef=e,this._alertService=i,this._translateService=a,this._moneyService=o,this._farmService=n,this.disableSelect=new d.NI(!1),this.numberFormatCost=new W.y(""),this.numberFormatCostNumber=new W.y(""),this.savingFlag=new m.E,this.payForm=new d.cw({type:new d.NI("out",d.kI.required),typeAdd:new d.NI("farm",d.kI.required),dateOf:new d.NI(u().format("YYYY-MM-DD"),d.kI.required),payDebt:new d.NI("",d.kI.required),title:new d.NI("",d.kI.required)}),this.pondSeleted=[],this.date=u(),this.totalDebt=this.data.smallData.total_debt}ngOnInit(){console.log("data from detail",this.data.smallData),this.buildFormData(),this.getSameCustomer(),this.minDate=0!=this.list.length?new Date(1e3*this.list[this.list.length-1].add_time).getMonth()==(new Date).getMonth()?new Date(1e3*this.list[this.list.length-1].add_time):u().startOf("month"):new Date}checkBox(t,e,i){e.checked?(this.payForm.patchValue({payDebt:Number(this.payForm.value.payDebt)+Number(t.debt_payed)}),this.listCustom.push(t),console.log("push",this.listCustom)):(this.listCustom=this.listCustom.filter(e=>t.id!=e.id),console.log("filter",this.listCustom),this.payForm.patchValue({payDebt:this.payForm.value.payDebt-t.debt_payed})),0!=this.listCustom.length?(this.minDate=new Date(1e3*this.listCustom[this.listCustom.length-1].add_time).getMonth()==(new Date).getMonth()?new Date(1e3*this.listCustom[this.listCustom.length-1].add_time):u().startOf("month"),this.totalDebt=this.listCustom.reduce((t,e)=>t+Number(e.debt_payed),0)):this.minDate=new Date,console.log(this.totalDebt)}buildFormData(){this.payForm.patchValue({dateOf:u(),payDebt:this.data.smallData.total_debt,title:"Thanh toan nhanh cho #"+this.data.smallData.customer_name})}getSameCustomer(){this.list=this.data.bigData.filter(t=>t.customer_name==this.data.smallData.customer_name),console.log(this.list),this.listCustom=this.data.bigData.filter(t=>t.customer_name==this.data.smallData.customer_name)}validateNo(t){if(console.log(t.target.value),t.target.value>this.totalDebt)return!1;const e=t.which?t.which:t.keyCode;return!(e>31&&(e<48||e>57))}callApiPay(t){this._moneyService.createRecord(t).pipe().subscribe(e=>{0==e.status||this.dialogRef.close(t)},t=>{this._alertService.error(this._translateService.translate("CONNECT_ERROR"))})}save(){this.savingFlag.setPending(!0),console.log("list when save is",this.list);let t=this.payForm.value.payDebt;const e=this.listCustom.sort((t,e)=>e.add_time-t.add_time).reverse();console.log("sort arr",e);for(let i of e){let e=i.debt_payed;if(console.log(i),this.payForm.value.payDebt==this.totalDebt||this.payForm.value.payDebt==this.data.smallData.total_debt){const t={type:this.payForm.value.type,typeAdd:this.payForm.value.typeAdd,title:"Thanh to\xe1n bill #"+i.id,ponds:i.pond_id,amounts:i.debt_payed,amounts_payed:i.debt_payed,today:u(this.payForm.value.dateOf).unix(),fcode:this._farmService.fcode,accounting_by:i.accounting_by,payDebt:e,customer_name:i.customer_name,group_id:"4",bill_id:i.id};this.callApiPay(t)}else{t-=i.debt_payed,console.log("a gonna update always when a create new",t);const e={type:this.payForm.value.type,typeAdd:this.payForm.value.typeAdd,title:"Thanh to\xe1n bill #"+i.id,ponds:i.pond_id,amounts:t>=0?i.debt_payed:t+Number(i.debt_payed),amounts_payed:t>=0?i.debt_payed:t+Number(i.debt_payed),today:u(this.payForm.value.dateOf).unix(),fcode:this._farmService.fcode,accounting_by:i.accounting_by,payDebt:"",customer_name:i.customer_name,group_id:"4",bill_id:i.id};console.log(e),e.amounts_payed>0&&(console.log(e.amounts_payed),this.callApiPay(e))}}}}return t.\u0275fac=function(e){return new(e||t)(g.Y36(J.WI),g.Y36(J.so),g.Y36(Z.c),g.Y36(n.Vn),g.Y36(h.r),g.Y36(f.D))},t.\u0275cmp=g.Xpm({type:t,selectors:[["app-finance-payAll"]],decls:1,vars:1,consts:[[4,"transloco","translocoRead"],[1,"flex","flex-col","max-w-240","md:min-w-160","-m-6"],[1,"flex","flex-0","items-center","justify-between","h-16","pr-3","sm:pr-5","pl-6","sm:pl-8","bg-primary","text-on-primary"],[1,"text-lg","font-medium"],["mat-icon-button","","mat-dialog-close","",3,"tabIndex"],[1,"text-current",3,"svgIcon"],[1,"flex","flex-col","flex-auto","max-h-96","p-6","sm:p-8","overflow-y-auto",3,"formGroup"],[3,"mode",4,"ngIf"],[1,"w-full"],["class","flex flex-col w-full",4,"ngFor","ngForOf"],[1,"flex","justify-between","items-center","shadow","rounded-2xl","mt-6","bg-gray-50","p-4","bg-card"],[1,"flex-auto","mr-2",3,"hideRequiredMarker"],["matInput","","formControlName","dateOf","required","",3,"matDatepicker","placeholder","max","min","click"],["matSuffix","",3,"for"],["picker",""],[1,"w-64"],[1,"flex","flex-col"],[1,"flex-auto"],["matInput","","formControlName","title",3,"placeholder"],["matInput","","type","number","min","1","formControlName","payDebt","required","",3,"placeholder","max","keypress"],["ip",""],[1,"flex","flex-0","items-center","justify-end","h-16","pr-3","sm:pr-5","pl-6","sm:pl-8"],["mat-flat-button","",1,"fuse-mat-button","mr-3",3,"disabled","color","click"],["mat-flat-button","","mat-dialog-close","",1,"fuse-mat-button",3,"color"],[3,"mode"],[1,"flex","flex-col","w-full"],[1,"flex","justify-between","items-center","bg-card","shadow","rounded-2xl","p-4","overflow-hidden","mt-2","w-full","bg-gray-50"],[3,"color","checked","change"],[1,"flex","flex-col","w-96"],[3,"ngClass"]],template:function(t,e){1&t&&g.YNc(0,z,40,23,"ng-container",0),2&t&&g.Q6J("translocoRead","FARM.FINANCE")},directives:[n.KI,A.lW,J.ZT,_.Hw,d.JL,d.sg,a.O5,a.sg,v.KE,v.hX,b.Nt,d.Fj,T.hl,d.JJ,d.u,d.Q7,T.nW,v.R9,T.Mq,d.qQ,d.wV,d.Fd,v.TO,q.pW,I.oG,a.mk],pipes:[a.uU,a.JJ],styles:[""]}),t})();var et=i(42120),it=i(33935);const at=["paginator"];function ot(t,e){1&t&&g._UZ(0,"mat-progress-bar",11),2&t&&g.Q6J("mode","indeterminate")}const nt=function(t,e){return{"text-green-500":t,"text-red-500":e}};function st(t,e){if(1&t){const t=g.EpF();g.TgZ(0,"div",12),g.TgZ(1,"div",8),g.TgZ(2,"b"),g._uU(3),g.qZA(),g.qZA(),g.TgZ(4,"div",13),g.TgZ(5,"span"),g._uU(6),g.qZA(),g._uU(7),g.ALo(8,"number"),g.qZA(),g.TgZ(9,"div"),g.TgZ(10,"button",14),g._UZ(11,"mat-icon",15),g.qZA(),g.TgZ(12,"mat-menu",null,16),g.TgZ(14,"button",17),g.NdJ("click",function(){const e=g.CHM(t).$implicit;return g.oxw(2).payall(e)}),g._UZ(15,"mat-icon",18),g.TgZ(16,"span"),g._uU(17),g.qZA(),g.qZA(),g.TgZ(18,"button",17),g.NdJ("click",function(){const e=g.CHM(t).$implicit;return g.oxw(2).detail(e)}),g._UZ(19,"mat-icon",19),g.TgZ(20,"span"),g._uU(21),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA()}if(2&t){const t=e.$implicit,i=g.MAs(13),a=g.oxw().$implicit;g.Q6J("title","S\u1ed1 ti\u1ec1n c\xf2n n\u1ee3 l\xe0:"),g.xp6(3),g.Oqu(t.customer_name),g.xp6(1),g.Q6J("ngClass",g.WLB(11,nt,0==t.total_debt,0!=t.total_debt)),g.xp6(2),g.Oqu(0==t.total_debt?"":"-"),g.xp6(1),g.hij(" ",g.xi3(8,8,t.total_debt,"0.0-0")," \u0111 "),g.xp6(3),g.Q6J("matMenuTriggerFor",i),g.xp6(7),g.hij("",a("PAY")," nhanh"),g.xp6(4),g.Oqu(a("DETAIL"))}}function rt(t,e){if(1&t&&(g.ynx(0),g.TgZ(1,"div",1),g.TgZ(2,"div",2),g.TgZ(3,"div",3),g._uU(4),g.qZA(),g.qZA(),g.TgZ(5,"div"),g.YNc(6,ot,1,1,"mat-progress-bar",4),g.qZA(),g.TgZ(7,"div",5),g.TgZ(8,"div",6),g.TgZ(9,"div",7),g.TgZ(10,"div",8),g._uU(11),g.qZA(),g.TgZ(12,"div",8),g._uU(13),g.qZA(),g.TgZ(14,"div"),g._uU(15),g.qZA(),g.qZA(),g.TgZ(16,"div",9),g.YNc(17,st,22,14,"div",10),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.BQk()),2&t){const t=e.$implicit,i=g.oxw();g.xp6(4),g.hij(" ",t("FAST_PAY")," "),g.xp6(2),g.Q6J("ngIf",i.loadingFlag.pending),g.xp6(5),g.hij(" ",t("COMPANY")," "),g.xp6(2),g.hij(" ",t("AMOUNT")," "),g.xp6(2),g.hij(" ",t("ACTIONS")," "),g.xp6(2),g.Q6J("ngForOf",i.listAllCustomer)}}let lt=(()=>{class t{constructor(t,e,i,a,o,n){this._farmService=t,this._moneyService=e,this.localDb=i,this._alertService=a,this._translateService=o,this._matDialog=n,this.panelOpenState=!1,this.loadingFlag=new m.E,this.arrCustomer=[],this.listDebtCustomers=[],this.nameCustomer=[],this.list=[],this.listDataCustomer=[]}ngOnInit(){this._moneyService.setCode(this._farmService.fcode),this.getList(),this.getCustomersI(),this.getAllCustomers()}payall(t){this._matDialog.open(tt,{autoFocus:!1,data:{smallData:t,bigData:this.list,midData:this.listConvert}}).afterClosed().subscribe(t=>{t&&this._alertService.success(this._translateService.translate("FARM.ADD.EDIT_SUCCESS"))})}getList(t=0){this.loadingFlag.setPending(!0),this._moneyService.getMoneyList(this._farmService.fcode,t).pipe().subscribe(t=>{0==t.status?(this._alertService.error(t.error),this.loadingFlag.setResult(!1)):(0==t.data||(t.numRows&&(this.totalLength=t.numRows),this.moneyList=t.data,this.totalList=t.fund,this.moneyList.map(t=>{""!==(null==t?void 0:t.customer_name)&&this.listDataCustomer.push(t)}),this.moneyList.filter(t=>""!==t.customer_name).map(t=>{this.nameCustomer.push(t.customer_name.replace(/ /g,"-"))}),this.nameCustomer=this.nameCustomer.filter((t,e)=>this.nameCustomer.indexOf(t)===e),this.getCustomersI()),this.loadingFlag.setResult(!0))},t=>{this._alertService.error(this._translateService.translate("CONNECT_ERROR")),this.loadingFlag.setResult(!1)})}detail(t){this._matDialog.open(B,{autoFocus:!1,data:{smallData:t,bigData:this.list,customerData:this.listDataCustomer}}).afterClosed().subscribe(t=>{t&&this._alertService.success(this._translateService.translate("Close"))})}getAllCustomers(){this._moneyService.getCustomers().pipe().subscribe(t=>{0==t.status||(this.listAllCustomer=t.data)},t=>{this._alertService.error(this._translateService.translate("CONNECT_ERROR"))})}getCustomersI(){for(let t of this.nameCustomer)this._moneyService.getDebtCustomers(t).pipe().subscribe(t=>{0==t.status?(this._alertService.error(t.error),this.loadingFlag.setPending(!0)):0!==t.data.length&&t.data.map(t=>{this.list.push(t);const e=(t=>{const e=[];for(let[i,a]of Object.entries(t))e.push({customer_name:i,debt_payed:a});return e})((t=>{let e={};for(let i of t)e=e.hasOwnProperty(i.customer_name)?Object.assign(Object.assign({},e),{[i.customer_name]:Number(e[i.customer_name])+Number(i.debt_payed)}):Object.assign(Object.assign({},e),{[i.customer_name]:Number(i.debt_payed)});return e})(this.list));this.listConvert=e.map((t,e)=>(t.id=this.list[e].id,t.accounting_by=this.list[e].accounting_by,t.add_time=this.list[e].add_time,t.alias=this.list[e].alias,t.amounts=this.list[e].amounts,t.amounts_payed=this.list[e].amounts_payed,t.backup=this.list[e].backup,t.bill_id=this.list[e].bill_id,t.code=this.list[e].code,t.confirm=this.list[e].confirm,t.customer_slug=this.list[e].customer_slug,t.del=this.list[e].del,t.edit_time=this.list[e].edit_time,t.farm_id=this.list[e].farm_id,t.group_id=this.list[e].group_id,t.pond_id=this.list[e].pond_id,t.title=this.list[e].title,t.total=this.list[e].total,t.user_id=this.list[e].user_id,t))})},t=>{this._alertService.error(this._translateService.translate("CONNECT_ERROR")),this.loadingFlag.setPending(!1)})}}return t.\u0275fac=function(e){return new(e||t)(g.Y36(f.D),g.Y36(h.r),g.Y36(et.T),g.Y36(Z.c),g.Y36(n.Vn),g.Y36(J.uw))},t.\u0275cmp=g.Xpm({type:t,selectors:[["app-finance-fastPay"]],viewQuery:function(t,e){if(1&t&&g.Gf(at,5),2&t){let t;g.iGM(t=g.CRH())&&(e.paginator=t.first)}},decls:1,vars:1,consts:[[4,"transloco","translocoRead"],[1,"w-full"],[1,"relative","flex","flex-col","sm:flex-row","flex-0","items-center","justify-between","pb-8"],[1,"text-3xl","leading-8","font-semibold","tracking-tight"],[3,"mode",4,"ngIf"],[1,"bg-card","shadow","rounded-2xl","overflow-hidden","w-full","mt-6"],[1,"grid"],[1,"grid-cols-5","z-10","sticky","top-0","grid","gap-4","py-4","px-8","shadow","text-md","font-semibold","bg-gray-50"],[1,"col-span-2"],[1,"max-h-160","overflow-y-auto"],["class","grid-cols-5 grid items-center gap-4 py-3 px-8 border-b",3,"title",4,"ngFor","ngForOf"],[3,"mode"],[1,"grid-cols-5","grid","items-center","gap-4","py-3","px-8","border-b",3,"title"],[1,"col-span-2",3,"ngClass"],["mat-icon-button","",3,"matMenuTriggerFor"],["svgIcon","heroicons_outline:dots-vertical"],["menu","matMenu"],["mat-menu-item","",3,"click"],["svgIcon","mat_outline:payment"],["svgIcon","mat_outline:remove_red_eye"]],template:function(t,e){1&t&&g.YNc(0,rt,18,6,"ng-container",0),2&t&&g.Q6J("translocoRead","FARM.FINANCE")},directives:[n.KI,a.O5,a.sg,q.pW,a.mk,A.lW,it.p6,_.Hw,it.VK,it.OP],pipes:[a.JJ],styles:[".example-headers-align[_ngcontent-%COMP%]   .mat-expansion-panel-header-description[_ngcontent-%COMP%], .example-headers-align[_ngcontent-%COMP%]   .mat-expansion-panel-header-title[_ngcontent-%COMP%]{flex-basis:0}.example-headers-align[_ngcontent-%COMP%]   .mat-expansion-panel-header-description[_ngcontent-%COMP%]{justify-content:space-between;align-items:center}.example-headers-align[_ngcontent-%COMP%]   .mat-form-field[_ngcontent-%COMP%] + .mat-form-field[_ngcontent-%COMP%]{margin-left:8px}.boxCardSmal[_ngcontent-%COMP%]{height:90%;padding-top:15px}.dashed[_ngcontent-%COMP%]{border-top:1px dashed;border-bottom-width:0}"]}),t})();var ct=i(49457),dt=i.n(ct);function mt(t,e){1&t&&g._UZ(0,"mat-progress-bar",16),2&t&&g.Q6J("mode","indeterminate")}function ut(t,e){if(1&t){const t=g.EpF();g.ynx(0),g.TgZ(1,"div",1),g.TgZ(2,"div",2),g.TgZ(3,"div",3),g._uU(4,"Ch\u1ec9nh ti\u1ec1n m\u1eb7t"),g.qZA(),g.TgZ(5,"button",4),g._UZ(6,"mat-icon",5),g.qZA(),g.qZA(),g.TgZ(7,"div",6),g.TgZ(8,"div"),g.YNc(9,mt,1,1,"mat-progress-bar",7),g.qZA(),g.TgZ(10,"div",8),g.TgZ(11,"div",9),g.TgZ(12,"div",10),g.TgZ(13,"mat-form-field",11),g.TgZ(14,"mat-label"),g._uU(15,"\u0110i\u1ec1u ch\u1ec9nh"),g.qZA(),g.TgZ(16,"input",12),g.NdJ("keypress",function(e){return g.CHM(t),g.oxw().validNo(e)})("input",function(e){return g.CHM(t),g.oxw().numberFormatCost.setValue(e.target.value)}),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.TgZ(17,"div",13),g.TgZ(18,"button",14),g.NdJ("click",function(){return g.CHM(t),g.oxw().save()}),g.TgZ(19,"span"),g._uU(20),g.qZA(),g.qZA(),g.TgZ(21,"button",15),g.TgZ(22,"span"),g._uU(23),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.BQk()}if(2&t){const t=e.$implicit,i=g.oxw();g.xp6(5),g.Q6J("tabIndex",-1),g.xp6(1),g.Q6J("svgIcon","heroicons_outline:x"),g.xp6(3),g.Q6J("ngIf",i.loadingFlag.pending),g.xp6(1),g.Q6J("formGroup",i.addFormMoney),g.xp6(6),g.Q6J("value",i.numberFormatCost.fakeView),g.xp6(2),g.Q6J("color","primary"),g.xp6(2),g.hij(" ",t("SAVE")," "),g.xp6(1),g.Q6J("color","secondary"),g.xp6(2),g.hij(" ",t("CANCEL")," ")}}i(35386);let pt=(()=>{class t{constructor(t,e,i,a){this.data=t,this.dialogRef=e,this._moneyService=i,this._alertService=a,this.loadingFlag=new m.E,this.numberFormatCost=new W.y(""),this.addFormMoney=new d.cw({value:new d.NI("",d.kI.required)})}ngOnInit(){console.log(this.data)}validNo(t){const e=t.which?t.which:t.keycode;return console.log(e),!(e>31&&(e<44||e>58))}save(){var t;this.loadingFlag.setPending(!0),this.data>0?Number(this.numberFormatCost.realValue)>Number(this.data)?t=Number(this.numberFormatCost.realValue)-Math.ceil(this.data):Number(this.numberFormatCost.realValue)<=Number(this.data)&&(t=-(Number(this.data)-Number(this.numberFormatCost.realValue))):Number(this.numberFormatCost.realValue)>Number(this.data)?t=Number(this.numberFormatCost.realValue)-Number(this.data):Number(this.numberFormatCost.realValue)<=Number(this.data)&&(t=Number(this.numberFormatCost.realValue)-Math.floor(this.data)),console.log(t),this.addFormMoney.valid&&this._moneyService.fetchUpdateFund(t).subscribe(t=>{1===t.status?this.dialogRef.close(!0):this._alertService.error(t.error),this.loadingFlag.setResult(!0)})}}return t.\u0275fac=function(e){return new(e||t)(g.Y36(J.WI),g.Y36(J.so),g.Y36(h.r),g.Y36(Z.c))},t.\u0275cmp=g.Xpm({type:t,selectors:[["app-finance-add-money"]],decls:1,vars:1,consts:[[4,"transloco","translocoRead"],[1,"flex","flex-col","max-w-240","md:min-w-160","-m-6","max-h-screen","-m-6"],[1,"flex","flex-0","items-center","justify-between","h-16","pr-3","sm:pr-5","pl-6","sm:pl-8","bg-primary","text-on-primary"],[1,"text-lg","font-medium"],["mat-icon-button","","mat-dialog-close","",3,"tabIndex"],[1,"text-current",3,"svgIcon"],[1,"flex","flex-col","flex-auto","p-6","sm:p-8","overflow-y-auto"],[3,"mode",4,"ngIf"],[1,"w-full",3,"formGroup"],[1,"flex","flex-col","w-full"],[1,"flex"],[1,"flex-auto"],["matInput","","formControlName","value",3,"value","keypress","input"],[1,"flex","flex-0","items-center","justify-end","h-16","pr-3","sm:pr-5","pl-6","sm:pl-8"],["mat-flat-button","",1,"fuse-mat-button","mr-3",3,"color","click"],["mat-stroked-button","","mat-dialog-close","",1,"fuse-mat-button",3,"color"],[3,"mode"]],template:function(t,e){1&t&&g.YNc(0,ut,24,9,"ng-container",0),2&t&&g.Q6J("translocoRead","FARM.ADD")},directives:[n.KI,A.lW,J.ZT,_.Hw,a.O5,d.JL,d.sg,v.KE,v.hX,b.Nt,d.Fj,d.JJ,d.u,q.pW],styles:[""]}),t})();var gt=i(89822);function ht(t,e){1&t&&g._UZ(0,"mat-progress-bar",15),2&t&&g.Q6J("mode","indeterminate")}function ft(t,e){if(1&t){const t=g.EpF();g.ynx(0),g.TgZ(1,"div",1),g.TgZ(2,"div",2),g.TgZ(3,"div",3),g._uU(4),g.qZA(),g.TgZ(5,"button",4),g._UZ(6,"mat-icon",5),g.qZA(),g.qZA(),g.TgZ(7,"div",6),g.TgZ(8,"div"),g.YNc(9,ht,1,1,"mat-progress-bar",7),g.qZA(),g.TgZ(10,"div",8),g.TgZ(11,"div",9),g.TgZ(12,"p",10),g._uU(13),g.qZA(),g.TgZ(14,"p",11),g._uU(15),g.qZA(),g.TgZ(16,"p"),g._uU(17),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.TgZ(18,"div",12),g.TgZ(19,"button",13),g.NdJ("click",function(){return g.CHM(t),g.oxw().save()}),g.TgZ(20,"span"),g._uU(21),g.qZA(),g.qZA(),g.TgZ(22,"button",14),g.TgZ(23,"span"),g._uU(24),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.BQk()}if(2&t){const t=e.$implicit,i=g.oxw();g.xp6(4),g.Oqu(t("TITLE")),g.xp6(1),g.Q6J("tabIndex",-1),g.xp6(1),g.Q6J("svgIcon","heroicons_outline:x"),g.xp6(3),g.Q6J("ngIf",i.savingFlag.pending),g.xp6(4),g.Oqu(t("CONFIRM_DELETE")),g.xp6(2),g.Oqu(i.data.title),g.xp6(2),g.Oqu(i.date),g.xp6(2),g.Q6J("color","primary"),g.xp6(2),g.hij(" ",t("CONFIRM")," "),g.xp6(1),g.Q6J("color","secondary"),g.xp6(2),g.hij(" ",t("CANCEL")," ")}}let Zt=(()=>{class t{constructor(t,e,i,a,o,n){this.data=t,this.dialogRef=e,this.farmService=i,this._alertService=a,this._translateService=o,this._moneyService=n,this.savingFlag=new m.E}ngOnInit(){this.date=u(1e3*this.data.smallData.add_time).format("DD/MM/YYYY"),console.log("bigDateDelete",this.data.bigData),console.log("smallData",this.data.smallData),this.listDataBill=this.data.bigData.filter(t=>t.bill_id==this.data.smallData.id),console.log(this.listDataBill)}save(){this.savingFlag.setPending(!0),this._moneyService.removeRecord({item:this.data.smallData.id,cr:this.data.smallData.cr,fcode:this.farmService.fcode}).pipe().subscribe(t=>{0==t.status?this._alertService.error(t.message):this.dialogRef.close(!0),this.savingFlag.setResult(!0)},t=>{this._alertService.error(this._translateService.translate("CONNECT_ERROR")),this.savingFlag.setResult(!1)})}}return t.\u0275fac=function(e){return new(e||t)(g.Y36(J.WI),g.Y36(J.so),g.Y36(f.D),g.Y36(Z.c),g.Y36(n.Vn),g.Y36(h.r))},t.\u0275cmp=g.Xpm({type:t,selectors:[["app-finance-delete"]],decls:1,vars:1,consts:[[4,"transloco","translocoRead"],[1,"flex","flex-col","max-w-240","md:min-w-160","-m-6"],[1,"flex","flex-0","items-center","justify-between","h-16","pr-3","sm:pr-5","pl-6","sm:pl-8","bg-primary","text-on-primary"],[1,"text-lg","font-medium"],["mat-icon-button","","mat-dialog-close","",3,"tabIndex"],[1,"text-current",3,"svgIcon"],[1,"flex","flex-col","flex-auto","p-6","sm:p-8","overflow-y-auto"],[3,"mode",4,"ngIf"],[1,"w-full"],[1,"flex","flex-col","w-full"],[1,"text-xl","font-bold","mb-3"],[1,"text-xl","font-medium"],[1,"flex","flex-0","items-center","justify-end","h-16","pr-3","sm:pr-5","pl-6","sm:pl-8"],["mat-flat-button","",1,"fuse-mat-button","mr-3",3,"color","click"],["mat-flat-button","","mat-dialog-close","",1,"fuse-mat-button",3,"color"],[3,"mode"]],template:function(t,e){1&t&&g.YNc(0,ft,25,11,"ng-container",0),2&t&&g.Q6J("translocoRead","FARM.DELETE")},directives:[n.KI,A.lW,J.ZT,_.Hw,a.O5,q.pW],styles:[""]}),t})();var xt=i(67441),_t=i(72458),vt=i(21554),bt=i(58341);function Tt(t,e){1&t&&g._UZ(0,"mat-progress-bar",34),2&t&&g.Q6J("mode","indeterminate")}function At(t,e){if(1&t){const t=g.EpF();g.TgZ(0,"mat-form-field",40),g.TgZ(1,"mat-label"),g._uU(2,"Th\xeam nh\xf3m"),g.qZA(),g.TgZ(3,"input",41,22),g.NdJ("focusout",function(){return g.CHM(t),g.oxw(4).saveGroup()}),g.qZA(),g.TgZ(5,"button",42),g.NdJ("click",function(){return g.CHM(t),g.oxw(4).saveGroup()}),g._uU(6,"OK"),g.qZA(),g.qZA()}}function yt(t,e){if(1&t&&(g.TgZ(0,"mat-option",46),g._uU(1),g.qZA()),2&t){const t=g.oxw().$implicit;g.Q6J("value",t.key),g.xp6(1),g.hij(" ",t.value.name," ")}}function qt(t,e){if(1&t&&(g.TgZ(0,"div"),g.YNc(1,yt,2,2,"mat-option",45),g.qZA()),2&t){const t=e.$implicit;g.xp6(1),g.Q6J("ngIf","out"==t.value.type)}}function Ft(t,e){if(1&t&&(g.TgZ(0,"mat-form-field",20),g.TgZ(1,"mat-label"),g._uU(2,"Nh\xf3m"),g.qZA(),g.TgZ(3,"mat-select",43),g.YNc(4,qt,2,1,"div",44),g.ALo(5,"keyvalue"),g.qZA(),g.qZA()),2&t){const t=g.oxw(3).$implicit,e=g.oxw();g.xp6(3),g.Q6J("placeholder",t("TYPE")),g.xp6(1),g.Q6J("ngForOf",g.lcZ(5,2,e.listCategory))}}function Ct(t,e){if(1&t){const t=g.EpF();g.TgZ(0,"div",36),g.YNc(1,At,7,0,"mat-form-field",37),g.YNc(2,Ft,6,4,"mat-form-field",38),g.TgZ(3,"mat-icon",39),g.NdJ("click",function(){g.CHM(t);const e=g.oxw(3);return e.isFalshy=!e.isFalshy}),g.qZA(),g.qZA()}if(2&t){const t=g.oxw(3);g.xp6(1),g.Q6J("ngIf",t.isFalshy),g.xp6(1),g.Q6J("ngIf",!t.isFalshy)}}function wt(t,e){if(1&t){const t=g.EpF();g.TgZ(0,"mat-form-field",40),g.TgZ(1,"mat-label"),g._uU(2,"Th\xeam nh\xf3m"),g.qZA(),g.TgZ(3,"input",47,22),g.NdJ("focusout",function(){return g.CHM(t),g.oxw(4).saveGroup()}),g.qZA(),g.TgZ(5,"button",42),g.NdJ("click",function(){return g.CHM(t),g.oxw(4).saveGroup()}),g._uU(6,"OK"),g.qZA(),g.qZA()}}function Nt(t,e){if(1&t&&(g.TgZ(0,"mat-option",46),g._uU(1),g.qZA()),2&t){const t=g.oxw().$implicit;g.Q6J("value",t.key),g.xp6(1),g.hij(" ",t.value.name," ")}}function Dt(t,e){if(1&t&&(g.TgZ(0,"div"),g.YNc(1,Nt,2,2,"mat-option",45),g.qZA()),2&t){const t=e.$implicit;g.xp6(1),g.Q6J("ngIf","in"==t.value.type)}}function St(t,e){if(1&t&&(g.TgZ(0,"mat-form-field",20),g.TgZ(1,"mat-label"),g._uU(2,"Nh\xf3m"),g.qZA(),g.TgZ(3,"mat-select",43),g.YNc(4,Dt,2,1,"div",44),g.ALo(5,"keyvalue"),g.qZA(),g.qZA()),2&t){const t=g.oxw(3).$implicit,e=g.oxw();g.xp6(3),g.Q6J("placeholder",t("TYPE")),g.xp6(1),g.Q6J("ngForOf",g.lcZ(5,2,e.listCategory))}}function Jt(t,e){if(1&t){const t=g.EpF();g.TgZ(0,"div",36),g.YNc(1,wt,7,0,"mat-form-field",37),g.YNc(2,St,6,4,"mat-form-field",29),g.TgZ(3,"mat-icon",39),g.NdJ("click",function(){g.CHM(t);const e=g.oxw(3);return e.isFalshy=!e.isFalshy}),g.qZA(),g.qZA()}if(2&t){const t=g.oxw(3);g.xp6(1),g.Q6J("ngIf",t.isFalshy),g.xp6(1),g.Q6J("ngIf",!t.isFalshy)}}function It(t,e){if(1&t&&(g.TgZ(0,"div",10),g.YNc(1,Ct,4,2,"div",35),g.YNc(2,Jt,4,2,"div",35),g.qZA()),2&t){const t=g.oxw(2);g.xp6(1),g.Q6J("ngIf","out"==t.editForm.controls.type.value),g.xp6(1),g.Q6J("ngIf","in"==t.editForm.controls.type.value)}}function Ot(t,e){if(1&t&&(g.TgZ(0,"mat-option",46),g._uU(1),g.qZA()),2&t){const t=e.$implicit;g.Q6J("value",t.customer_name),g.xp6(1),g.hij(" ",t.customer_name," ")}}function Ut(t,e){if(1&t&&(g.TgZ(0,"mat-option",46),g._uU(1),g.qZA()),2&t){const t=e.$implicit;g.Q6J("value",t.code),g.xp6(1),g.hij("",t.name," ")}}function Qt(t,e){if(1&t){const t=g.EpF();g.TgZ(0,"mat-chip",53),g.NdJ("click",function(){const e=g.CHM(t).index;return g.oxw(4).removePond(e)}),g._uU(1),g.TgZ(2,"mat-icon",54),g._uU(3,"cancel"),g.qZA(),g.qZA()}if(2&t){const t=e.$implicit;g.xp6(1),g.hij(" ",t.name," ")}}function Mt(t,e){if(1&t&&(g.TgZ(0,"div",50),g.TgZ(1,"mat-chip-list",51),g.YNc(2,Qt,4,1,"mat-chip",52),g.qZA(),g.qZA()),2&t){const t=g.oxw(3);g.xp6(2),g.Q6J("ngForOf",t.pondSeleted)}}function kt(t,e){if(1&t){const t=g.EpF();g.TgZ(0,"div"),g.TgZ(1,"div",10),g.TgZ(2,"mat-form-field",20),g.TgZ(3,"mat-label"),g._uU(4),g.qZA(),g.TgZ(5,"mat-select",48),g.NdJ("selectionChange",function(e){return g.CHM(t),g.oxw(2).chooseTypeAll(e)}),g.YNc(6,Ut,2,2,"mat-option",25),g.qZA(),g.qZA(),g.qZA(),g.YNc(7,Mt,3,1,"div",49),g.qZA()}if(2&t){const t=g.oxw().$implicit,e=g.oxw();g.xp6(4),g.Oqu(t("POND")),g.xp6(1),g.Q6J("placeholder",t("TYPE")),g.xp6(1),g.Q6J("ngForOf",e.listPonds),g.xp6(1),g.Q6J("ngIf",e.pondSeleted.length>0)}}function Yt(t,e){if(1&t&&(g.TgZ(0,"mat-chip",56),g._uU(1),g.qZA()),2&t){const t=e.$implicit;g.xp6(1),g.hij(" ",t.name," ")}}function Rt(t,e){if(1&t&&(g.TgZ(0,"div",50),g.TgZ(1,"mat-chip-list",51),g.YNc(2,Yt,2,1,"mat-chip",55),g.qZA(),g.qZA()),2&t){const t=g.oxw(3);g.xp6(2),g.Q6J("ngForOf",t.pondSeleted)}}function Et(t,e){if(1&t&&(g.TgZ(0,"div"),g.YNc(1,Rt,3,1,"div",49),g.qZA()),2&t){const t=g.oxw(2);g.xp6(1),g.Q6J("ngIf",t.pondSeleted.length>0)}}function Lt(t,e){if(1&t){const t=g.EpF();g.TgZ(0,"mat-form-field",57),g.TgZ(1,"mat-label"),g._uU(2),g.qZA(),g.TgZ(3,"input",58),g.NdJ("input",function(e){return g.CHM(t),g.oxw(2).numberFormatCost.setValue(e.target.value)})("keypress",function(e){return g.CHM(t),g.oxw(2).validateNo(e)}),g.qZA(),g.TgZ(4,"mat-error"),g._uU(5," Vui l\xf2ng nh\u1eadp s\u1ed1 "),g.qZA(),g.qZA()}if(2&t){const t=g.oxw().$implicit,e=g.oxw();g.xp6(2),g.Oqu(t("AMOUNT")),g.xp6(1),g.Q6J("placeholder",t("AMOUNT"))("value",e.numberFormatCost.fakeView)}}function jt(t,e){1&t&&(g.TgZ(0,"mat-error"),g._uU(1," ko \u0111c nh\u1ecf h\u01a1n "),g.qZA())}function Pt(t,e){1&t&&(g.TgZ(0,"mat-hint"),g.TgZ(1,"strong",60),g._uU(2,"Kh\xf4ng l\u1edbn h\u01a1n S\u1ed1 ti\u1ec1n tr\u1ea3"),g.qZA(),g.qZA())}function Ht(t,e){if(1&t){const t=g.EpF();g.TgZ(0,"mat-form-field",20),g.TgZ(1,"mat-label"),g._uU(2,"S\u1ed1 ti\u1ec1n \u0111\xe3 tr\u1ea3"),g.qZA(),g.TgZ(3,"input",59),g.NdJ("input",function(e){return g.CHM(t),g.oxw(2).numberFormatCostNumber.setValue(e.target.value)})("keypress",function(e){return g.CHM(t),g.oxw(2).validateNo(e)}),g.qZA(),g.YNc(4,jt,2,0,"mat-error",26),g.TgZ(5,"mat-error"),g._uU(6," Vui l\xf2ng nh\u1eadn s\u1ed1 "),g.qZA(),g.YNc(7,Pt,3,0,"mat-hint",26),g.qZA()}if(2&t){const t=g.oxw().$implicit,e=g.oxw();g.xp6(3),g.Q6J("placeholder",t("AMOUNT"))("value",e.numberFormatCostNumber.fakeView),g.xp6(1),g.Q6J("ngIf",e.editForm.get("amounts_payed").value<0),g.xp6(3),g.Q6J("ngIf",e.numberFormatCost.realValue<e.numberFormatCostNumber.realValue)}}function Vt(t,e){if(1&t){const t=g.EpF();g.ynx(0),g.TgZ(1,"div",1),g.TgZ(2,"div",2),g.TgZ(3,"div",3),g._uU(4),g.qZA(),g.TgZ(5,"button",4),g._UZ(6,"mat-icon",5),g.qZA(),g.qZA(),g.TgZ(7,"div",6),g.TgZ(8,"div"),g.YNc(9,Tt,1,1,"mat-progress-bar",7),g.qZA(),g.TgZ(10,"div",8),g.TgZ(11,"div",9),g.TgZ(12,"div",10),g.TgZ(13,"mat-form-field",11),g.TgZ(14,"mat-label"),g._uU(15),g.qZA(),g.TgZ(16,"input",12),g.NdJ("click",function(){return g.CHM(t),g.MAs(19).open()}),g.qZA(),g._UZ(17,"mat-datepicker-toggle",13),g._UZ(18,"mat-datepicker",null,14),g.qZA(),g.qZA(),g.TgZ(20,"div",10),g.TgZ(21,"mat-form-field",15),g.TgZ(22,"mat-label"),g._uU(23),g.qZA(),g.TgZ(24,"mat-select",16),g.TgZ(25,"mat-option",17),g._uU(26),g.qZA(),g.TgZ(27,"mat-option",18),g._uU(28),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.YNc(29,It,3,2,"div",19),g.TgZ(30,"div",10),g.TgZ(31,"mat-form-field",20),g.TgZ(32,"mat-label"),g._uU(33),g.qZA(),g.TgZ(34,"input",21,22),g.NdJ("keyup",function(e){return g.CHM(t),g.oxw().getValueCustomer(e.target.value)}),g.qZA(),g.TgZ(36,"mat-autocomplete",23,24),g.NdJ("optionSelected",function(e){return g.CHM(t),g.oxw().getValueCustomer(e.option.value)}),g.YNc(38,Ot,2,2,"mat-option",25),g.qZA(),g.qZA(),g.qZA(),g.YNc(39,kt,8,4,"div",26),g.YNc(40,Et,2,1,"div",26),g.TgZ(41,"div",27),g.YNc(42,Lt,6,3,"mat-form-field",28),g.YNc(43,Ht,8,4,"mat-form-field",29),g.qZA(),g.TgZ(44,"div",10),g.TgZ(45,"mat-form-field",20),g.TgZ(46,"mat-label"),g._uU(47),g.qZA(),g._UZ(48,"input",30),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.TgZ(49,"div",31),g.TgZ(50,"button",32),g.NdJ("click",function(){return g.CHM(t),g.oxw().save()}),g.TgZ(51,"span"),g._uU(52),g.qZA(),g.qZA(),g.TgZ(53,"button",33),g.TgZ(54,"span"),g._uU(55),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.BQk()}if(2&t){const t=e.$implicit,i=g.MAs(19),a=g.MAs(37),o=g.oxw();g.xp6(4),g.Oqu(t("TITLE")),g.xp6(1),g.Q6J("tabIndex",-1),g.xp6(1),g.Q6J("svgIcon","heroicons_outline:x"),g.xp6(1),g.Q6J("formGroup",o.editForm),g.xp6(2),g.Q6J("ngIf",o.savingFlag.pending),g.xp6(4),g.Q6J("hideRequiredMarker",!0),g.xp6(2),g.Oqu(t("DATE")),g.xp6(1),g.Q6J("max",o.maxDate)("min",o.minDate)("matDatepicker",i)("placeholder",t("DATE")),g.xp6(1),g.Q6J("for",i),g.xp6(6),g.Oqu(t("RECORD_TYPE")),g.xp6(1),g.Q6J("placeholder",t("TYPE")),g.xp6(2),g.hij("",t("INCOME")," "),g.xp6(2),g.hij("",t("EXPENSE")," "),g.xp6(1),g.Q6J("ngIf","0"==o.data.smallData.bill_id),g.xp6(4),g.Oqu(t("CUSTOMER")),g.xp6(1),g.Q6J("placeholder",t("CUSTOMER"))("matAutocomplete",a),g.xp6(4),g.Q6J("ngForOf",o.listCustomer),g.xp6(1),g.Q6J("ngIf","all_area"==o.editForm.value.typeAdd),g.xp6(1),g.Q6J("ngIf","all_area"!=o.editForm.value.typeAdd),g.xp6(2),g.Q6J("ngIf","0"==o.data.smallData.bill_id),g.xp6(1),g.Q6J("ngIf","out"==o.editForm.controls.type.value),g.xp6(4),g.Oqu(t("NOTE")),g.xp6(1),g.Q6J("placeholder",t("NOTE")),g.xp6(2),g.Q6J("color","primary")("disabled",!o.editForm.valid||"out"==o.editForm.controls.type.value&&o.numberFormatCost.realValue<o.numberFormatCostNumber.realValue),g.xp6(2),g.hij(" ",t("SAVE")," "),g.xp6(1),g.Q6J("color","secondary"),g.xp6(2),g.hij(" ",t("CANCEL")," ")}}let $t=(()=>{class t{constructor(t,e,i,a,o,n){this.data=t,this.dialogRef=e,this._alertService=i,this._translateService=a,this._moneyService=o,this._farmService=n,this.disableSelect=new d.NI(!1),this.numberFormatCost=new W.y(""),this.numberFormatCostNumber=new W.y(""),this.savingFlag=new m.E,this.minDate=u().startOf("month").format("YYYY-MM-DD"),this.maxDate=u().format("YYYY-MM-DD"),this.editForm=new d.cw({type:new d.NI("out",d.kI.required),typeAdd:new d.NI("farm",d.kI.required),title:new d.NI("",d.kI.required),amounts:new d.NI("",[d.kI.required]),amounts_payed:new d.NI("",[d.kI.required,d.kI.min(0)]),today:new d.NI(u().format("YYYY-MM-DD"),d.kI.required),group_id:new d.NI("",[d.kI.required]),title_customer:new d.NI(""),content_name:new d.NI("")}),this.pondSeleted=[],this.isFalshy=!1}ngOnInit(){console.log("dataEdit",this.data.smallData),this.getDataForListCategory(),this.pondSeleted=[{name:this._translateService.translate("SEASON.LIST.COST")+" "+this._translateService.translate("SEASON.DETAIL_MOD.FARM"),code:"",type:"farm"}],this.getListPond(),this.listOfBill=this.data.bigData.filter(t=>t.bill_id==this.data.smallData.id),console.log(this.data)}valueCheckBlur(){this.numberFormatCostNumber.fakeView=this.numberFormatCost.fakeView,this.numberFormatCostNumber.realValue=this.numberFormatCost.realValue,this.editForm.patchValue({amounts_payed:this.numberFormatCostNumber.realValue})}getDataForListCategory(){this._moneyService.fetchFinanceListCategory(this._farmService.fcode).pipe().subscribe(t=>{0==t.status?this._alertService.error(t.error):(this.listCategory=t.data,console.log(this.listCategory),this.buildFormData())},t=>{this._alertService.error(this._translateService.translate("CONNECT_ERROR")),this.dialogRef.close()})}buildFormData(){console.log(),this.numberFormatCost.setValue(this.data.smallData.amounts),this.numberFormatCostNumber.setValue(this.data.smallData.amounts_payed),this.editForm.patchValue({type:this.data.smallData.cr,typeAdd:0==this.data.smallData.pond_id?"farm":this.data.smallData.pond_id,title:this.data.smallData.title,amounts:this.numberFormatCost.fakeView,amounts_payed:this.numberFormatCostNumber.fakeView,today:u(1e3*this.data.smallData.add_time).format("YYYY-MM-DD"),group_id:this.data.smallData.group_id,title_customer:this.data.smallData.customer_name}),""!=this.data.smallData.code&&(this.editForm.patchValue({typeAdd:"all_area"}),console.log(this.data.smallData.code),this._moneyService.getGroup(this.data.smallData.code,this.data.smallData.cr).subscribe(t=>{if(1==t.status){console.log(t.data);let e=t.data.reduce((t,e)=>t+Number(e.amounts),0),i=t.data.reduce((t,e)=>t+Number(e.amounts_payed),0);console.log(e,i),this.editForm.patchValue({amounts:e,amounts_payed:i}),this.pondSeleted=t.data.reduce((t,e)=>{let i=this.listPonds.find(t=>t.code===e.pond_id);return i&&t.push({name:i.name,code:i.code,type:"all_area"}),t},[])}}))}getValueCustomer(t){""!==t?this._moneyService.searchCustomers({name:t,type:this.editForm.value.type}).pipe().subscribe(t=>{0==t.status?this._alertService.error(t.error):this.listCustomer=t.data},t=>{this._alertService.error(this._translateService.translate("CONNECT_ERROR"))}):this.listCustomer=[]}getListPond(){this._farmService.loadPonds().pipe().subscribe(t=>{if(0==t.status)this._alertService.error(t.error);else{if(this.listPonds=t.data,""==this.data.smallData.pond_id)this.pondSeleted=[{name:this._translateService.translate("SEASON.LIST.COST")+" "+this._translateService.translate("SEASON.DETAIL_MOD.FARM"),code:"",type:"farm"}];else{let t=this.listPonds.find(t=>t.code===this.data.smallData.pond_id);this.pondSeleted=[{name:t.name,code:t.code,type:""}]}console.log(this.listPonds)}},t=>{this._alertService.error(this._translateService.translate("CONNECT_ERROR")),this.dialogRef.close()})}chooseTypeAll(t){this.pondSeleted.find(e=>e.code===t.value)||this.pondSeleted.push(this.listPonds.find(e=>e.code===t.value))}chooseType(t){if(0==t.value)this.pondSeleted=[{name:this._translateService.translate("SEASON.LIST.COST")+" "+this._translateService.translate("SEASON.DETAIL_MOD.FARM"),code:"",type:"farm"}];else{let e=this.listPonds.find(e=>e.code===t.value);this.pondSeleted=[{name:e.name,code:e.code,type:""}]}}validateNo(t){const e=t.which?t.which:t.keyCode;return!(e>31&&(e<48||e>57))}removePond(t){this.pondSeleted.length>1&&this.pondSeleted.splice(t,1)}save(){if(console.log(this.pondSeleted),this.listOfBill.length>0)for(var t of(console.log("listOfBill start",this.listOfBill),this.listOfBill)){let e={type:"out",typeAdd:this.editForm.value.typeAdd,pond_id:this.pondSeleted.map(t=>t.code)[0],ponds:this.pondSeleted.map(t=>t.code),title:t.title,amounts:t.amounts,amounts_payed:t.amounts_payed,today:t.add_time,fcode:this._farmService.fcode,accounting_by:t.accounting_by,group_id:"4",customer_name:this.editForm.value.customer_name,bill_id:t.bill_id,confirm:"0"};const i=t.id,a=e.type;this.savingFlag.setStart(!0),this.savingFlag.setPending(!0),this._moneyService.updateRecord(i,a,e).pipe().subscribe(t=>{0==t.status?this._alertService.error(t.error):this.dialogRef.close(e),this.savingFlag.setResult(!0)},t=>{this._alertService.error(this._translateService.translate("CONNECT_ERROR")),this.savingFlag.setPending(!1)})}let e={id:this.data.smallData.id,pond_id:this.pondSeleted.map(t=>t.code)[0],type:this.data.smallData.cr,typeAdd:this.editForm.value.typeAdd,ponds:this.pondSeleted.map(t=>t.code),title:this.editForm.value.title,amounts:this.numberFormatCost.realValue,amounts_payed:this.numberFormatCostNumber.realValue,today:u(this.editForm.value.today).unix(),fcode:this._farmService.fcode,accounting_by:this.data.smallData.accounting_by,group_id:this.editForm.value.group_id,customer_name:this.editForm.value.title_customer};if(""!=this.data.smallData.code)console.log(e),e.typeAdd="all_same",e.amounts=this.editForm.value.amounts,console.log(this.editForm.value),this._moneyService.editGroup(e).pipe().subscribe(t=>{(t.status=1)?(console.log(t.data),this.dialogRef.close(e)):this._alertService.error(t.error)},t=>{this._alertService.error(this._translateService.translate("CONNECT_ERROR")),this.savingFlag.setResult(!1)});else{const t=this.data.smallData.id,i=e.type;this.savingFlag.setStart(!0),this.savingFlag.setPending(!0),this._moneyService.updateRecord(t,i,e).pipe().subscribe(t=>{0==t.status?this._alertService.error(t.error):this.dialogRef.close(e),this.savingFlag.setResult(!0)},t=>{this._alertService.error(this._translateService.translate("CONNECT_ERROR")),this.savingFlag.setResult(!1)})}}saveGroup(){if(""!=this.editForm.value.content_name){let t={name:this.editForm.value.content_name,type:this.editForm.value.type};console.log("name_type",t),this._moneyService.addGroups(t).pipe().subscribe(e=>{if(0==e.status){this._alertService.success("Kh\xf4ng th\u1ec3 th\xeam nh\xf3m \u0111\xe3 c\xf3 s\u1eb5n, \u0111\xe3 ch\u1ecdn gi\xfap!!"),console.log("error");let e=[];for(var i in this.listCategory)e.push(this.listCategory[i]);const a=e.filter(e=>e.name==t.name&&e.type==t.type);this.editForm.patchValue({group_id:a[0].id}),this.isFalshy=!1}else console.log("id",e.data),setTimeout(()=>{let t=[];for(var i in this.listCategory)t.push(this.listCategory[i]);const a=t.filter(t=>t.id==e.data);this.editForm.patchValue({group_id:a[0].id}),this.isFalshy=!1},1e3);this.savingFlag.setResult(!0)},t=>{this.getDataForListCategory(),this.savingFlag.setResult(!1)})}}}return t.\u0275fac=function(e){return new(e||t)(g.Y36(J.WI),g.Y36(J.so),g.Y36(Z.c),g.Y36(n.Vn),g.Y36(h.r),g.Y36(f.D))},t.\u0275cmp=g.Xpm({type:t,selectors:[["app-finance-edit"]],decls:1,vars:1,consts:[[4,"transloco","translocoRead"],[1,"flex","flex-col","max-h-screen","max-w-240","md:min-w-160","-m-6"],[1,"flex","flex-0","items-center","justify-between","h-16","pr-3","sm:pr-5","pl-6","sm:pl-8","bg-primary","text-on-primary"],[1,"text-lg","font-medium"],["mat-icon-button","","mat-dialog-close","",3,"tabIndex"],[1,"text-current",3,"svgIcon"],[1,"flex","flex-col","flex-auto","p-6","sm:p-8","overflow-y-auto",3,"formGroup"],[3,"mode",4,"ngIf"],[1,"w-full"],[1,"flex","flex-col","w-full"],[1,"flex"],[1,"flex-auto",3,"hideRequiredMarker"],["matInput","","formControlName","today","required","",3,"max","min","matDatepicker","placeholder","click"],["matSuffix","",3,"for"],["picker",""],[1,"flex-auto","pointer-events-none"],["formControlName","type",3,"placeholder"],["value","in"],["value","out"],["class","flex",4,"ngIf"],[1,"flex-auto"],["matInput","","formControlName","title_customer",3,"placeholder","matAutocomplete","keyup"],["ip",""],[3,"optionSelected"],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"flex","justify-between"],["class","flex-auto mr-4",4,"ngIf"],["class","flex-auto",4,"ngIf"],["matInput","","formControlName","title",3,"placeholder"],[1,"flex","flex-0","items-center","justify-end","h-16","pr-3","sm:pr-5","pl-6","sm:pl-8"],["mat-flat-button","",1,"fuse-mat-button","mr-3",3,"color","disabled","click"],["mat-flat-button","","mat-dialog-close","",1,"fuse-mat-button",3,"color"],[3,"mode"],["class","flex w-full",4,"ngIf"],[1,"flex","w-full"],["class","example-full-width w-full","appearance","fill",4,"ngIf"],["class"," flex-auto",4,"ngIf"],["svgIcon","mat_outline:add_circle_outline",1,"cursor-pointer","h-full","text-blue-700",3,"click"],["appearance","fill",1,"example-full-width","w-full"],["placeholder","Th\xeam nh\xf3m","matInput","","formControlName","content_name",3,"focusout"],[3,"click"],["formControlName","group_id","required","",3,"placeholder"],[4,"ngFor","ngForOf"],[3,"value",4,"ngIf"],[3,"value"],["matInput","","placeholder","Th\xeam nh\xf3m","formControlName","content_name",3,"focusout"],[3,"placeholder","selectionChange"],["class","flex mb-1",4,"ngIf"],[1,"flex","mb-1"],["aria-label","Pond selection"],["color","success",3,"click",4,"ngFor","ngForOf"],["color","success",3,"click"],[1,"ml-1"],["color","success",4,"ngFor","ngForOf"],["color","success"],[1,"flex-auto","mr-4"],["matInput","","formControlName","amounts",3,"placeholder","value","input","keypress"],["matInput","","formControlName","amounts_payed","required","",3,"placeholder","value","input","keypress"],[1,"text-red-500"]],template:function(t,e){1&t&&g.YNc(0,Vt,56,32,"ng-container",0),2&t&&g.Q6J("translocoRead","FARM.EDIT")},directives:[n.KI,A.lW,J.ZT,_.Hw,d.JL,d.sg,a.O5,v.KE,v.hX,b.Nt,d.Fj,T.hl,d.JJ,d.u,d.Q7,T.nW,v.R9,T.Mq,xt.gD,_t.ey,vt.ZL,vt.XC,a.sg,q.pW,bt.qn,bt.HS,v.TO,v.bx],pipes:[a.Nd],styles:[""]}),t})();function Bt(t,e){1&t&&g._UZ(0,"mat-progress-bar",23),2&t&&g.Q6J("mode","indeterminate")}function Wt(t,e){if(1&t&&(g.TgZ(0,"mat-option",27),g._uU(1),g.qZA()),2&t){const t=e.$implicit;g.Q6J("value",t.code),g.xp6(1),g.hij("",t.name," ")}}function Gt(t,e){if(1&t){const t=g.EpF();g.TgZ(0,"mat-chip",31),g.NdJ("click",function(){const e=g.CHM(t).index;return g.oxw(4).removePond(e)}),g._uU(1),g.TgZ(2,"mat-icon",32),g._uU(3,"cancel"),g.qZA(),g.qZA()}if(2&t){const t=e.$implicit;g.xp6(1),g.hij(" ",t.name," ")}}function Kt(t,e){if(1&t&&(g.TgZ(0,"div",28),g.TgZ(1,"mat-chip-list",29),g.YNc(2,Gt,4,1,"mat-chip",30),g.qZA(),g.qZA()),2&t){const t=g.oxw(3);g.xp6(2),g.Q6J("ngForOf",t.pondSeleted)}}function Xt(t,e){if(1&t){const t=g.EpF();g.TgZ(0,"div"),g.TgZ(1,"div",10),g.TgZ(2,"mat-form-field",17),g.TgZ(3,"mat-label"),g._uU(4),g.qZA(),g.TgZ(5,"mat-select",24),g.NdJ("selectionChange",function(e){return g.CHM(t),g.oxw(2).chooseTypeAll(e)}),g.YNc(6,Wt,2,2,"mat-option",25),g.qZA(),g.qZA(),g.qZA(),g.YNc(7,Kt,3,1,"div",26),g.qZA()}if(2&t){const t=g.oxw().$implicit,e=g.oxw();g.xp6(4),g.Oqu(t("POND")),g.xp6(1),g.Q6J("placeholder",t("TYPE")),g.xp6(1),g.Q6J("ngForOf",e.listPonds),g.xp6(1),g.Q6J("ngIf",e.pondSeleted.length>0)}}function zt(t,e){if(1&t&&(g.TgZ(0,"mat-chip",34),g._uU(1),g.qZA()),2&t){const t=e.$implicit;g.xp6(1),g.hij(" ",t.name," ")}}function te(t,e){if(1&t&&(g.TgZ(0,"div",28),g.TgZ(1,"mat-chip-list",29),g.YNc(2,zt,2,1,"mat-chip",33),g.qZA(),g.qZA()),2&t){const t=g.oxw(3);g.xp6(2),g.Q6J("ngForOf",t.pondSeleted)}}function ee(t,e){if(1&t&&(g.TgZ(0,"div"),g.YNc(1,te,3,1,"div",26),g.qZA()),2&t){const t=g.oxw(2);g.xp6(1),g.Q6J("ngIf",t.pondSeleted.length>0)}}function ie(t,e){if(1&t){const t=g.EpF();g.TgZ(0,"mat-form-field",17),g.TgZ(1,"mat-label"),g._uU(2,"S\u1ed1 ti\u1ec1n c\xf2n n\u1ee3"),g.qZA(),g.TgZ(3,"input",35,36),g.NdJ("keypress",function(e){return g.CHM(t),g.oxw(2).validateNo(e)}),g.qZA(),g.TgZ(5,"mat-error"),g._uU(6," Vui l\xf2ng nh\u1eadp s\u1ed1 "),g.qZA(),g.qZA()}if(2&t){const t=g.oxw().$implicit,e=g.oxw();g.xp6(3),g.Q6J("placeholder",t("AMOUNT"))("max",e.data.smallData.amounts-e.data.smallData.amounts_payed-e.totalDebtConfirmed)}}function ae(t,e){if(1&t){const t=g.EpF();g.ynx(0),g.TgZ(1,"div",1),g.TgZ(2,"div",2),g.TgZ(3,"div",3),g._uU(4),g.qZA(),g.TgZ(5,"button",4),g._UZ(6,"mat-icon",5),g.qZA(),g.qZA(),g.TgZ(7,"div",6),g.TgZ(8,"div"),g.YNc(9,Bt,1,1,"mat-progress-bar",7),g.qZA(),g.TgZ(10,"div",8),g.TgZ(11,"div",9),g.TgZ(12,"div",10),g.TgZ(13,"mat-form-field",11),g.TgZ(14,"mat-label"),g._uU(15),g.qZA(),g.TgZ(16,"input",12),g.NdJ("click",function(){return g.CHM(t),g.MAs(19).open()}),g.qZA(),g._UZ(17,"mat-datepicker-toggle",13),g._UZ(18,"mat-datepicker",null,14),g.qZA(),g.qZA(),g.YNc(20,Xt,8,4,"div",15),g.YNc(21,ee,2,1,"div",15),g.TgZ(22,"div",16),g.TgZ(23,"mat-form-field",17),g.TgZ(24,"mat-label"),g._uU(25),g.qZA(),g._UZ(26,"input",18),g.qZA(),g.YNc(27,ie,7,2,"mat-form-field",19),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.TgZ(28,"div",20),g.TgZ(29,"button",21),g.NdJ("click",function(){return g.CHM(t),g.oxw().save()}),g.TgZ(30,"span"),g._uU(31),g.qZA(),g.qZA(),g.TgZ(32,"button",22),g.TgZ(33,"span"),g._uU(34),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.BQk()}if(2&t){const t=e.$implicit,i=g.MAs(19),a=g.oxw();g.xp6(4),g.Oqu(t("PAY")),g.xp6(1),g.Q6J("tabIndex",-1),g.xp6(1),g.Q6J("svgIcon","heroicons_outline:x"),g.xp6(1),g.Q6J("formGroup",a.payForm),g.xp6(2),g.Q6J("ngIf",a.savingFlag.pending),g.xp6(4),g.Q6J("hideRequiredMarker",!0),g.xp6(2),g.Oqu(t("DATE")),g.xp6(1),g.Q6J("min",a.minDate)("max",a.date.toDate())("matDatepicker",i)("placeholder",t("DATE")),g.xp6(1),g.Q6J("for",i),g.xp6(3),g.Q6J("ngIf","all_area"==a.payForm.value.typeAdd),g.xp6(1),g.Q6J("ngIf","all_area"!=a.payForm.value.typeAdd),g.xp6(4),g.Oqu(t("NOTE")),g.xp6(1),g.Q6J("placeholder",t("NOTE")),g.xp6(1),g.Q6J("ngIf","out"==a.payForm.controls.type.value),g.xp6(2),g.Q6J("color","primary")("disabled",!a.payForm.valid),g.xp6(2),g.hij(" ",t("SAVE")," "),g.xp6(1),g.Q6J("color","secondary"),g.xp6(2),g.hij(" ",t("CANCEL")," ")}}let oe=(()=>{class t{constructor(t,e,i,a,o,n){this.data=t,this.dialogRef=e,this._alertService=i,this._translateService=a,this._moneyService=o,this._farmService=n,this.disableSelect=new d.NI(!1),this.numberFormatCost=new W.y(""),this.numberFormatCostNumber=new W.y(""),this.savingFlag=new m.E,this.totalDebtConfirmed=0,this.date=u(),this.payForm=new d.cw({type:new d.NI("out",d.kI.required),typeAdd:new d.NI("farm",d.kI.required),title:new d.NI("",d.kI.required),amounts:new d.NI("",[d.kI.required]),amounts_payed:new d.NI("",[d.kI.required,d.kI.min(0)]),today:new d.NI(u().format("YYYY-MM-DD"),d.kI.required),group_id:new d.NI("",d.kI.required),payDebt:new d.NI("",d.kI.required)}),this.pondSeleted=[]}ngOnInit(){var t;this.getDataForListCategory(),this.getListPond(),this.minDate=new Date(1e3*this.data.smallData.add_time);const e=this.data.bigData.filter(t=>t.bill_id==this.data.smallData.id&&1==t.confirm);this.totalDebtConfirmed=e.length>1?e.reduce((t,e)=>t+Number(e.amounts),0):Number(null===(t=e[0])||void 0===t?void 0:t.amounts),0==e.length&&(this.totalDebtConfirmed=0)}getDataForListCategory(){this._moneyService.fetchFinanceListCategory(this._farmService.fcode).pipe().subscribe(t=>{0==t.status?this._alertService.error(t.error):(this.listCategory=t.data,this.buildFormData(),console.log("\ud83d\ude80\ud83d\ude80\ud83c\udf89 >>> this.listCategory",this.listCategory))},t=>{this._alertService.error(this._translateService.translate("CONNECT_ERROR")),this.dialogRef.close()})}buildFormData(){this.numberFormatCost.setValue(this.data.smallData.amounts),this.numberFormatCostNumber.setValue(this.data.smallData.amounts_payed),this.payForm.patchValue({type:this.data.smallData.cr,typeAdd:0==this.data.smallData.pond_id?"farm":this.data.smallData.pond_id,title:"Thanh toan bill #"+this.data.smallData.id,payDebt:Number(this.data.smallData.amounts)-Number(this.data.smallData.amounts_payed)-Number(this.totalDebtConfirmed),amounts:this.numberFormatCost.fakeView,amounts_payed:this.numberFormatCostNumber.fakeView,today:this.payForm.value.today,group_id:this.data.smallData.group_id,customer_name:this.data.smallData.customer_name})}getListPond(){this._farmService.loadPonds().pipe().subscribe(t=>{0==t.status?this._alertService.error(t.error):this.listPonds=t.data},t=>{this._alertService.error(this._translateService.translate("CONNECT_ERROR")),this.dialogRef.close()})}validateNo(t){const e=t.which?t.which:t.keyCode;return!(e>31&&(e<48||e>57))}save(){this.savingFlag.setPending(!0);let t={id:this.data.smallData.id,type:this.payForm.value.type,typeAdd:"farm",ponds:this.pondSeleted.map(t=>t.code),title:this.payForm.value.title,amounts:this.payForm.value.payDebt,amounts_payed:this.payForm.value.payDebt,today:u(this.payForm.value.today).unix(),fcode:this._farmService.fcode,accounting_by:this.data.smallData.accounting_by,group_id:"4",payDebt:this.payForm.value.payDebt,customer_name:this.data.smallData.customer_name,bill_id:this.data.smallData.id};console.log("param of fastpay",t),this.savingFlag.setStart(!0),this.savingFlag.setPending(!0),this._moneyService.createRecord(t).pipe().subscribe(e=>{0==e.status?this._alertService.error(e.error):this.dialogRef.close(t),this.savingFlag.setResult(!0)},t=>{this._alertService.error(this._translateService.translate("CONNECT_ERROR")),this.savingFlag.setResult(!1)})}}return t.\u0275fac=function(e){return new(e||t)(g.Y36(J.WI),g.Y36(J.so),g.Y36(Z.c),g.Y36(n.Vn),g.Y36(h.r),g.Y36(f.D))},t.\u0275cmp=g.Xpm({type:t,selectors:[["app-finance-pay"]],decls:1,vars:1,consts:[[4,"transloco","translocoRead"],[1,"flex","flex-col","max-w-240","md:min-w-160","-m-6"],[1,"flex","flex-0","items-center","justify-between","h-16","pr-3","sm:pr-5","pl-6","sm:pl-8","bg-primary","text-on-primary"],[1,"text-lg","font-medium"],["mat-icon-button","","mat-dialog-close","",3,"tabIndex"],[1,"text-current",3,"svgIcon"],[1,"flex","flex-col","flex-auto","p-6","sm:p-8","overflow-y-auto",3,"formGroup"],[3,"mode",4,"ngIf"],[1,"w-full"],[1,"flex","flex-col","w-full"],[1,"flex"],[1,"flex-auto",3,"hideRequiredMarker"],["matInput","","formControlName","today","required","",3,"min","max","matDatepicker","placeholder","click"],["matSuffix","",3,"for"],["picker",""],[4,"ngIf"],[1,"flex","flex-col"],[1,"flex-auto"],["matInput","","formControlName","title",3,"placeholder"],["class","flex-auto",4,"ngIf"],[1,"flex","flex-0","items-center","justify-end","h-16","pr-3","sm:pr-5","pl-6","sm:pl-8"],["mat-flat-button","",1,"fuse-mat-button","mr-3",3,"color","disabled","click"],["mat-flat-button","","mat-dialog-close","",1,"fuse-mat-button",3,"color"],[3,"mode"],[3,"placeholder","selectionChange"],[3,"value",4,"ngFor","ngForOf"],["class","flex mb-1",4,"ngIf"],[3,"value"],[1,"flex","mb-1"],["aria-label","Pond selection"],["color","success",3,"click",4,"ngFor","ngForOf"],["color","success",3,"click"],[1,"ml-1"],["color","success",4,"ngFor","ngForOf"],["color","success"],["matInput","","type","number","min","1","formControlName","payDebt","required","",3,"placeholder","max","keypress"],["ip",""]],template:function(t,e){1&t&&g.YNc(0,ae,35,22,"ng-container",0),2&t&&g.Q6J("translocoRead","FARM.EDIT")},directives:[n.KI,A.lW,J.ZT,_.Hw,d.JL,d.sg,a.O5,v.KE,v.hX,b.Nt,d.Fj,T.hl,d.JJ,d.u,d.Q7,T.nW,v.R9,T.Mq,q.pW,xt.gD,a.sg,_t.ey,bt.qn,bt.HS,d.qQ,d.wV,d.Fd,v.TO],styles:[""]}),t})();function ne(t,e){if(1&t&&(g.TgZ(0,"div",13),g.TgZ(1,"div",9),g._uU(2),g.ALo(3,"date"),g.qZA(),g.TgZ(4,"div",10),g._uU(5),g.qZA(),g.TgZ(6,"div",9),g._uU(7),g.qZA(),g.TgZ(8,"div",14),g._uU(9),g.ALo(10,"number"),g.qZA(),g.qZA()),2&t){const t=e.$implicit;g.xp6(2),g.hij(" ",g.xi3(3,4,1e3*t.add_time,"dd/MM/yyyy")," "),g.xp6(3),g.hij(" ",t.title," "),g.xp6(2),g.hij(" ",t.customer_name," "),g.xp6(2),g.hij(" ",g.xi3(10,7,t.debt_payed,"0.0-0")," \u0111 ")}}function se(t,e){if(1&t&&(g.ynx(0),g.TgZ(1,"div",1),g.TgZ(2,"div",2),g.TgZ(3,"div",3),g._uU(4,"Kh\xe1ch h\xe0ng"),g.qZA(),g.TgZ(5,"button",4),g._UZ(6,"mat-icon",5),g.qZA(),g.qZA(),g.TgZ(7,"div",6),g.TgZ(8,"div",7),g.TgZ(9,"div",8),g.TgZ(10,"div",9),g._uU(11),g.qZA(),g.TgZ(12,"div",10),g._uU(13),g.qZA(),g.TgZ(14,"div",9),g._uU(15),g.qZA(),g.TgZ(16,"div",9),g._uU(17),g.qZA(),g.qZA(),g.TgZ(18,"div",11),g.YNc(19,ne,11,10,"div",12),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.BQk()),2&t){const t=e.$implicit,i=g.oxw();g.xp6(5),g.Q6J("tabIndex",-1),g.xp6(1),g.Q6J("svgIcon","heroicons_outline:x"),g.xp6(5),g.hij(" ",t("DAY")," "),g.xp6(2),g.hij(" ",t("CONTENT")," "),g.xp6(2),g.hij(" ",t("COMPANY")," "),g.xp6(2),g.hij(" ",t("DEBT")," "),g.xp6(2),g.Q6J("ngForOf",i.listDebtCustomers)}}let re=(()=>{class t{constructor(t,e,i,a,o,n,s){this.data=t,this.dialogRef=e,this.farmService=i,this._alertService=a,this._translateService=o,this._moneyService=n,this._farmService=s,this.addForm=new d.cw({}),this.arrCustomer=[],this.listDebtCustomers=[]}ngOnInit(){console.log(this.data),this.data.filter(t=>""!==t.customer_name).filter(t=>{for(var e of[t])this.arrCustomer.push(e.customer_name),this._moneyService.getDebtCustomers(e.customer_name.replace(/ /g,"-")).pipe().subscribe(t=>{0==t.status?this._alertService.error(t.error):0!==t.data.length&&t.data.map(t=>{console.log(t),this.listDebtCustomers.push(t)})},t=>{this._alertService.error(this._translateService.translate("CONNECT_ERROR"))})})}}return t.\u0275fac=function(e){return new(e||t)(g.Y36(J.WI),g.Y36(J.so),g.Y36(f.D),g.Y36(Z.c),g.Y36(n.Vn),g.Y36(h.r),g.Y36(f.D))},t.\u0275cmp=g.Xpm({type:t,selectors:[["app-finance-totalM"]],decls:1,vars:1,consts:[[4,"transloco","translocoRead"],[1,"flex","flex-col","max-w-240","md:min-w-160","-m-6","max-h-screen","-m-6"],[1,"flex","flex-0","items-center","justify-between","h-16","pr-3","sm:pr-5","pl-6","sm:pl-8","bg-primary","text-on-primary"],[1,"text-lg","font-medium"],["mat-icon-button","","mat-dialog-close","",3,"tabIndex"],[1,"text-current",3,"svgIcon"],[1,"bg-card","shadow","rounded-2xl","overflow-hidden","w-full","mt-6"],[1,"grid"],[1,"grid-cols-9","z-10","sticky","top-0","grid","gap-4","py-4","px-8","shadow","text-md","font-semibold","bg-gray-50"],[1,"col-span-2"],[1,"col-span-3"],[1,"max-h-160","overflow-y-auto"],["class","grid-cols-9 grid items-center gap-4 py-3 px-8 border-b",4,"ngFor","ngForOf"],[1,"grid-cols-9","grid","items-center","gap-4","py-3","px-8","border-b"],[1,"col-span-2","text-red-500"]],template:function(t,e){1&t&&g.YNc(0,se,20,7,"ng-container",0),2&t&&g.Q6J("translocoRead","")},directives:[n.KI,A.lW,J.ZT,_.Hw,a.sg],pipes:[a.uU,a.JJ],styles:[".transform[_ngcontent-%COMP%]{transform:rotate(45deg)}"]}),t})();var le=i(99692);const ce=["paginator"];function de(t,e){1&t&&g._UZ(0,"mat-progress-bar",54),2&t&&g.Q6J("mode","indeterminate")}const me=function(t,e){return{"text-green-500":t,"text-red-500":e}};function ue(t,e){if(1&t&&(g.TgZ(0,"div",57),g.TgZ(1,"span"),g._uU(2),g.qZA(),g._uU(3),g.ALo(4,"number"),g.qZA()),2&t){const t=g.oxw(3);g.Q6J("ngClass",g.WLB(6,me,t.dataTotalList>0,t.dataTotalList<0)),g.xp6(2),g.hij(" ",t.dataTotalList>0?"+":"",""),g.xp6(1),g.hij(" ",g.xi3(4,3,t.dataTotalList,"0.0-0")," \u0111 ")}}function pe(t,e){if(1&t&&(g.TgZ(0,"div",21),g.TgZ(1,"div",55),g.TgZ(2,"div",23),g._uU(3,"S\u1ed1 d\u01b0 : "),g.qZA(),g.qZA(),g.YNc(4,ue,5,9,"div",56),g.qZA()),2&t){const t=g.oxw(2);g.xp6(4),g.Q6J("ngIf",0===t.totalList.total_in)}}function ge(t,e){1&t&&(g.TgZ(0,"div",55),g._uU(1," C\xf4ng n\u1ee3 "),g.qZA())}function he(t,e){if(1&t&&(g.TgZ(0,"div",25),g.TgZ(1,"span"),g._uU(2),g.qZA(),g._uU(3),g.ALo(4,"number"),g.qZA()),2&t){const t=g.oxw(2);g.Q6J("ngClass",g.WLB(6,me,t.end_surplus>0,t.end_surplus<0)),g.xp6(2),g.hij(" ",t.end_surplus>0?"+":"",""),g.xp6(1),g.hij(" ",g.xi3(4,3,t.end_surplus,"0.0-0")," \u0111 ")}}function fe(t,e){if(1&t&&(g.TgZ(0,"div",58),g._uU(1),g.ALo(2,"number"),g.qZA()),2&t){const t=g.oxw(2);g.xp6(1),g.hij(" ",g.xi3(2,1,t.totalList.total_in,"0.0-0")," \u0111 ")}}function Ze(t,e){if(1&t&&(g.TgZ(0,"div",25),g.TgZ(1,"span"),g._uU(2),g.qZA(),g._uU(3),g.ALo(4,"number"),g.qZA()),2&t){const t=g.oxw(2);g.Q6J("ngClass",g.WLB(6,me,t.end_surplus>0,t.end_surplus<0)),g.xp6(2),g.hij(" ",t.end_surplus>0?"+":"",""),g.xp6(1),g.hij(" ",g.xi3(4,3,t.end_surplus,"0.0-0")," \u0111 ")}}function xe(t,e){if(1&t&&(g.TgZ(0,"div",58),g._uU(1),g.ALo(2,"number"),g.qZA()),2&t){const t=g.oxw(3);g.xp6(1),g.hij(" ",g.xi3(2,1,t.totalList.total_debt,"0.0-0")," \u0111 ")}}function _e(t,e){if(1&t&&(g.TgZ(0,"div",25),g._uU(1),g.ALo(2,"number"),g.qZA()),2&t){const t=g.oxw(3);g.Q6J("ngClass",g.WLB(5,me,t.end_surplus-t.head_surplus>0,t.end_surplus-t.head_surplus<0)),g.xp6(1),g.hij(" ",g.xi3(2,2,t.end_surplus-t.head_surplus,"0.0-0")," \u0111 ")}}function ve(t,e){if(1&t&&(g.TgZ(0,"div",21),g._UZ(1,"div",59),g.YNc(2,xe,3,4,"div",26),g.YNc(3,_e,3,8,"div",24),g.qZA()),2&t){const t=g.oxw(2);g.xp6(2),g.Q6J("ngIf","0"===t.dataTotalList),g.xp6(1),g.Q6J("ngIf",0!==t.totalList.total_in)}}function be(t,e){1&t&&g._UZ(0,"mat-progress-bar",54),2&t&&g.Q6J("mode","indeterminate")}function Te(t,e){if(1&t){const t=g.EpF();g.TgZ(0,"button",14),g.NdJ("click",function(){g.CHM(t);const e=g.oxw(3).$implicit;return g.oxw(2).payment(e)}),g._UZ(1,"mat-icon",70),g.TgZ(2,"span"),g._uU(3),g.qZA(),g.qZA()}if(2&t){const t=g.oxw(4).$implicit;g.xp6(3),g.Oqu(t("PAY"))}}function Ae(t,e){if(1&t&&(g.TgZ(0,"div"),g.YNc(1,Te,4,1,"button",69),g.qZA()),2&t){const t=g.oxw(2).$implicit;g.xp6(1),g.Q6J("ngIf","out"===t.cr)}}function ye(t,e){if(1&t){const t=g.EpF();g.TgZ(0,"div",61),g.TgZ(1,"div",48),g.TgZ(2,"mat-checkbox",62),g.NdJ("change",function(e){g.CHM(t);const i=g.oxw().$implicit;return g.oxw(2).setDone(i,e)}),g.qZA(),g.qZA(),g.TgZ(3,"div",48),g._uU(4),g.ALo(5,"date"),g.qZA(),g.TgZ(6,"div",49),g._uU(7),g.qZA(),g.TgZ(8,"div",48),g._uU(9),g.qZA(),g.TgZ(10,"div",63),g._uU(11),g.ALo(12,"number"),g.qZA(),g.TgZ(13,"div"),g.TgZ(14,"button",64),g.NdJ("click",function(){g.CHM(t);const e=g.oxw().$implicit;return g.oxw(2).sendItem(e)}),g._UZ(15,"mat-icon",11),g.qZA(),g.TgZ(16,"mat-menu",null,12),g.TgZ(18,"button",14),g.NdJ("click",function(){g.CHM(t);const e=g.oxw().$implicit;return g.oxw(2).downloadItem(e)}),g._UZ(19,"mat-icon",65),g.TgZ(20,"span"),g._uU(21,"Xu\u1ea5t"),g.qZA(),g.qZA(),g.TgZ(22,"button",14),g.NdJ("click",function(){g.CHM(t);const e=g.oxw().$implicit;return g.oxw(2).updateRecord(e)}),g._UZ(23,"mat-icon",66),g.TgZ(24,"span"),g._uU(25),g.qZA(),g.qZA(),g.YNc(26,Ae,2,1,"div",67),g.TgZ(27,"button",14),g.NdJ("click",function(){g.CHM(t);const e=g.oxw().$implicit;return g.oxw(2).confirmDelete(e)}),g._UZ(28,"mat-icon",68),g.TgZ(29,"span"),g._uU(30),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA()}if(2&t){const t=g.MAs(17),e=g.oxw().$implicit,i=g.oxw().$implicit,a=g.oxw();g.Q6J("title","S\u1ed1 ti\u1ec1n c\xf2n n\u1ee3 l\xe0:"),g.xp6(2),g.Q6J("color","primary")("checked",1==e.confirm)("disabled","company_manager"!=a._farmService.permission),g.xp6(2),g.hij(" ",g.xi3(5,13,1e3*e.add_time,"dd/MM/yyyy")," "),g.xp6(3),g.hij(" ",e.title," "),g.xp6(2),g.hij(" ",e.pond," "),g.xp6(1),g.Q6J("ngClass",g.WLB(19,me,"in"===e.cr,"out"===e.cr)),g.xp6(1),g.hij(" ",g.xi3(12,16,e.amounts_payed,"0.0-0")," \u0111 "),g.xp6(3),g.Q6J("matMenuTriggerFor",t),g.xp6(11),g.Oqu(i("EDIT")),g.xp6(1),g.Q6J("ngIf",e.amounts-e.amounts_payed-a.totalDebtConfirmed!=0),g.xp6(4),g.Oqu(i("DELETE"))}}function qe(t,e){if(1&t&&(g.TgZ(0,"div"),g.YNc(1,ye,31,22,"div",60),g.qZA()),2&t){const t=e.$implicit;g.xp6(1),g.Q6J("ngIf",0!=t.amounts||0!=t.amounts_payed)}}function Fe(t,e){if(1&t){const t=g.EpF();g.ynx(0),g.TgZ(1,"div",1),g.TgZ(2,"div",2),g.TgZ(3,"div",3),g._uU(4),g.qZA(),g.TgZ(5,"div",4),g.TgZ(6,"button",5),g.NdJ("click",function(){g.CHM(t);const e=g.oxw();return e.presentAdd(e.item)}),g.TgZ(7,"span",6),g._uU(8),g.qZA(),g._UZ(9,"mat-icon",7),g.qZA(),g.TgZ(10,"button",8),g.TgZ(11,"span",6),g._uU(12,"C\xf4ng n\u1ee3"),g.qZA(),g._UZ(13,"mat-icon",9),g.qZA(),g.TgZ(14,"button",5),g.NdJ("click",function(){return g.CHM(t),g.oxw().handleOpenEditDialogMoney()}),g.TgZ(15,"span",6),g._uU(16,"Ch\u1ec9nh ti\u1ec1n m\u1eb7t"),g.qZA(),g._UZ(17,"mat-icon",7),g.qZA(),g.TgZ(18,"button",10),g.TgZ(19,"span",6),g._uU(20,"B\xe1o c\xe1o"),g.qZA(),g._UZ(21,"mat-icon",11),g.qZA(),g.TgZ(22,"mat-menu",null,12),g.TgZ(24,"button",13),g.TgZ(25,"span"),g._uU(26,"Xem"),g.qZA(),g.qZA(),g.TgZ(27,"button",14),g.NdJ("click",function(){return g.CHM(t),g.oxw().exportFund()}),g.TgZ(28,"span"),g._uU(29,"Xu\u1ea5t t\u1ed3n qu\u1ef9"),g.qZA(),g.qZA(),g.TgZ(30,"button",14),g.NdJ("click",function(){return g.CHM(t),g.oxw().exportCost()}),g.TgZ(31,"span"),g._uU(32,"Xu\u1ea5t chi ph\xed"),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.TgZ(33,"mat-accordion",15),g.TgZ(34,"div"),g.YNc(35,de,1,1,"mat-progress-bar",16),g.qZA(),g.TgZ(36,"mat-expansion-panel",17),g.NdJ("opened",function(){return g.CHM(t),g.oxw().panelOpenState=!0})("closed",function(){return g.CHM(t),g.oxw().panelOpenState=!1}),g.TgZ(37,"mat-expansion-panel-header"),g.TgZ(38,"mat-panel-title"),g._uU(39," C\xf4ng n\u1ee3 "),g.qZA(),g.TgZ(40,"mat-panel-description"),g.YNc(41,pe,5,1,"div",18),g.YNc(42,ge,2,0,"div",19),g.TgZ(43,"mat-icon"),g._uU(44,"attach_money"),g.qZA(),g.qZA(),g.qZA(),g.TgZ(45,"div",20),g.TgZ(46,"div",21),g.TgZ(47,"div",22),g.TgZ(48,"div",23),g._uU(49,"Ti\u1ec1n M\u1eb7t:"),g.qZA(),g.qZA(),g.YNc(50,he,5,9,"div",24),g.qZA(),g.TgZ(51,"div",21),g.TgZ(52,"div",22),g.TgZ(53,"div",23),g._uU(54,"D\u01b0 \u0110\u1ea7u: "),g.qZA(),g.qZA(),g.TgZ(55,"div",25),g.TgZ(56,"span"),g._uU(57),g.qZA(),g._uU(58),g.ALo(59,"number"),g.qZA(),g.qZA(),g.TgZ(60,"div",21),g.TgZ(61,"div",22),g.TgZ(62,"div",23),g._uU(63,"D\u01b0 Cu\u1ed1i: "),g.qZA(),g.qZA(),g.YNc(64,fe,3,4,"div",26),g.YNc(65,Ze,5,9,"div",24),g.qZA(),g._UZ(66,"hr",27),g.YNc(67,ve,4,2,"div",18),g.qZA(),g.qZA(),g.TgZ(68,"mat-expansion-panel",28),g.TgZ(69,"mat-expansion-panel-header"),g.TgZ(70,"mat-panel-title"),g._uU(71),g.qZA(),g.TgZ(72,"mat-panel-description"),g._uU(73," L\u1ecdc Theo Th\xe1ng "),g.TgZ(74,"mat-icon"),g._uU(75,"date_range"),g.qZA(),g.qZA(),g.qZA(),g.TgZ(76,"div",29),g.TgZ(77,"div",30),g.TgZ(78,"mat-form-field",31),g.TgZ(79,"mat-label"),g._uU(80),g.qZA(),g.TgZ(81,"mat-select",32),g.TgZ(82,"mat-option",33),g._uU(83),g.qZA(),g.TgZ(84,"mat-option",34),g._uU(85),g.qZA(),g.qZA(),g.qZA(),g.TgZ(86,"mat-form-field",31),g.TgZ(87,"mat-label"),g._uU(88),g.qZA(),g._UZ(89,"input",35),g.qZA(),g.TgZ(90,"mat-form-field",36),g.TgZ(91,"mat-label"),g._uU(92,"T\u1eeb"),g.qZA(),g.TgZ(93,"input",37),g.NdJ("click",function(){return g.CHM(t),g.MAs(96).open()}),g.qZA(),g._UZ(94,"mat-datepicker-toggle",38),g._UZ(95,"mat-datepicker",null,39),g.qZA(),g.TgZ(97,"mat-form-field",36),g.TgZ(98,"mat-label"),g._uU(99),g.qZA(),g.TgZ(100,"input",40),g.NdJ("click",function(){return g.CHM(t),g.MAs(103).open()}),g.qZA(),g._UZ(101,"mat-datepicker-toggle",38),g._UZ(102,"mat-datepicker",null,41),g.qZA(),g.TgZ(104,"button",42),g.NdJ("click",function(){return g.CHM(t),g.oxw().applyFilter()}),g.TgZ(105,"span",6),g._uU(106),g.qZA(),g._UZ(107,"mat-icon",7),g.qZA(),g.TgZ(108,"button",43),g.NdJ("click",function(){return g.CHM(t),g.oxw().clearFilter()}),g._UZ(109,"mat-icon",44),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.TgZ(110,"div",45),g.TgZ(111,"div",46),g.TgZ(112,"div",47),g.TgZ(113,"div",48),g._uU(114," X\xe1c nh\u1eadn "),g.qZA(),g.TgZ(115,"div",48),g._uU(116),g.qZA(),g.TgZ(117,"div",49),g._uU(118),g.qZA(),g.TgZ(119,"div",48),g._uU(120),g.qZA(),g.TgZ(121,"div",48),g._uU(122),g.qZA(),g.TgZ(123,"div"),g._uU(124),g.qZA(),g.qZA(),g.TgZ(125,"div"),g.YNc(126,be,1,1,"mat-progress-bar",16),g.qZA(),g.TgZ(127,"div",50),g.YNc(128,qe,2,1,"div",51),g.qZA(),g.qZA(),g.qZA(),g.TgZ(129,"mat-paginator",52,53),g.NdJ("page",function(e){return g.CHM(t),g.oxw().onPage(e)}),g.qZA(),g.qZA(),g.BQk()}if(2&t){const t=e.$implicit,i=g.MAs(23),a=g.MAs(96),o=g.MAs(103),n=g.oxw();g.xp6(4),g.hij(" ",t("TITLE")," "),g.xp6(2),g.Q6J("color","primary"),g.xp6(2),g.Oqu(t("ADD")),g.xp6(1),g.Q6J("svgIcon","heroicons_solid:plus"),g.xp6(1),g.Q6J("color","primary"),g.xp6(4),g.Q6J("color","primary"),g.xp6(3),g.Q6J("svgIcon","credit_card"),g.xp6(1),g.Q6J("matMenuTriggerFor",i)("color","primary"),g.xp6(6),g.Q6J("routerLink","analyst"),g.xp6(11),g.Q6J("ngIf",n.loadingFlag.pending),g.xp6(6),g.Q6J("ngIf",!1===n.panelOpenState),g.xp6(1),g.Q6J("ngIf",!0===n.panelOpenState),g.xp6(8),g.Q6J("ngIf",0!==n.totalList.total_out),g.xp6(5),g.Q6J("ngClass",g.WLB(58,me,n.head_surplus>0,n.head_surplus<0)),g.xp6(2),g.hij(" ",n.head_surplus>0?"+":"",""),g.xp6(1),g.hij(" ",g.xi3(59,55,n.head_surplus,"0.0-0")," \u0111 "),g.xp6(6),g.Q6J("ngIf",0==n.dataTotalList),g.xp6(1),g.Q6J("ngIf",0!=n.totalList.total_in),g.xp6(2),g.Q6J("ngIf",n.loadingFlag.result),g.xp6(4),g.hij(" ",t("FILTER")," "),g.xp6(6),g.Q6J("formGroup",n.filterForm),g.xp6(3),g.Oqu(t("RECORD_TYPE")),g.xp6(1),g.Q6J("placeholder",t("TYPE")),g.xp6(2),g.hij(" ",t("INCOME")," "),g.xp6(2),g.hij(" ",t("EXPENSE")," "),g.xp6(3),g.Oqu(t("KEYWORD")),g.xp6(1),g.Q6J("placeholder",t("KEYWORD")),g.xp6(1),g.Q6J("hideRequiredMarker",!0),g.xp6(3),g.Q6J("matDatepicker",a)("placeholder","t\u1eeb")("max",n.maxDateFrom.format("YYYY-MM-DD")),g.xp6(1),g.Q6J("for",a),g.xp6(3),g.Q6J("hideRequiredMarker",!0),g.xp6(2),g.Oqu(t("TO_DATE")),g.xp6(1),g.Q6J("matDatepicker",o)("placeholder",t("TO_DATE"))("max",n.maxDate.format("YYYY-MM-DD"))("min",n.minDate.format("YYYY-MM-DD")),g.xp6(1),g.Q6J("for",o),g.xp6(3),g.Q6J("color","primary")("disabled",n.filterForm.invalid),g.xp6(2),g.Oqu(t("FILTER")),g.xp6(1),g.Q6J("svgIcon","heroicons_outline:filter"),g.xp6(1),g.Q6J("color","secondary")("disabled",!n.isFiltered),g.xp6(8),g.hij(" ",t("DAY")," "),g.xp6(2),g.hij(" ",t("CONTENT")," "),g.xp6(2),g.hij(" ",t("POND")," "),g.xp6(2),g.hij(" ",t("AMOUNT")," "),g.xp6(2),g.hij(" ",t("ACTIONS")," "),g.xp6(2),g.Q6J("ngIf",n.loadingFlag.pending),g.xp6(2),g.Q6J("ngForOf",n.moneyFilteredList),g.xp6(1),g.Q6J("length",n.totalLength)("pageSize",25)}}const Ce=[{path:"",component:(()=>{class t{constructor(t,e,i,a,o,n,s){this._farmService=t,this._moneyService=e,this.localDb=i,this._alertService=a,this._translateService=o,this._formBuilder=n,this._matDialog=s,this.isFiltered=!1,this.loadingFlag=new m.E,this.moneyList=[],this.totalList=[],this.moneyFilteredList=[],this.isNull=!0,this.totalLength=0,this.maxDateFrom=u(),this.panelOpenState=!1,this.loadingDownload=new m.E,this.arrCustomer=[],this.maxDate=u(),this.minDate=u().subtract("days"),this.buildForm(),this.filterForm.valueChanges.subscribe(()=>{""!=this.filterForm.value.dateTo&&this.filterForm.value.dateTo&&(this.maxDateFrom=this.filterForm.value.dateTo),""!=this.filterForm.value.dateFrom&&this.filterForm.value.dateFrom&&(this.minDate=this.filterForm.value.dateFrom)})}ngOnInit(){this._moneyService.setCode(this._farmService.fcode),this.getList()}buildForm(){this.filterForm=this._formBuilder.group({type:"out",keyword:"",dateFrom:[u().startOf("month"),d.kI.required],dateTo:[u(),d.kI.required]})}setDone(t,e){const i=this.localDb.company.code,a=t.id,o=t.cr,n=0==t.confirm?1:0;if("0"==t.bill_id&&0==n){const e=this.moneyList.filter(e=>e.bill_id==t.id);for(let t of e)this._moneyService.updateConfirmRecord(i,t.cr,t.id,"0").subscribe(t=>{1==t.status&&this.getList()},()=>{})}this._moneyService.updateConfirmRecord(i,o,a,n).subscribe(t=>{1==t.status?(this._alertService.success("X\xe1c nh\u1eadn / b\u1ecf th\xe0nh c\xf4ng"),this.getList()):this._alertService.error(t.error)},()=>{this._alertService.error(this._translateService.translate("CONNECT_ERROR"))})}getList(t=0){this.loadingFlag.setPending(!0),this._moneyService.getMoneyList(this._farmService.fcode,t).pipe().subscribe(t=>{if(0==t.status)this._alertService.error(t.error),this.loadingFlag.setResult(!1);else if(0==t.data)this.isNull=!0,this.loadingFlag.setResult(!0);else{this.isNull=!1,t.numRows&&(this.totalLength=t.numRows),this.moneyList=t.data,this.totalList=t.fund,this.moneyList.filter(t=>""!==t.customer_name).filter(t=>{for(var e of[t])this.arrCustomer.push(e.customer_name)}),this.arrCustomer=this.arrCustomer.filter((t,e)=>this.arrCustomer.indexOf(t)===e);const e=this.moneyList.filter(t=>{const e=(new Date).getMonth()+1,i=u(1e3*Number(t.add_time)).format("MM");return 1==t.confirm&&e==i}),i=e.filter(t=>"out"===t.cr),a=e.filter(t=>"in"===t.cr),o=i.reduce((t,e)=>t+Number(e.amounts_payed),0),n=a.reduce((t,e)=>t+Number(e.amounts),0);this.head_surplus=Number(this.totalList.total_in)-Number(this.totalList.total_out),this.end_surplus=this.head_surplus+(n-o),console.log(this.end_surplus),this.moneyFilteredList=this.moneyList,this.loadingFlag.setResult(!0)}},t=>{this._alertService.error(this._translateService.translate("CONNECT_ERROR")),this.loadingFlag.setResult(!1)})}onPage(t){this.isFiltered?this.onFilter(t.pageIndex-1):this.getList(t.pageIndex-1)}applyFilter(){this.onFilter(),this.paginator.firstPage()}clearFilter(){this.isFiltered&&(this.filterForm.reset(),this.paginator.firstPage(),this.getList())}onFilter(t=0){this.isFiltered=!0,this.loadingFlag.setPending(!0);let e="&keyword="+this.filterForm.value.keyword+"&type="+this.filterForm.value.type+"&timeFrom="+this.filterForm.value.dateFrom.unix()+"&timeTo="+this.filterForm.value.dateTo.add("days").endOf("day").unix()+"&page="+t+"&numRow=20";this._moneyService.getMoneySearch(this._farmService.farm.code,e).pipe().subscribe(t=>{t.data&&0!=t.status?(this.totalLength=t.numRows?t.numRows:0,this.moneyFilteredList=t.data,this.totalList=t.fund):(this._alertService.error(t.error),this.moneyFilteredList=[],this.totalList=[],this.totalLength=0),this.loadingFlag.setResult(!0)},()=>{this.loadingFlag.setResult(!1),this._alertService.error(this._translateService.translate("CONNECT_ERROR"))})}presentAdd(){this._matDialog.open(gt.r,{autoFocus:!1,data:this.moneyList}).afterClosed().subscribe(t=>{t&&(this._alertService.success(this._translateService.translate("FARM.ADD.ADD_SUCCESS")),this.isNull=!1,this.updatePage())})}updateRecord(t){this._matDialog.open($t,{autoFocus:!1,data:{smallData:t,bigData:this.moneyList}}).afterClosed().subscribe(t=>{t&&(this._alertService.success(this._translateService.translate("FARM.ADD.EDIT_SUCCESS")),this.updatePage())})}sendItem(t){var e;const i=this.moneyList.filter(e=>e.bill_id==t.id&&1==e.confirm);this.totalDebtConfirmed=i.length>1?i.reduce((t,e)=>t+Number(e.amounts),0):Number(null===(e=i[0])||void 0===e?void 0:e.amounts),0==i.length&&(this.totalDebtConfirmed=0),console.log(this.totalDebtConfirmed)}payment(t){1==t.confirm?this._matDialog.open(oe,{autoFocus:!1,data:{smallData:t,bigData:this.moneyList}}).afterClosed().subscribe(t=>{t&&(this._alertService.success(this._translateService.translate("FARM.ADD.EDIT_SUCCESS")),this.payValue=t,this.updatePage())}):this._alertService.error(this._translateService.translate("FARM.FINANCE.PAYNEED"))}totalManage(){this._matDialog.open(re,{autoFocus:!1,data:this.moneyList}).afterClosed().subscribe(t=>{})}confirmDelete(t){this._matDialog.open(Zt,{width:"50%",autoFocus:!1,data:{smallData:t,bigData:this.moneyList}}).afterClosed().subscribe(t=>{t&&(this._alertService.success(this._translateService.translate("FARM.DELETE.DELETE_SUCCESS")),this.updatePage())})}updatePage(){this.isFiltered?this.onFilter(this.paginator.pageIndex):this.getList(this.paginator.pageIndex)}handleOpenEditDialogMoney(){this._matDialog.open(pt,{autoFocus:!1,data:this.end_surplus}).afterClosed().subscribe(t=>{t&&(this._alertService.success(this._translateService.translate("FARM.ADD.ADD_SUCCESS")),this.getList())})}exportFund(){let t=this.filterForm.invalid?this.minDate.valueOf()/1e3:this.filterForm.value.dateFrom.unix(),e=this.filterForm.invalid?this.maxDate.valueOf()/1e3:this.filterForm.value.dateTo.unix();this.loadingDownload.setPending(!0),this._moneyService.dowloadFileFundReport(t,e).subscribe(t=>{const e=new Blob([t],{type:"text/csv"});let i="Farmext-Fund-"+this._moneyService.fcode+".xlsx";dt()(e,i),this.loadingDownload.setResult(!0)},t=>{this._alertService.error(this._translateService.translate("CONNECT_ERROR")),this.loadingDownload.setResult(!1)})}exportCost(){let t=this.filterForm.invalid?this.minDate.valueOf()/1e3:this.filterForm.value.dateFrom.unix(),e=this.filterForm.invalid?this.maxDate.valueOf()/1e3:this.filterForm.value.dateTo.unix();this.loadingDownload.setPending(!0),this._moneyService.dowloadFileCostReport(t,e).subscribe(t=>{const e=new Blob([t],{type:"text/csv"});let i="Farmext-Cost-"+this._moneyService.fcode+".xlsx";dt()(e,i),this.loadingDownload.setResult(!0)},t=>{this._alertService.error(this._translateService.translate("CONNECT_ERROR")),this.loadingDownload.setResult(!1)})}downloadItem(t){this.loadingDownload.setPending(!0),this._moneyService.dowloadFileCostBill(t.id,t.cr).subscribe(e=>{const i=new Blob([e],{type:"text/csv"});let a="Farmext-Bill-"+t.id+".xlsx";dt()(i,a),this.loadingDownload.setResult(!0)},t=>{this._alertService.error(this._translateService.translate("CONNECT_ERROR")),this.loadingDownload.setResult(!1)})}}return t.\u0275fac=function(e){return new(e||t)(g.Y36(f.D),g.Y36(h.r),g.Y36(et.T),g.Y36(Z.c),g.Y36(n.Vn),g.Y36(d.qu),g.Y36(J.uw))},t.\u0275cmp=g.Xpm({type:t,selectors:[["app-finance"]],viewQuery:function(t,e){if(1&t&&g.Gf(ce,5),2&t){let t;g.iGM(t=g.CRH())&&(e.paginator=t.first)}},decls:1,vars:1,consts:[[4,"transloco","translocoRead"],[1,"w-full"],[1,"relative","flex","flex-col","sm:flex-row","flex-0","items-center","justify-between","pb-8"],[1,"text-3xl","leading-8","font-semibold","tracking-tight"],[1,"flex","flex-shrink-0","items-center","mt-6","sm:mt-0","sm:ml-4"],["mat-flat-button","",1,"fuse-mat-button","ml-4",3,"color","click"],[1,"mr-2"],[3,"svgIcon"],["mat-raised-button","","routerLink","fastPay",1,"fuse-mat-button","ml-4",3,"color"],["svgIcon","mat_outline:menu_book"],["mat-raised-button","",1,"fuse-mat-button","ml-4",3,"matMenuTriggerFor","color"],["svgIcon","heroicons_outline:dots-vertical"],["menu","matMenu"],["mat-menu-item","",3,"routerLink"],["mat-menu-item","",3,"click"],[1,"example-headers-align"],[3,"mode",4,"ngIf"],["hideToggle","",3,"opened","closed"],["class","flex flex-row justify-between",4,"ngIf"],["class","flex flex-col font-bold",4,"ngIf"],[1,"flex","flex-col","px-8","py-6","pb-3","mb-5","bg-card","overflow-hidden","w-7/12","justify-items-center","m-auto"],[1,"flex","flex-row","justify-between"],[1,"flex","flex-col","py-3"],[1,"text-base"],["class","text-base font-medium py-3 text-secondary",3,"ngClass",4,"ngIf"],[1,"text-base","font-medium","py-3","text-secondary",3,"ngClass"],["class","text-base font-medium py-3 text-secondary",4,"ngIf"],[1,"dashed","mt-3"],["hideToggle",""],[1,"flex","flex-col","px-8","py-6","pb-3","mb-5","bg-card","overflow-hidden","w-full"],[1,"flex","items-center",3,"formGroup"],[1,"flex-auto","mr-4"],["formControlName","type",3,"placeholder"],["value","in"],["value","out"],["matInput","","formControlName","keyword",3,"placeholder"],[1,"flex-auto","mr-4",3,"hideRequiredMarker"],["matInput","","formControlName","dateFrom","required","",3,"matDatepicker","placeholder","max","click"],["matSuffix","",3,"for"],["fromDate",""],["matInput","","formControlName","dateTo","required","",3,"matDatepicker","placeholder","max","min","click"],["toDate",""],["mat-flat-button","",1,"fuse-mat-button","mr-4",3,"color","disabled","click"],["mat-icon-button","",1,"fuse-mat-button",3,"color","disabled","click"],["svgIcon","heroicons_solid:x"],[1,"bg-card","shadow","rounded-2xl","overflow-hidden","w-full","mt-6"],[1,"grid"],[1,"grid-cols-12","z-10","sticky","top-0","grid","gap-4","py-4","px-8","shadow","text-md","font-semibold","bg-gray-50"],[1,"col-span-2"],[1,"col-span-3"],[1,"max-h-160","overflow-y-auto"],[4,"ngFor","ngForOf"],[1,"bg-gray-100",3,"length","pageSize","page"],["paginator",""],[3,"mode"],[1,"flex","flex-col","font-bold"],["class","text-base font-medium text-secondary ml-2",3,"ngClass",4,"ngIf"],[1,"text-base","font-medium","text-secondary","ml-2",3,"ngClass"],[1,"text-base","font-medium","py-3","text-secondary"],[1,"flex","flex-col","py-3","font-bold"],["class","grid-cols-12 grid items-center gap-4 py-3 px-8 border-b",3,"title",4,"ngIf"],[1,"grid-cols-12","grid","items-center","gap-4","py-3","px-8","border-b",3,"title"],[1,"example-margin",3,"color","checked","disabled","change"],[1,"col-span-2",3,"ngClass"],["mat-icon-button","",3,"matMenuTriggerFor","click"],["svgIcon","mat_outline:download"],["svgIcon","heroicons_outline:pencil-alt"],[4,"ngIf"],["svgIcon","heroicons_outline:trash",1,"text-red-500"],["mat-menu-item","",3,"click",4,"ngIf"],["svgIcon","mat_outline:payment"]],template:function(t,e){1&t&&g.YNc(0,Fe,131,61,"ng-container",0),2&t&&g.Q6J("translocoRead","FARM.FINANCE")},directives:[n.KI,A.lW,_.Hw,c.rH,it.p6,it.VK,it.OP,x.pp,a.O5,x.ib,x.yz,x.yK,x.u4,a.mk,d.JL,d.sg,v.KE,v.hX,xt.gD,d.JJ,d.u,_t.ey,b.Nt,d.Fj,T.hl,d.Q7,T.nW,v.R9,T.Mq,a.sg,le.NW,q.pW,I.oG],pipes:[a.JJ,a.uU],styles:[".dashed[_ngcontent-%COMP%]{border-top:1px dashed;margin:0;border-bottom-width:0}.example-headers-align[_ngcontent-%COMP%]   .mat-expansion-panel-header-description[_ngcontent-%COMP%], .example-headers-align[_ngcontent-%COMP%]   .mat-expansion-panel-header-title[_ngcontent-%COMP%]{flex-basis:0}.example-headers-align[_ngcontent-%COMP%]   .mat-expansion-panel-header-description[_ngcontent-%COMP%]{justify-content:space-between;align-items:center}.example-headers-align[_ngcontent-%COMP%]   .mat-form-field[_ngcontent-%COMP%] + .mat-form-field[_ngcontent-%COMP%]{margin-left:8px}"]}),t})(),children:[]},{path:"analyst",component:S},{path:"fastPay",component:lt}];let we=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=g.oAB({type:t}),t.\u0275inj=g.cJS({imports:[[c.Bz.forChild(Ce)],c.Bz]}),t})(),Ne=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=g.oAB({type:t}),t.\u0275inj=g.cJS({imports:[[a.ez,we,n.y4,s.m,r.q,o.PU,l.Z,y.N]]}),t})()}}]);